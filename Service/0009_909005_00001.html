<html>
<head>
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=gb2312" />
<title>卡(折)活期存款</title>
<LINK REL=stylesheet HREF="../Terminal/Style/Default/Style.css" type="text/css" />
<script type="text/javascript">	
	// 初始化本次服务流程
	top.serviceCtrl.prepare4Entrance(document, window, function() {serverEntrance();});
	
	//输错密码次数
	var strInputFlag = 1;
	//是否是存折存款
	var isPassBook = false;
	//上传影像平台回调返回次数
	var indexID = 0;
	//大额存款标示
	var bigDepFlag = false;
	//是否校验手机号码
	var isTel = false;
	//是否有客户号
	var isHaveCustomNum = false;
	//强存标示
	var forceDepFlag = false;
	//Pad审核返回次数
	var indexPad = 0;
	//是否代理人办理
	var isAgentDep = false;
	//是否验证过指纹
	var isFingerFlag = false;
	//查询Pad审核图片次数
	var indexImage = 0;
	//是否进入存款确认
	var isDepositConfirm = false;
	//强存按钮是否显示
	var isForceMenu = top.misc.getValueByName("ForceDepositFlag");
	
	//存款交易标志位 true:为可以发送  false:为不可发送 20180414 
	var send909005Flag = true;
	
	//禁止页面其他非输入控件的元素获得焦点
	document.attachEvent("onclick", checkEvent);
	document.attachEvent("ondblclick", checkEvent);
	document.attachEvent("onfocusin", checkEvent);
	document.attachEvent("onkeypress", checkEvent);

	function checkEvent() {
		try {
			//如果光标停留在输入框上,更新last
			if (document.activeElement.tagName == "INPUT") {
				last = document.activeElement.id;
			}
			//如果点击的不是输入框,光标回到最后停留的标签中.否则切换到对应的输入框标签
			if (event.srcElement.id == "" || event.srcElement.type != "text" || event.srcElement.disabled) {
				top.wins.checkEvent(event.srcElement, last);
			}else {
				top.wins.checkEvent(event.srcElement, event.srcElement.id);
			}
		}catch (e) {
		}
	}

	// 服务流程处理入口
	function serverEntrance() {
		top.serviceCtrl.stopUserTimeout();
		top.pool.set("strNavigate2Url", window.location.pathname);
		top.pool.set("strFSNFlag", "DEP");
		
		//初始化数据
		top.pool.set("str1DepCount", "0");    //1元金额数量
		top.pool.set("strC50DepCount", "0");  //5角金额数量
		top.pool.set("strC10DepCount", "0");  //1角金额数量
		top.pool.set("strC5DepCount", "0");   //5分金额数量
		top.pool.set("strC1DepCount", "0");   //1分金额数量
		top.pool.set("isDepAgentFlag", "");   //代理人办理标示
		top.pool.set("strTotalAmount", "0");  //存款金额
		top.pool.set("strDepCheckCash", "0"); //强存金额
		top.pool.set("strY100Count", "0");    //100元张数
		top.pool.set("strY50Count", "0"); 	  //50元张数	
		top.pool.set("strY20Count", "0");     //20元张数
		top.pool.set("strY10Count", "0");     //10元张数
		top.pool.set("strY5Count", "0");      //5元张数
		top.pool.set("strForcePadCheck", ""); //Pad审核标示
		
		if(new top.CheckCard().cardTransStatus() != "true") {
			onServiceFailed("卡(折)活期存款失败", "", new top.CheckCard().cardTransStatus());
		}else if(typeof(top.YHAXCashAcceptor) == "undefined") {
			onServiceFailed("卡(折)活期存款失败", "", top.langcur.oNoCashAccept);
		}else if(top.deposit.checkAvai() != "true") {
			onServiceFailed("卡(折)活期存款失败", "", "存取款模块故障(" + top.deposit.checkAvai() + ")");
		}else if(top.YHAXCashAcceptor.LastAcceptStatus != "ACCEPTED" && top.YHAXCashAcceptor.LastAcceptStatus != "UNKNOWN") {
			onServiceFailed("卡(折)活期存款失败", "", "存款周期异常，请执行复位存取款模块");
		}else{
			try{top.cashguidelights.setENVDepositoryLight("CONTINUOUS");}catch(e){} //迎宾灯
			if (top.cardreader.isCardPresent()) {
				if(top.pool.get("strCardType") != "1"){
					InsertCard();//提示插入本行借记卡
				}else{
					top.pool.set("strNavigate2Url", "");
					//查询账户类型
					top.pool.set("strDepAccount", top.pool.get("strPan"));
					top.wins.showNewProcessingTip("正在查询账户信息，请稍候...");
					top.trans.send909004Async();
				}
			}else{
				if(top.pool.get("strPrintReceip") == 2){//如果是打印凭条后返回本页面
					//选择是否进行存折补登
					onIsPassbook();
				}else{
					//介质选择页面
					TypeSelect();
				}
			}
		}
	}
	
	//重新插入借记卡
	function InsertCard() {
		onCardEjected = function() {
			top.serviceCtrl.startTipTick(top.iUserTimeout, oTakeInvalCardTick);
			// 播放提示音
			try {top.soundPlayer.playback("/Sound/TakeCardTip.mp3");} catch (e) {}
			top.wins.showMain("oLTakeInvalCardTip");
		}
		onCardTaken = function() {
			top.serviceCtrl.navigate2(top.pool.get("strNavigate2Url"));
		}
		onDeviceError_Idc = function() {
			if (top.cardreader.isCardPresent()) {
				top.YHAXCardReader.Capture();
			}
			onServiceFailed("卡(折)活期存款失败", top.TERMRETCODE_CARD_FAILED, top.langcur.oCardReaderError);
		}
		onCardCapturedTipEnd = function() {
			top.serviceCtrl.navigate2Quit();
		}
		onCardCaptured = function() {
			top.pool.set("printType","3");//选择打印的凭条类型
	        top.receiptprinter.printAndEject();
			top.wins.showInfoTip(top.langcur.oCardCapturedTip);
			top.serviceCtrl.startFlowCtrlTimeout(onCardCapturedTipEnd, 15 * 1000);
		}
		//退卡前屏蔽安全退出及返回Home的功能 
		oLSafeQuit.style.visibility = "hidden";
		oLGoHome.style.visibility = "hidden";
		top.cardreader.eject();
	}

	//介质选择：卡、存折
	function TypeSelect() {
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();

		onKey_F7 = function() {
			if (top.YHAXPassbook.StDeviceStatus != "HEALTHY" || top.YHAXPassbook.StMediaStatus != "NOTPRESENT") {
				//无存折模块
				isPassBook = false;
				onServiceFailed("存折活期存款失败", "", "存折模块故障");
			}else {
				top.pool.set("CWDType", "存折");
				top.pool.set("isBookPrintFlag","isPassbook");//是否需要联动存折补登标志
				isPassBook = true;
				insertPass();
			}
		}
		
		onKey_F8 = function() {
			if (top.YHAXCardReader.StDeviceStatus != "HEALTHY") {
				onServiceFailed("借记卡活期存款失败", "", "读卡器模块故障");
			}else {
				top.pool.set("CWDType", "借记卡");
				top.serviceCtrl.navigate2InsertCard();
			}
		}

		//刷折
		onKey_F9 = function() {
		    top.journalPrinter.addJournalWithTime("选择刷折");
		    top.serviceCtrl.stopUserTimeout();
		    if(typeof(top.YHAXPassbookReader) == "undefined"){
		    	onServiceFailed("存折活期存款失败",top.TERMRETCODE_CARD_FAILED, top.langcur.oNoPassbook);
		    }else{
				if (top.YHAXPassbookReader.StDeviceStatus != "HEALTHY") {
					//无存折模块
					onServiceFailed("交易失败", "", "刷折模块故障");
				}else {
					top.pool.set("isBookPrintFlag","isPassbook");//是否需要联动存折补登标志
					passbookReader();
				}	
		    }
		}
		onKey_Cancel = onKey_F98 = function() {
			top.serviceCtrl.navigate2SecondMenu();
		}
		onTimeout = function() {
			top.serviceCtrl.navigate2Quit();
		}
		
		isPassBook = false;
		//显示安全退出及返回Home的功能
		oLSafeQuit.style.visibility = "visible";
		oLGoHome.style.visibility = "visible";
		try{top.soundPlayer.playback("/Sound/SelectMediaType.mp3");}catch(e){}
		window.operateCtrl.enableInput();
		top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout, oSelectTypeTick);
		top.wins.showMain("oLTypeSelect");
	}
	//刷折功能
	function passbookReader(){
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();
		onMediaInserted = function() {
			top.serviceCtrl.stopUserTimeout();
			top.wins.showProcessingTip(top.langcur.oReadPassbookInfo);
		}
		onMediaInvalid = function() {
			top.serviceCtrl.stopUserTimeout();
			onServiceFailed("刷折失败","",top.langcur.oPassbookErro2);
		}
		notSupportPassbook = function() {
			top.serviceCtrl.stopUserTimeout();
			onServiceFailed("刷折失败","",top.langcur.oReadPassbookNotSupport);
		}
		onDeviceError_Pbp = function() {
			top.serviceCtrl.stopUserTimeout();
			onServiceFailed("刷折失败","",top.langcur.oPassbookErro1);
		}
		onMediaAccepted = function(track2Val) {
			if (track2Val != null && track2Val != "") {
				if (track2Val.split("=").length < 4) {
					notSupportPassbook();
					return;
				}
				//二磁道
				top.pool.set("strTrack3", track2Val);
				top.pool.set("strVoucherNo", track2Val.split("=")[3].substr(16, 8));
				top.pool.set("strVoucherType", track2Val.split("=")[3].substr(0, 4));
				//截取折号
				track2Val = track2Val.split("=")[2].substr(0, 17);
				top.pool.set("strPassBookNum", track2Val);
				top.pool.set("DestPan", track2Val);
				//存折验密
				inputPin();
			}
		}
		onKey_F98 = onKey_Cancel = onTimeout = function() {
			top.passbookreader.cancelAccept();
			top.serviceCtrl.navigate2Quit();
		}
		
		//屏蔽安全退出及返回Home的功能
		oLSafeQuit.style.visibility = "hidden";
		oLGoHome.style.visibility = "hidden";
		top.passbookreader.accept();
		// 播放提示音
		try{top.soundPlayer.playback("/Sound/PlsReadPass.mp3");}catch(e){}
		top.serviceCtrl.startUserTimeout(onKey_F98, top.iUserTimeout, oReadPassTick);
		// 在广告加载完成前显示默认空闲提示
		top.wins.showMain("oLPassReaderTip");
	}
	//插入存折
	function insertPass() {
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();
		onMediaInserted = function() {
			top.serviceCtrl.stopUserTimeout();
			top.wins.showProcessingTip(top.langcur.oReadPassbookInfo);
		}
		onMediaInvalid = function() {
			top.serviceCtrl.stopUserTimeout();
			top.wins.showMain("cLInfoTip2");
			try {document.all.item("cLInfoContent2").innerHTML = top.langcur.oPassbookErro2;} catch (e) {}
			top.serviceCtrl.startUserTimeout(backIdle, top.iFailedTimeout, oInfoTip2Tick);
		}
		notSupportPassbook = function() {
			top.serviceCtrl.stopUserTimeout();
			top.wins.showMain("cLInfoTip2");
			try {document.all.item("cLInfoContent2").innerHTML = top.langcur.oReadPassbookNotSupport;} catch (e) {}
			top.serviceCtrl.startUserTimeout(backIdle, top.iFailedTimeout, oInfoTip2Tick);
		}
		onDeviceError_Pbp = function() {
			top.serviceCtrl.stopUserTimeout();
			top.wins.showMain("cLInfoTip2");
			try {document.all.item("cLInfoContent2").innerHTML = top.langcur.oPassbookErro1;} catch (e) {}
			top.passbookprinter.reset();
			top.serviceCtrl.startUserTimeout(backIdle, top.iFailedTimeout, oInfoTip2Tick);
		}
		onMediaAccepted = function(track2Val) {
			if (track2Val != null && track2Val != "") {
				if (track2Val.split("=").length < 4) {
					notSupportPassbook();
					return;
				}
				//二磁道
				top.pool.set("strTrack3", track2Val);
				top.pool.set("strVoucherNo", track2Val.split("=")[3].substr(16, 8));
				top.pool.set("strVoucherType", track2Val.split("=")[3].substr(0, 4));
				//截取折号
				track2Val = track2Val.split("=")[2].substr(0, 17);
				top.pool.set("strPassBookNum", track2Val);
				top.pool.set("DestPan", track2Val);
				ejectPassbook();
			}
		}
		onKey_F98 = onKey_Cancel = onTimeout = function() {
			top.passbookprinter.cancelAccept();
			backIdle();
		}
		
		//屏蔽安全退出及返回Home的功能
		oLSafeQuit.style.visibility = "hidden";
		oLGoHome.style.visibility = "hidden";
		top.passbookprinter.accept();
		// 播放提示音
		try {top.soundPlayer.playback("/Sound/InPutbankbook.mp3");} catch (e) {}
		top.serviceCtrl.startUserTimeout(backIdle, top.iUserTimeout, oInPassTick);
		// 在广告加载完成前显示默认空闲提示
		top.wins.showMain("oLPassTip");
	}

	//先退折
	function ejectPassbook() {
		top.serviceCtrl.stopUserTimeout();
		onPrintTaken = function() {
			//进行存折验密
			inputPin();
		}
		onPrintEjected = function() {
			top.wins.showMain("cLInfoTip2");
			try {document.all.item("cLInfoContent2").innerHTML = top.langcur.oTakePassbook;} catch (e) {}
			top.serviceCtrl.startUserTimeout(backIdle, top.iUserTimeout, oInfoTip2Tick);
		}
		top.passbookprinter.eject();
	}
	
	function backIdle() {
		top.serviceCtrl.stopUserTimeout();
		if (typeof (top.YHAXPassbook) != "undefined") {
			//删除 top.YHAXPassbook.StDeviceStatus == "HEALTHY"
			if (top.YHAXPassbook.StMediaStatus == "PRESENT") {
				top.passbookprinter.eject();
				top.passbookprinter.PassbookEvents.clearAll();
			}
			top.serviceCtrl.navigate2Idle();
		}else {
			top.serviceCtrl.navigate2Idle();
		}
	}
	
	var bQuitSelected = false;
	function inputPin() {
		top.serviceCtrl.stopUserTimeout();
		window.operateCtrl.disableInput(true);
		onPlainCancelled = function() {
			top.pinpad.bufferPINPassBookEx();
			window.operateCtrl.enableInput();
			if (strInputFlag > 1) {
				Tip_TitleInput.innerHTML = top.langcur.oPlsResInputPwd;
			} else {
				Tip_TitleInput.innerHTML = top.langcur.oPlsInputPwd;
			}
			// 播放提示音
			top.soundPlayer.playback("/Sound/InputPassword.mp3");
			top.wins.showMain("oLInputPassword");
			top.serviceCtrl.startUserTimeout(onKey_F98, top.iUserTimeout, oInpPwdTick);
			input_Password.value = "";
			input_Password.focus();
		}
		onKey_F98 = onKey_Cancel = function() {
			bQuitSelected = true;
			if (input_Password.value.length < top.pinpad.iMaxPinLen) {
				top.pinpad.cancelPINEntry();
			}
		}
		onGetPinBlockOK = function(pinblock) {
			if (bQuitSelected) {
				// 用户选择了退卡
				top.serviceCtrl.navigate2Quit();
				return;
			}
			top.pool.set("strPinBlock", pinblock);
			//验密交易
			top.wins.showNewProcessingTip("正在发起验密交易，请稍候...");
			top.trans.send901606SecondAsync();
		}
		onPinInputTimeout = onDeviceError_Pinpad = onPinCancelled = function() {
			top.serviceCtrl.navigate2Quit();
		}
		input_Password.onkeypress = function() {
			error_InputPassword.innerHTML = "&nbsp;";
		}
		top.pinpad.cancelUserEntry();//关闭明文输入
		bQuitSelected = false;
	}
	
	//存折验密成功
	function onVerifyServiceSuccessful() {
		top.serviceCtrl.stopUserTimeout();
		top.pool.set("strCardType", "1");
		top.pool.set("strNavigate2Url", "");
		//查询账户类型
		top.pool.set("strDepAccount", top.pool.get("DestPan"));
		top.wins.showNewProcessingTip("正在查询账户信息，请稍候...");
		top.trans.send909004Async();
	}
	
	//验密失败
	function onServiceSecondFailed() {
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();
		top.journalPrinter.addJournalWithTime("909005-验密失败");
		//密码错误，3次输入密码
		if (strInputFlag < 3) {
			strInputFlag++;
			error_InputPassword.innerHTML = "密码输入错误，请重新输入密码！";
			inputPin();
		}else {
			strInputFlag = 1;
			window.operateCtrl.disableInput(true);
		    top.serviceCtrl.stopUserTimeout();
			top.serviceCtrl.navigate2Quit();
		}
	}

	//账户类别查询成功
	function onInqSecDepAmountSuccess() {
		top.serviceCtrl.stopUserTimeout();
		//查询清钞状态
		top.wins.showProcessingTip("正在查询清机状态,请稍候...");
		top.pool.set("strTransType", "deposit");
		top.trans.sendCashSettleCycLogStatusAsync();
	}
	
	//清机情况查询成功
	function onAsyncCashSettleCycLogStatusComplete() {
		top.serviceCtrl.stopUserTimeout();
		if(top.pool.get("bindAcctType") == "2") {
			//II类账户
			top.journalPrinter.addJournalWithTime("客户是II类账户");
			bigDepFlag = false;
			onSecAccountDetail();			
		}else {
			//I类账户
			top.journalPrinter.addJournalWithTime("客户是I类账户");
			chooseCashType();	
		}
	}
	
	//查询II类户存款限额成功
	function onSecAccountDetail() {
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();

		onKey_F99 = onKey_Enter = function() {
			bigDepFlag = false;
			//进入存钞子流程
			top.YHAXCashAcceptor.CurrentTellerID = parseFloat(top.pool.get("strMaxDepAmount"));
			startDeposit();
		}
		onKey_F98 = onKey_Cancel = function() {
			top.serviceCtrl.navigate2SecondMenu();
		}
		onTimeout = function() {
			top.serviceCtrl.navigate2Quit();
		}
		
		var strDayAmt = top.pool.get("creditDailyUsedLimit");
		var strYearAmt = top.pool.get("creditYearUsedLimit");
		if(strDayAmt == "" || strDayAmt == null || parseFloat(strDayAmt) < 100 || 
		  strYearAmt == "" || strYearAmt == null || parseFloat(strYearAmt) < 100) {
			onServiceFailed("卡(折)活期存款失败", "", "可转入额度不足");
			return;
		}
		if(parseFloat(strDayAmt) > parseFloat(strYearAmt)) {
			oSecAmtMsg.innerHTML = "该账户为II类账户，本次最高取存金额：" + strYearAmt + " 元";
			top.pool.set("strMaxDepAmount", strYearAmt);
		}else {
			oSecAmtMsg.innerHTML = "该账户为II类账户，本次最高取存金额：" + strDayAmt + " 元";
			top.pool.set("strMaxDepAmount", strDayAmt);
		}
		text_pan1.innerHTML = top.pool.get("strDepAccount");
		text_dayAmt.innerHTML = strDayAmt + " 元";
		text_yearAmt.innerHTML = strYearAmt + " 元";
		oLSafeQuit.style.visibility = "visible";
		oLGoHome.style.visibility = "visible";
		window.operateCtrl.enableInput();
		top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout, oSecDepMsgTick);
		top.wins.showMain("oLSecDepMsg");
	}

	//大额小额存款选择
	function chooseCashType() {
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();

		//小额存款
		onKey_F7 = function() {
			top.journalPrinter.addJournalWithTime("客户选择 普通存款");
			bigDepFlag = false;
			top.pool.set("strMaxDepAmount", "49999");
			//进入存钞子流程
			top.YHAXCashAcceptor.CurrentTellerID = parseFloat(top.pool.get("strMaxDepAmount"));
			startDeposit();
		}
		//大额存款
		onKey_F8 = function() {
			top.journalPrinter.addJournalWithTime("客户选择 大额存款");
			if(typeof(top.YHAXIDCardReader) == "undefined" || top.YHAXIDCardReader.StDeviceStatus !="HEALTHY") {
				onServiceFailed("卡(折)活期存款失败", "", top.langcur.oNoIDCardReader);
			}else {
				bigDepFlag = true;
				//插入身份证
				acceptIDCard();
			}
		}
		onKey_Cancel = onKey_F98 = function() {
			top.serviceCtrl.navigate2SecondMenu();
		}
		onTimeout = function() {
			top.serviceCtrl.navigate2Quit();
		}
		
		bigDepFlag = false;
		oLSafeQuit.style.visibility = "visible";
		oLGoHome.style.visibility = "visible";
		window.operateCtrl.enableInput();
		top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout, oSelectCashTick);
		top.wins.showMain("oLCashSelect");
	}
	
	// 允许读取身份证
	function acceptIDCard() {
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();
		onDeviceError_ID = onTimeout_ID = onCardInvalid_ID = function() {
			onServiceFailed("卡(折)活期存款失败", top.TERMRETCODE_ID_READFAILED, top.langcur.oIDReaderFailed);
		}
		onCardReaded = function() {	
			idCardEject();			
		}
		onCardInserted_ID = function() {
			top.wins.showNewProcessingTip(top.langcur.oReadingIDCard);
		}
		onKey_Cancel = onKey_F98 = function() {
			top.idCardReader.cancelAccept();
			top.serviceCtrl.navigate2SecondMenu();
		}
		onTimeout = function() {
		    top.idCardReader.cancelAccept();
			top.serviceCtrl.navigate2Quit();
		}
		//插入身份证页面屏蔽安全退出及返回Home的功能
		oLSafeQuit.style.visibility = "hidden";
		oLGoHome.style.visibility = "hidden";
		
		window.operateCtrl.enableInput();
		top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout, oIdCardTick);
		top.idCardReader.accept();
		// 播放提示音
		try {top.soundPlayer.playback("/Sound/PutIDCard.mp3");} catch (e) {}
		Tip_InsertID.innerHTML = top.langcur.oInsertID;
		top.wins.showMain("oLIDCardTip");
	}
	
	// 提示取走二代身份证
	function idCardEject() {
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();
		onDeviceError_ID = onTimeout_ID = function() {
			onServiceFailed(top.langcur.oCardDispenserFailed, top.TERMRETCODE_ID_EJECTFAILED, top.langcur.oEjectIDFailed);
		}
		onCardTaken_ID = function() {}
		//超时退出
	    onTimeout = function() {
	    	top.idCardReader.IDCardEvents.clearAll();
			//进行联网核查流程
	        top.idCardReader.idCardTakenComplete();
	    }
		top.serviceCtrl.startUserTimeout(onTimeout, 10, oIdCardTakeTick);
		window.operateCtrl.enableInput();
		top.idCardReader.eject();
		// 播放提示音
		try {top.soundPlayer.playback("/Sound/TakeIDCard.mp3");} catch (e) {}
		Tip_IDCardTake.innerHTML = top.langcur.oIDCardTake;
		top.wins.showMain("oLIDCardTakeTip");
	}
	
	//影像文件上传交易 
	function onNetworkVirificationSuccessful() {
		top.serviceCtrl.stopUserTimeout();
		if (top.pool.get("customNo") != null && top.pool.get("customNo") != "") {
			isHaveCustomNum = true;
			//老客户开始影像文件上传交易  
			top.pool.set("strImageType", "IDType");//上传类型,后台会根据这个区分送到影像平台哪个接口
		} else {
			//新客户：先上传智能柜员目录
			top.pool.set("strImageType", "ZNGYType");//上传类型,后台会根据这个区分送到影像平台哪个接口
		}
		top.pool.set("strImageFilePath", top.COLS_IDPHOTOS_FILEPATH);//上传的文件存储路劲
		top.wins.showNewProcessingTip(top.langcur.oSendImage);
		top.trans.sendImageFileAsync();
	} 
	
	//影像文件上传成功回调函数
	function onImageFileSuccessful(){
		var strBatchId = top.exchxmlasync.msgxmldomResp.getElementValue("strBatchId");//原交易批次号（影像平台专用、后面的交易都用这个）
		top.pool.set("strBatchId", strBatchId);
		if(indexID == 0) {
			//本人办理
			if(top.pool.get("strRespIDNo") != null
			&& top.pool.get("strRespIDNo") != ""
			&& top.pool.get("strRespIDNo") == top.pool.get("strIDCardNum")) {
				isAgentDep = false;
				top.pool.set("isDepAgentFlag", "1");
				//拍照
				TakePic();
			}
			//代理人办理
			else {
				isAgentDep = true;
				top.pool.set("isDepAgentFlag", "2");
				//代理人电话录入
				infoAgentComfin();
			}
		}else if(indexID == 1) {
			//设置定额存款参数
			if(bigDepFlag) {
				//身份证图片查询
				if(isHaveCustomNum) {
					top.pool.set("strImageType", "IDType");
				}else {
					top.pool.set("strImageType", "ZNGYType");
				}
				top.wins.showNewProcessingTip(top.langcur.oImageFileQuery);
				top.trans.sendImageFileQueryAsync();
			}else {
				top.YHAXCashAcceptor.CurrentTellerID = parseFloat(top.pool.get("strMaxDepAmount"));
				//进入存钞子流程
				startDeposit();
			}
		}else if(indexID == 2) {
			var htmlstr = infoToPic.innerHTML;
			top.pool.set("htmlstr",htmlstr);
			oSigConfirm.style.visibility = "hidden";//签名完影藏确定按钮
			infoToPic.style.visibility = "hidden";
			top.wins.showNewProcessingTip(top.langcur.sendBusiness);
			top.trans.sendBusinessApplicationAsync();
		}
	}
	
	//图片查询结果
	function onImageFileQuerySuccessful()
	{ 
		top.wins.stopProcessingTimeout();
		top.serviceCtrl.stopUserTimeout();
		if(indexImage == 0){
			top.pool.set("idPhotoBackUrl",top.pool.get("back"));//反
			top.pool.set("idPhotoUrl",top.pool.get("Front"));//正
			//进行查询
			indexImage++;
			top.wins.showNewProcessingTip(top.langcur.oImageFileQuery);
			top.pool.set("strImageType","ZNGYType");
			top.trans.sendImageFileQueryAsync();
		}else if(indexImage == 1){
			top.pool.set("scenePhotoUrl",top.pool.get("cameras"));//现场	
	        var Msg = new top.JSONCtrl();	
	        Msg.setJson("customName", "客户名称："+ top.pool.get("strIDName"));		
			Msg.setJson("customNum", "客户身份证："+ top.pool.get("strIDCardNum"));
			top.pool.set("strCheckContent", Msg.jsonStr);
			top.pool.set("strbusinessCode", "001");
			top.pool.set("strbusinessName", "大额存款身份验证");		
			//进行审核
			indexPad = 1;
			top.wins.showNewProcessingTip(top.langcur.oCheckLoading);
			top.trans.send910301Async();   		
		}
	}
	
	//代理人电话录入
	function infoAgentComfin() {
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();
		onKey_F99 = onKey_Enter = function() {
			var homeTel = input_Tel.value;
			if((homeTel.length > 0 && !/^[0-9]{5,12}$/.test(homeTel)) || homeTel == "") {
				input_Tel.value = "";
				error_Tel.innerHTML = top.langcur.oInputRightPhone;
				return;
			}
			top.inputmethod.Close();
			top.pool.set("strAgentPhone", homeTel);
			isTel = false;
			//拍照
			TakePic();
		}
		input_Tel.onkeyup = function()
		{
			error_Tel.innerHTML = "&nbsp;";
		}
		onTimeout = function()
		{
			isTel = false;
			top.inputmethod.Close();
			top.serviceCtrl.navigate2Quit();
		}
		text_pid1.innerHTML = top.pool.get("strIDCardNum");
		text_name1.innerHTML = top.pool.get("strIDName");
		Tip_Info.innerHTML = "代理人信息补录";
		proMessage.innerHTML = "提示：持他人的卡/折办理存款、取款或转账<br>超过50000元，需留存代理人信息及联系电话。";
		//显示安全退出及返回Home的功能		
		oLSafeQuit.style.visibility = "visible";
		oLGoHome.style.visibility = "visible";
		try {top.soundPlayer.playback("/Sound/InputTelPhoneNum.mp3");} catch (e) {}
		top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout, oInfoConfigTick);
		window.operateCtrl.enableInput();
		top.wins.showMain("oLInfoConfigTip");
		isTel = true;
		input_Tel.value = "";
		input_Tel.focus();
	}
	
	//拍照
	function TakePic() {
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();
		onTimeout = function() {
			top.cameras.display("Person", "Destroy");//关闭摄像头
			top.serviceCtrl.navigate2Quit();
		}
		window.operateCtrl.enableInput();
		window.frames["ifreamPhoto"].CamerasLoad();//加载子页面摄像头相关方法
		top.wins.showMain("oLTakePicTip");
	}

	function PhotoPrevStep()//TakePhoto页面过度方法
	{
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();
		top.serviceCtrl.navigate2SecondMenu();//拍照返回后步骤
		window.operateCtrl.enableInput();
	}

	function PhotoNextStep()//TakePhoto页面过度方法
	{
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();
		indexID = 1;
		top.pool.set("strImageType", "ZNGYType");//上传类型,后台会根据这个区分送到影像平台哪个接口
		top.pool.set("strImageFilePath", top.COLS_ZNGYPHOTOS_FILEPATH);//上传的文件存储路劲
		top.wins.showNewProcessingTip(top.langcur.oSendImage);
		top.trans.sendImageFileAsync();
		window.operateCtrl.enableInput();
	}
	
	//开始存钞子流程
	function startDeposit() {
		top.serviceCtrl.stopUserTimeout();
		if(isDepositConfirm) {
			if(top.deposit.checkCashinAvai() != "true") {
				if(top.pool.get("strTotalAmount") != "" && top.pool.get("strTotalAmount") != null && parseFloat(top.pool.get("strTotalAmount")) > 0) {
					top.wins.showInfoTip("存取款模块故障(" + top.deposit.checkCashinAvai() + ")");
					top.serviceCtrl.startFlowCtrlTimeout(depositConfirm, 5 * 1000);
				}else {
					onServiceFailed("卡(折)活期存款失败", "", "存取款模块故障(" + top.deposit.checkCashinAvai() + ")");
				}
			}else {
				startCashin();
			}
		}else {
			if(top.deposit.checkAvai() != "true") {
				onServiceFailed("卡(折)活期存款失败", "", "存取款模块故障(" + top.deposit.checkAvai() + ")");
			}else {
				startCashin();
			}
		}
	}
	
	//开始存钞
	function startCashin() {
		top.serviceCtrl.stopUserTimeout();
		
		onCashInserted = function() {
			top.serviceCtrl.stopUserTimeout();
			oCashInTick.style.visibility = "hidden";
			oLReturn.style.visibility = "hidden";
			oLDepTitle.innerHTML = "正在存钞，请稍候...";
			try{top.soundPlayer.playback("/Sound/CashInBox.mp3");}catch(e){}
			oLDepMsgTip.innerHTML = "提示：存钞过程中您可以持续放钞，<br>如有不可识别的钞券，请及时取走。";
		}
		onIndentifyCash = function(count, amount) {
			top.pool.set("str100DepCount", top.pool.get("strY100Count"));
			top.pool.set("str50DepCount", top.pool.get("strY50Count"));		
			top.pool.set("str20DepCount", top.pool.get("strY20Count"));
			top.pool.set("str10DepCount", top.pool.get("strY10Count"));
			top.pool.set("str5DepCount", top.pool.get("strY5Count"));
			top.pool.set("strTotalAmount", amount);
			//存款确认
			depositConfirm();
		}
		onKey_F98 = function() {
			top.serviceCtrl.stopUserTimeout();
			top.journalPrinter.addJournalWithTime("放钞页面客户选择返回");
			onCashAcceptCancelled = function() {
				top.serviceCtrl.navigate2SecondMenu();
			}
			//取消存款
			top.wins.showNewProcessingTip("正在取消存款，请稍候...");
			top.deposit.CancelAcceptCash();
		}
		onDeviceError_Ac = onDeviceError_Ejr = function() {
			//打印凭条，暂停服务，发送Pad，记录设备端流水
			onDepositOutOfService("暂停服务", "机具存钞故障，请等待银行工作人员处理！", "活期存款存钞故障");
		}
		onTimeout = function() {
			onCashAcceptCancelled = function() {
				if(top.pool.get("strTotalAmount") != "" && top.pool.get("strTotalAmount") != null && parseFloat(top.pool.get("strTotalAmount")) > 0) {
					//打印凭条，暂停服务，发送Pad，记录设备端流水
					onDepositOutOfService("暂停服务", "放钞页面超时，请等待银行工作人员处理！", "放钞超时 已存入" + top.pool.get("strTotalAmount") + ".00元 未入账");
				}else {
					top.serviceCtrl.navigate2Quit();
				}
			}
			//取消存款
			top.wins.showNewProcessingTip("正在取消存款，请稍候...");
			top.deposit.CancelAcceptCash();
		}
		
		oLSafeQuit.style.visibility = "hidden";
		oLGoHome.style.visibility = "hidden";
		oCashInTick.style.visibility = "";
		oLDepTitle.innerHTML = "请在存钞口放入钞券";
		oLDepMsgTip.innerHTML = "提示：本机仅支持100元、50元、20元、10元、5元纸币票面存钞。<br>存钞口最多容纳300张钞券，如钞券较多，可在清点过程中持续放钞";
		try{top.soundPlayer.playback("/Sound/InputCash.mp3");}catch(e){}
		top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout, oCashInTick);
		top.wins.showMain("oLCashInTip");
		top.deposit.accept();
	}
	
	//存款确认
	function depositConfirm() {
		top.serviceCtrl.stopUserTimeout();
		
		onKey_F97 = function() {
			top.journalPrinter.addJournalWithTime("存款确认页面 客户选择 确认存款");
			if(top.YHAXCashAcceptor.StInputOutputStatus == "EMPTY") {
				//确认存款
				oConfirmDep.style.visibility = "hidden";
				forceDepFlag = false;
				stopDeposit();
			}else {
				error_DepConfirm.innerHTML = "请您取走拒钞口的钞票！";
			}
		}
		onKey_F98 = function() {
			top.journalPrinter.addJournalWithTime("存款确认页面 客户选择 继续放钞");
			if(top.YHAXCashAcceptor.StInputOutputStatus == "EMPTY") {
				//继续存款
				startDeposit();
			}else {
				error_DepConfirm.innerHTML = "请您取走拒钞口的钞票！";
			}
		}
		onKey_F99 = function() {
			top.journalPrinter.addJournalWithTime("存款确认页面 客户选择 协助存款");
			if(top.YHAXCashAcceptor.StInputOutputStatus == "EMPTY") {
				//协助存款
				forceDepFlag = true;
				stopDeposit();
			}else {
				error_DepConfirm.innerHTML = "请您取走拒钞口的钞票！";
			}
		}
		onTimeout = function() {
			error_DepConfirm.innerHTML = "&nbsp;";
			if(top.pool.get("strTotalAmount") == "" || top.pool.get("strTotalAmount") == null || parseFloat(top.pool.get("strTotalAmount")) <= 0) {
				top.serviceCtrl.navigate2Quit();
			}else {
				//打印凭条，暂停服务，发送Pad，记录设备端流水
				onDepositOutOfService("暂停服务", "存款确认页面超时，请等待银行工作人员处理！", "存款确认超时 已存入" + top.pool.get("strTotalAmount") + ".00元 未入账");
			}
		}
		
		if(top.pool.get("str100DepCount") == "" || top.pool.get("str100DepCount") == null) {
			top.pool.set("str100DepCount", "0");
		}
		if(top.pool.get("str50DepCount") == "" || top.pool.get("str50DepCount") == null) {
			top.pool.set("str50DepCount", "0");
		}
		if(top.pool.get("str20DepCount") == "" || top.pool.get("str20DepCount") == null) {
			top.pool.set("str20DepCount", "0");
		}
		if(top.pool.get("str10DepCount") == "" || top.pool.get("str10DepCount") == null) {
			top.pool.set("str10DepCount", "0");
		}
		if(top.pool.get("str5DepCount") == "" || top.pool.get("str5DepCount") == null) {
			top.pool.set("str5DepCount", "0");
		}
		oRMBAmt1.innerHTML = top.pool.get("str100DepCount") + " 张";
		oRMBAmt2.innerHTML = top.pool.get("str50DepCount") + " 张";		
		oRMBAmt3.innerHTML = top.pool.get("str20DepCount") + " 张";
		oRMBAmt4.innerHTML = top.pool.get("str10DepCount") + " 张";
		oRMBAmt5.innerHTML = top.pool.get("str5DepCount") + " 张";
		oRMBAmt1_1.innerHTML = parseFloat(top.pool.get("str100DepCount")) * 100 + ".00 元";
		oRMBAmt2_1.innerHTML = parseFloat(top.pool.get("str50DepCount")) * 50 + ".00 元";		
		oRMBAmt3_1.innerHTML = parseFloat(top.pool.get("str20DepCount")) * 20 + ".00 元";
		oRMBAmt4_1.innerHTML = parseFloat(top.pool.get("str10DepCount")) * 10 + ".00 元";
		oRMBAmt5_1.innerHTML = parseFloat(top.pool.get("str5DepCount")) * 5 + ".00 元";
		oTotalAmount.innerHTML = "已存入总金额：" + top.pool.get("strTotalAmount") + ".00 元";
		oContinueDep.style.visibility = "";
		oForceDep.style.visibility = "";
		if(top.pool.get("strTotalAmount") == "" || top.pool.get("strTotalAmount") == null || parseFloat(top.pool.get("strTotalAmount")) <= 0) {
			oConfirmDep.innerHTML = "取消存款";
		}else {
			oConfirmDep.innerHTML = "确认存款";
		}
		if(!bigDepFlag && parseFloat(top.pool.get("strTotalAmount")) > (parseFloat(top.pool.get("strMaxDepAmount")) - 100)) {
			oContinueDep.style.visibility = "hidden";
			oForceDep.style.visibility = "hidden";
		}
		if(isForceMenu == "0") {
			oForceDep.style.visibility = "hidden";
		}
		error_DepConfirm.innerHTML = "&nbsp;";
		isDepositConfirm = true;
		try{top.soundPlayer.playback("/Sound/DepConfirm.mp3");}catch(e){}
		top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout, oDepConfirmTick);
		top.wins.showMain("oLDepConfirmTip");
	}
	
	//存款确认
	function stopDeposit() {
		top.serviceCtrl.stopUserTimeout();
		
		onStoreEscrowedCashEnd = function() {
			top.serviceCtrl.stopUserTimeout();
			//关闭钞门
			top.deposit.CloseShutter();
			//FSN冠字号上传
			top.pool.set("DepositAcceptorAmount", top.pool.get("strTotalAmount"));
			new top.FileControl().createFSNFile();
			if(forceDepFlag) {
				//设置强存验钞参数
				top.YHAXCashAcceptor.CurrentTellerID = 65535;
		        var Msg = new top.JSONCtrl();		
		        Msg.setJson("padPanPassbookNo1", "卡号/存折号：" + top.pool.get("strDepAccount"));
		        Msg.setJson("padDepName1", "存款人身份证号：" + top.pool.get("strRespIDNo"));
		        Msg.setJson("padDepAmount1", "存款人姓名：" + top.pool.get("strRespIDName"));
				if(isAgentDep) {
					Msg.setJson("padAgentID1", "代理人身份证号：" + top.pool.get("strIDCardNum"));
				    Msg.setJson("padAgentName1", "代理人姓名：" + top.pool.get("strIDName"));
				    Msg.setJson("padAgentTel1", "代理人电话：" + top.pool.get("strAgentPhone"));
				}
				Msg.setJson("padDepNumber", "强存张数：1");
				top.pool.set("strCheckContent", Msg.jsonStr);
				top.pool.set("strbusinessCode", "909007");
				top.pool.set("strbusinessName", "协助存款");		
				//进行审核
				indexPad = 0;
				top.pool.set("strForcePadCheck", "1");
				top.wins.showNewProcessingTip(top.langcur.oCheckLoading);
				top.trans.send910306Async();  
			}else {
				if(top.pool.get("strTotalAmount") == "" || top.pool.get("strTotalAmount") == null || parseFloat(top.pool.get("strTotalAmount")) <= 0) {
					//存款金额为0，返回介质菜单
					top.serviceCtrl.navigate2SecondMenu();
				}else {
					//用户签名
					userSign();
				}
			}
		}
		onDeviceError_Store = function() {
			top.serviceCtrl.stopUserTimeout();
			//关闭钞门
			top.deposit.CloseShutter();
			//FSN冠字号上传
			top.pool.set("DepositAcceptorAmount", top.pool.get("strTotalAmount"));
			new top.FileControl().createFSNFile();
			if(forceDepFlag) {
				//设置强存验钞参数
				top.YHAXCashAcceptor.CurrentTellerID = 65535;
				onForceDepCheckFailed("协助存款失败", "", "存取款模块故障(结束存款周期失败)");
			}else {
				if(top.pool.get("strTotalAmount") == "" || top.pool.get("strTotalAmount") == null || parseFloat(top.pool.get("strTotalAmount")) <= 0) {
					//存款金额为0，返回介质菜单
					top.serviceCtrl.navigate2SecondMenu();
				}else {
					//用户签名
					userSign();
				}
			}
		}

		//结束存款周期
		top.wins.showNewProcessingTip("正在结束存款周期，请稍候...");
		top.deposit.storeEscrowedCash();
	}
	
	//协助存款审核失败
	function onForceDepCheckFailed(title, retcode, retdesc) {
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();
		top.pool.set("strForcePadCheck", "");
		onTimeout = function() {
			depositConfirmEx();
		}
		oDepositFailedEx.innerHTML = title;
		oFailedRetDescEx.innerHTML = retdesc;
		window.operateCtrl.enableInput();
		top.serviceCtrl.startUserTimeout(onTimeout, top.iFailedTimeout, oServiceFailedExTick);
		oLSafeQuit.style.visibility = "hidden";
		oLGoHome.style.visibility = "hidden";
		top.wins.showMain("oLServiceFailedExTip");
	}
	
	//柜员授权
	function onInputTellernum() {
		//输入大堂经理输入柜员号
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();
		
		onKey_Enter = onKey_F99 = function() {
			//判断输入的柜员号是否有效
			if (new top.StringCtrl(input_TellerNum.value.substring(0, 8)).isAllDigit2() && input_TellerNum.value.length == 7) {
				top.serviceCtrl.stopUserTimeout();
				top.inputmethod.Close();
				top.pool.set("strAuthtellerId", input_TellerNum.value);//柜员
				top.pool.set("strTellerum", input_TellerNum.value);
				error_InputTellerNum.value = "";
				input_TellerNum.focus();
				top.pool.set("isFingerMore", "true");
				//查询柜员的权限
				top.wins.showNewProcessingTip(top.langcur.send910207);
				top.trans.send910207Async();
			} else {
				error_InputTellerNum.innerHTML = top.langcur.oInputRightTellerNum;
				input_TellerNum.value = "";
				input_TellerNum.focus();
			}
		}
		onKey_Cancel = onKey_F98 = function() {
			top.serviceCtrl.stopUserTimeout();
			top.inputmethod.Close();
		    error_InputTellerNum.innerHTML = "&nbsp;";
			error_InputTellerPassword.innerHTML = "&nbsp;";
			depositConfirmEx();
		}
		onTimeout = function() {
			top.inputmethod.Close();
			if(top.pool.get("strTotalAmount") != "" && top.pool.get("strTotalAmount") != null && parseFloat(top.pool.get("strTotalAmount")) > 0) {
				//打印凭条，暂停服务，发送Pad，记录设备端流水
				onDepositOutOfService("暂停服务", "柜员号输入超时，请等待银行工作人员处理！", "柜员号输入超时 已存入" + top.pool.get("strTotalAmount") + ".00元 未入账");
			}else {
				top.serviceCtrl.navigate2Quit();
			}
		}
		input_TellerNum.onkeypress = function() {
			error_InputTellerNum.innerHTML = "&nbsp;";
		}
		
		window.operateCtrl.enableInput();
		top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout, oInputTellerNumTick);
		oInputTellerNum.innerHTML = top.langcur.InputTellerNum;
		top.inputmethod.ShowDigit(490, 570);
		top.wins.showMain("oLInputTellerNum");
		input_TellerNum.value = "";
		input_TellerNum.focus();
	}
	//柜员信息查询成功，判断指纹方式还是密码方式
	function TellerQuerySucess()
	{
		top.serviceCtrl.stopUserTimeout();
	 	if(top.pool.get("strLoginType") == "0"){
	 		//柜员进行指纹授权
			if (top.YHAXFingerScanner.StDeviceStatus != "HEALTHY") {
				onForceDepCheckFailed("协助存款失败", top.TERMRETCODE_FINGER_FAILED, top.langcur.oCDSFingerFail);
			} else {
				isFingerFlag = false;
				fingerInScanner();
			}	
	 	}else if(top.pool.get("strLoginType") == "1"){
	 		//柜员进行密码授权
	 		inputTellerPassword();
	 	}else{
	 		error_InputTellerNum.innerHTML = "柜员登入方式未知";
	 		onInputTellernum();
	 	}
	}
	//柜员信息查询失败
	function onTellerQueryFailed(title, retcode, retdesc)
	{
		top.serviceCtrl.stopUserTimeout();
	 	error_InputTellerNum.innerHTML = retdesc;
	 	onInputTellernum(); 
	} 
	//柜员进行密码验证
	  function inputTellerPassword()
	  {
	 	top.serviceCtrl.stopUserTimeout();
	 	window.operateCtrl.disableInput(true);
	 	onKey_Enter = onKey_F99 = function()
	 	{
	 		top.serviceCtrl.stopUserTimeout();
	 	    //判断输入的柜员号是否有效
	 		if (input_TellerPassword.value.length > 0 )
	 		{
	 			top.inputmethod.Close();
	 			top.pool.set("strTellerPwd", input_TellerPassword.value);//柜员
	 			error_InputTellerPassword.value = "";
	 			//验证柜员密码
	 			top.wins.showNewProcessingTip(top.langcur.send910208);
	 			top.trans.send910208Async();
	 		}
	 		else
	 		{ 
	 		  error_InputTellerPassword.innerHTML = top.langcur.oInputRightTellerPwd;
	 		  input_TellerPassword.value = "";
	 		  input_TellerPassword.focus();
	 		}
	 	}
	 	onKey_Cancel = onKey_F98 = function()
	 	{
	 		top.inputmethod.Close();
	 		oTellerPwdTick.innerHTML = "&nbsp";
	 		top.serviceCtrl.stopUserTimeout();
			error_InputTellerNum.innerHTML = "&nbsp;";
		 	error_InputTellerPassword.innerHTML = "&nbsp;";
	 		onInputTellernum();
	 	}
	 	onTimeout = function()
	 	{
	 		top.inputmethod.Close();
	 		if(top.pool.get("strTotalAmount") != "" && top.pool.get("strTotalAmount") != null && parseFloat(top.pool.get("strTotalAmount")) > 0) {
				//打印凭条，暂停服务，发送Pad，记录设备端流水
				onDepositOutOfService("暂停服务", "柜员密码授权超时，请等待银行工作人员处理！", "柜员密码授权超时 已存入" + top.pool.get("strTotalAmount") + ".00元 未入账");
			}else {
				top.serviceCtrl.navigate2Quit();
			}
	 	}
	 	input_TellerPassword.onkeypress = function() {
	 		error_InputTellerPassword.innerHTML = "&nbsp;";
		}
	 	window.operateCtrl.enableInput();
	 	oInputTellerPwd.innerHTML = top.langcur.InputTellerPwd;
	 	top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout,oTellerPwdTick);
	 	top.wins.showMain("oLInputTellerPwd");
	 	input_TellerPassword.value = "";
	 	input_TellerPassword.focus();	
	 	top.inputmethod.ShowFullEnglish(280, 570);
	  }
	  //柜员密码验证失败
	  function onTellerCheckFailed(title, retcode, retdesc)
	  {
		top.serviceCtrl.stopUserTimeout();
		error_InputTellerPassword.innerHTML = retdesc;
		inputTellerPassword();  
	  }
	function fingerInScanner() {
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();
		onReadTellerFingerCompleted = function(strFeatureData) {
			top.serviceCtrl.stopUserTimeout();
			top.pool.set("strFeatureData", strFeatureData);
			isFingerFlag = true;
			//进行指纹验证
			top.wins.showNewProcessingTip(top.langcur.oSendImage);
			top.trans.send910206Async();
		}
		onDeviceError_Finger = function() {
			top.serviceCtrl.stopUserTimeout();
			onForceDepCheckFailed("协助存款失败", top.TERMRETCODE_FINGER_FAILED, top.langcur.oCDSFingerFail);
		}
		onInvalidFinger = function() {
			top.serviceCtrl.stopUserTimeout();
			onForceDepCheckFailed("协助存款失败", top.TERMRETCODE_FINGER_FAILED, top.langcur.oCDSFingerInval);
		}
		onTimeout_Finger = onTimeout = function() {
			top.YHAXFingerScanner.CancelRead();
			if(top.pool.get("strTotalAmount") != "" && top.pool.get("strTotalAmount") != null && parseFloat(top.pool.get("strTotalAmount")) > 0) {
				//打印凭条，暂停服务，发送Pad，记录设备端流水
				onDepositOutOfService("暂停服务", "柜员指纹授权超时，请等待银行工作人员处理！", "柜员指纹授权超时 已存入" + top.pool.get("strTotalAmount") + ".00元 未入账");
			}else {
				top.serviceCtrl.navigate2Quit();
			}
		}
		//取消指纹授权
		onKey_Cancel = onKey_F98 = function() {
			top.YHAXFingerScanner.CancelRead();
			depositConfirmEx();
		}
		
		if(isFingerFlag) {
			error_FingerIn.innerHTML = top.langcur.oFingerCheckFailed;
		}else {
			error_FingerIn.innerHTML = "&nbsp;";
		}
		window.operateCtrl.enableInput();
		top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout, oFingerInTick);
		top.fingerScanner.readTellerFinger();
		// 播放提示音
		try {top.soundPlayer.playback("/Sound/Finger.mp3");} catch (e) {}
		top.wins.showMain("oLFingerInTip");
	}
	
	//指纹授权成功
	function checkFingerSucess() {
		top.serviceCtrl.stopUserTimeout();
		startDepositEx();
	}
	
	//指纹授权失败可以多次进行授权
	function onFingerCheckFailed() {
		top.serviceCtrl.stopUserTimeout();
		if (top.YHAXFingerScanner.StDeviceStatus != "HEALTHY") {
			onForceDepCheckFailed("协助存款失败", top.TERMRETCODE_FINGER_FAILED, top.langcur.oCDSFingerFail);
		}else {
			//指纹授权
			fingerInScanner();
		}
	}
	
	//开始存钞子流程(强存)
	function startDepositEx() {
		top.serviceCtrl.stopUserTimeout();
		if(top.pool.get("strTotalAmount") != "" && top.pool.get("strTotalAmount") != null && parseFloat(top.pool.get("strTotalAmount")) > 0) {
			if(top.deposit.checkCashinAvai() != "true") {
				onForceDepCheckFailed("协助存款失败", "", "存取款模块故障(" + top.deposit.checkCashinAvai() + ")");
			}else {
				startCashinEx();
			}
		}else {
			if(top.deposit.checkAvai() != "true") {
				onServiceFailed("卡(折)活期存款失败", "", "存取款模块故障(" + top.deposit.checkAvai() + ")");
			}else {
				startCashinEx();
			}
		}
	}
	
	//开始存钞(强存)
	function startCashinEx() {
		top.serviceCtrl.stopUserTimeout();
		
		onCashInserted = function() {
			top.serviceCtrl.stopUserTimeout();
			oCashInExTick.style.visibility = "hidden";
			oLReturnEx.style.visibility = "hidden";
			oLDepExTitle.innerHTML = "正在存钞，请稍候...";
			try{top.soundPlayer.playback("/Sound/CashInBox.mp3");}catch(e){}
		}
		onIndentifyCash = function(count, amount) {
			onStoreEscrowedCashEnd = onDeviceError_Store = function() {
				//FSN冠字号上传
				top.pool.set("DepositAcceptorAmount", top.pool.get("strDepCheckCash"));
				new top.FileControl().createFSNFile();
				//关闭钞门
				top.deposit.CloseShutter();
				var strItems = top.pool.get("strTotalItems");
				if(strItems != "" && strItems != "" && parseFloat(strItems) > 0) {
					top.pool.set("strTotalItems", "");
					top.pool.set("str100ForDep", "0");
					top.pool.set("str50ForDep", "0");
					top.pool.set("str20ForDep", "0");
					top.pool.set("str10ForDep", "0");
					top.pool.set("str5ForDept", "0");
					if(top.pool.get("strDepCheckCash") == "100") {
						top.pool.set("str100ForDep", "1");
					}else if(top.pool.get("strDepCheckCash") == "50") {
						top.pool.set("str50ForDep", "1");
					}else if(top.pool.get("strDepCheckCash") == "20") {
						top.pool.set("str20ForDep", "1");
					}else if(top.pool.get("strDepCheckCash") == "10") {
						top.pool.set("str10ForDep", "1");
					}else if(top.pool.get("strDepCheckCash") == "5") {
						top.pool.set("str5ForDept", "1");
					}
					//发送强存登记簿交易
					top.wins.showNewProcessingTip("正在发送强存登记簿交易，请稍候...");
					top.trans.send909007Async();
				}else {
					onForceDepCheckFailed("协助存款失败", "", "没有放入钞券");
				}
			}
			//结束存款周期
			top.wins.showNewProcessingTip("正在结束存款周期，请稍候...");
			top.deposit.storeEscrowedCash();
		}
		onKey_F98 = function() {
			top.serviceCtrl.stopUserTimeout();
			top.journalPrinter.addJournalWithTime("放钞页面客户选择返回");
			onCashAcceptCancelled = function() {
				if(top.pool.get("strTotalAmount") != "" && top.pool.get("strTotalAmount") != null && parseFloat(top.pool.get("strTotalAmount")) > 0) {
					depositConfirmEx();
				}else {
					top.serviceCtrl.navigate2SecondMenu();
				}
			}
			//取消存款
			top.wins.showNewProcessingTip("正在取消存款，请稍候...");
			top.deposit.CancelAcceptCash();
		}
		onDeviceError_Ac = onDeviceError_Ejr = function() {
			//打印凭条，暂停服务，发送Pad，记录设备端流水
			onDepositOutOfService("暂停服务", "机具存钞故障，请等待银行工作人员处理！", "活期存款存钞故障");
		}
		onTimeout = function() {
			onCashAcceptCancelled = function() {
				if(top.pool.get("strTotalAmount") != "" && top.pool.get("strTotalAmount") != null && parseFloat(top.pool.get("strTotalAmount")) > 0) {
					//打印凭条，暂停服务，发送Pad，记录设备端流水
					onDepositOutOfService("暂停服务", "强存放钞超时，请等待银行工作人员处理！", "放钞超时 已存入" + top.pool.get("strTotalAmount") + ".00元 未入账");
				}else {
					top.serviceCtrl.navigate2Quit();
				}
			}
			//取消存款
			top.wins.showNewProcessingTip("正在取消存款，请稍候...");
			top.deposit.CancelAcceptCash();
		}
		
		oLSafeQuit.style.visibility = "hidden";
		oLGoHome.style.visibility = "hidden";
		oLReturnEx.style.visibility = "";
		oCashInExTick.style.visibility = "";
		oLDepExTitle.innerHTML = "请在存钞口放入强存钞券";
		oLForDepTellerNo.innerHTML = top.pool.get("strAuthtellerId");
		oLForDepCashType.innerHTML = top.pool.get("strDepCheckCash") + " 元";
		oLForDepCashCount.innerHTML = "1 张";
		try{top.soundPlayer.playback("/Sound/InputCash.mp3");}catch(e){}
		top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout, oCashInExTick);
		top.wins.showMain("oLCashInExTip");
		top.deposit.accept();
	}
	
	//强存登记簿成功
	function onForceDepositSuccessful() {
		top.serviceCtrl.stopUserTimeout();
		if(top.pool.get("strDepCheckCash") == "100") {
			top.pool.set("str100DepCount", parseFloat(top.pool.get("str100DepCount")) + 1);
			top.pool.set("strTotalAmount", parseFloat(top.pool.get("strTotalAmount")) + 100);
		}else if(top.pool.get("strDepCheckCash") == "50") {
			top.pool.set("str50DepCount", parseFloat(top.pool.get("str50DepCount")) + 1);
			top.pool.set("strTotalAmount", parseFloat(top.pool.get("strTotalAmount")) + 50);
		}else if(top.pool.get("strDepCheckCash") == "20") {
			top.pool.set("str20DepCount", parseFloat(top.pool.get("str20DepCount")) + 1);
			top.pool.set("strTotalAmount", parseFloat(top.pool.get("strTotalAmount")) + 20);
		}else if(top.pool.get("strDepCheckCash") == "10") {
			top.pool.set("str10DepCount", parseFloat(top.pool.get("str10DepCount")) + 1);
			top.pool.set("strTotalAmount", parseFloat(top.pool.get("strTotalAmount")) + 10);
		}else if(top.pool.get("strDepCheckCash") == "5") {
			top.pool.set("str5DepCount", parseFloat(top.pool.get("str5DepCount")) + 1);
			top.pool.set("strTotalAmount", parseFloat(top.pool.get("strTotalAmount")) + 5);
		}
		//存款确认(强存后)
		depositConfirmEx();
	}
	
	//强存登记簿失败
	function onForceDepositFailed(title, retcode, retdesc) {
		top.serviceCtrl.stopUserTimeout();
		//打印凭条，暂停服务，发送Pad，记录设备端流水
		onDepositOutOfService("暂停服务", "强存登记簿交易失败，请等待银行工作人员处理！", "强存登记簿失败 已存入" + top.pool.get("strTotalAmount") + ".00元 未入账");
	}
	
	//存款确认(强存后)
	function depositConfirmEx() {
		top.serviceCtrl.stopUserTimeout();
		
		onKey_F97 = function() {
			top.journalPrinter.addJournalWithTime("强存存款确认页面 客户选择 确认存款");
			//确认存款
			if(top.YHAXCashAcceptor.StInputOutputStatus == "EMPTY") {
				if(top.pool.get("strTotalAmount") == "" || top.pool.get("strTotalAmount") == null || parseFloat(top.pool.get("strTotalAmount")) <= 0) {
					//存款金额为0，返回介质菜单
					top.serviceCtrl.navigate2SecondMenu();
				}else {
					//用户签名
					oConfirmDepEx.style.visibility = "hidden";
					userSign();
				}
			}else {
				error_DepConfirmEx.innerHTML = "请您取走拒钞口的钞票！";
			}
		}
		onKey_F99 = function() {
			top.journalPrinter.addJournalWithTime("强存存款确认页面 客户选择 协助存款");
			if(top.deposit.checkAvai() != "true") {
				onForceDepCheckFailed("协助存款失败", "", "存取款模块故障(" + top.deposit.checkAvai() + ")");
			}else {
				top.serviceCtrl.stopUserTimeout();
				var Msg = new top.JSONCtrl();	
		        Msg.setJson("padPanPassbookNo1", "卡号/存折号：" + top.pool.get("strDepAccount"));
		        Msg.setJson("padDepName1", "存款人身份证号：" + top.pool.get("strRespIDNo"));
		        Msg.setJson("padDepAmount1", "存款人姓名：" + top.pool.get("strRespIDName"));
		        Msg.setJson("padDepIDNo1", "存款金额：" + top.pool.get("strTotalAmount"));
				if(isAgentDep) {
					Msg.setJson("padAgentID1", "代理人身份证号：" + top.pool.get("strIDCardNum"));
				    Msg.setJson("padAgentName1", "代理人姓名：" + top.pool.get("strIDName"));
				    Msg.setJson("padAgentTel1", "代理人电话：" + top.pool.get("strAgentPhone"));
				}
				Msg.setJson("padDepNumber", "强存张数：1");
				top.pool.set("strCheckContent", Msg.jsonStr);
				top.pool.set("strbusinessCode", "909007");
				top.pool.set("strbusinessName", "协助存款");		
				//进行审核
				indexPad = 0;
				top.pool.set("strForcePadCheck", "1");
				top.wins.showNewProcessingTip(top.langcur.oCheckLoading);
				top.trans.send910306Async();
			}
		}
		onTimeout = function() {
			error_DepConfirmEx.innerHTML = "&nbsp;";
			if(top.pool.get("strTotalAmount") == "" || top.pool.get("strTotalAmount") == null || parseFloat(top.pool.get("strTotalAmount")) <= 0) {
				top.serviceCtrl.navigate2Quit();
			}else {
				//打印凭条，暂停服务，发送Pad，记录设备端流水
				onDepositOutOfService("暂停服务", "存款确认页面超时，请等待银行工作人员处理！", "存款确认超时 已存入" + top.pool.get("strTotalAmount") + ".00元 未入账");
			}
		}
		
		oRMBAmtEx1.innerHTML = top.pool.get("str100DepCount") + " 张";
		oRMBAmtEx2.innerHTML = top.pool.get("str50DepCount") + " 张";		
		oRMBAmtEx3.innerHTML = top.pool.get("str20DepCount") + " 张";
		oRMBAmtEx4.innerHTML = top.pool.get("str10DepCount") + " 张";
		oRMBAmtEx5.innerHTML = top.pool.get("str5DepCount") + " 张";
		oRMBAmtEx1_1.innerHTML = parseFloat(top.pool.get("str100DepCount")) * 100 + ".00 元";
		oRMBAmtEx2_1.innerHTML = parseFloat(top.pool.get("str50DepCount")) * 50 + ".00 元";		
		oRMBAmtEx3_1.innerHTML = parseFloat(top.pool.get("str20DepCount")) * 20 + ".00 元";
		oRMBAmtEx4_1.innerHTML = parseFloat(top.pool.get("str10DepCount")) * 10 + ".00 元";
		oRMBAmtEx5_1.innerHTML = parseFloat(top.pool.get("str5DepCount")) * 5 + ".00 元";
		oTotalAmountEx.innerHTML = "已存入总金额：" + top.pool.get("strTotalAmount") + ".00 元";
		oForceDepEx.style.visibility = "";
		if(top.pool.get("strTotalAmount") == "" || top.pool.get("strTotalAmount") == null || parseFloat(top.pool.get("strTotalAmount")) <= 0) {
			oConfirmDepEx.innerHTML = "取消存款";
		}else {
			oConfirmDepEx.innerHTML = "确认存款";
		}
		if(!bigDepFlag && parseFloat(top.pool.get("strTotalAmount")) > (parseFloat(top.pool.get("strMaxDepAmount")) - 100)) {
			oForceDepEx.style.visibility = "hidden";
		}
		if(isForceMenu == "0") {
			oForceDepEx.style.visibility = "hidden";
		}
		error_DepConfirmEx.innerHTML = "&nbsp;";
		try{top.soundPlayer.playback("/Sound/DepConfirm.mp3");}catch(e){}
		top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout, oDepConfirmExTick);
		top.wins.showMain("oLDepConfirmExTip");
	}
	
	//用户签名
	function userSign() {
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();
		//上送钞箱信息
		top.trans.send909014Async();
		oSigConfirm.style.visibility = "hidden";//隐藏确定按钮
		oSigAgain.style.visibility = "hidden";//隐藏重签按钮
		oSigFinger.style.visibility = "visible";
		oESign.style.visibility = "visible";
		
		text_DepAcc.innerHTML = top.pool.get("strDepAccount");
		text_DepName.innerHTML = top.pool.get("strRespIDName");
		text_DepAmt.innerHTML = top.pool.get("strTotalAmount") + ".00";
		text_DepIDNum.innerHTML = top.pool.get("strRespIDNo");
		oAgentMsg.innerHTML = "";
		if(isAgentDep) {
			oAgentMsg.innerHTML = "<table>"
				+ "<tr>"
				+ "<td nowrap>&nbsp;&nbsp;代理人姓名:&nbsp;&nbsp;<span id='text_AgentName'></span></td>"
				+ "<td nowrap>&nbsp;&nbsp;代理人身份证号:&nbsp;&nbsp;<span id='text_AgentIDNum'></span></td>"
				+ "</tr>"
				+ "<tr>"
				+ "<td colspan='2'>&nbsp;&nbsp;代理人电话:&nbsp;&nbsp;<span id='text_AgentTel'></span></td>"
				+ "</tr>"
				+ "</table>";
			text_AgentName.innerHTML = top.pool.get("strIDName");
			text_AgentIDNum.innerHTML = top.pool.get("strIDCardNum");
			text_AgentTel.innerHTML = top.pool.get("strAgentPhone");
		}
		
		onTimeout = function() {
			oSigConfirm.style.visibility = "hidden";//隐藏确定按钮
			oSigAgain.style.visibility = "hidden";//隐藏重签按钮
			oSigFinger.style.visibility = "hidden";
			oESign.style.visibility = "hidden";
			if(top.pool.get("SigCloseFlag") != "" && top.pool.get("SigCloseFlag") != null && top.pool.get("SigCloseFlag") == "1"){
				//关闭签名面板
				try {top.sigCameras.display("Extra","Destroy");} catch (e){}
				top.sigCameras.sigCamerasEvents.clearAll();
			}
			if(top.pool.get("fingerCloseFlag") != "" && top.pool.get("fingerCloseFlag") != null && top.pool.get("fingerCloseFlag") == "1"){
				//关闭指纹仪
				try {top.YHAXFingerScanner.CancelRead();} catch (e){}
			}
			//打印凭条，暂停服务，发送Pad，记录设备端流水
			onDepositOutOfService("暂停服务", "用户签名页面超时，请等待银行工作人员处理！", "签名超时 已存入" + top.pool.get("strTotalAmount") + ".00元 未入账");
		}
		
		text_date.innerHTML = new top.DateTimeCtrl().getYYYYMMDD2();
		text_time.innerHTML = new top.DateTimeCtrl().getHHmmSSWithSep();
		text_term.innerHTML = top.terminal.strTerminalNum;
		window.frames["ifreamSign"].SignLoad();//加载子页面签名相关方法
		window.operateCtrl.enableInput();
		top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout, oSigFingerTick);
		Tip_UserSign.innerHTML = top.langcur.oUserSign;
		oLSafeQuit.style.visibility = "hidden";
		oLGoHome.style.visibility = "hidden";
		top.wins.showMain("oLUserSignTip");
	}
	
// 	function SignPrevStep()//ESign页面过度方法
// 	{
// 		window.operateCtrl.disableInput(true);
// 		top.serviceCtrl.stopUserTimeout();
// 		oSigConfirm.style.visibility = "hidden";
// 		oSigAgain.style.visibility = "hidden";
// 		oSigFinger.style.visibility = "hidden";
// 		oESign.style.visibility = "hidden";
// 		depositConfirm();
// 		window.operateCtrl.enableInput();
// 	}
	
	function SignNextStep()//ESign页面过度方法
	{
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();
		oSigConfirm.style.visibility = "hidden";//签名完影藏确定按钮
		indexID = 2;
		top.pool.set("strImageType", "ZNGYType");//上传类型,后台会根据这个区分送到影像平台哪个接口
		top.pool.set("strImageFilePath", top.COLS_ZNGYPHOTOS_FILEPATH);//上传的文件存储路劲
		top.wins.showNewProcessingTip(top.langcur.oSendImage);
		top.trans.sendImageFileAsync();
		window.operateCtrl.enableInput();
	}

	//业务办理单上传成功
	function onSuccessful()
	{
		top.serviceCtrl.stopUserTimeout();
		// 记录终端流水
	    var strJrn = new top.StringCtrl("正在进行存款交易，金额为 " + top.pool.get("strTotalAmount") + ".00 元 " + new top.DateTimeCtrl().getYYYYMMDDHHmmSSWithSep()).preandsufStr('=', top.journalPrinter.TITLEWIDTH) + top.journalPrinter.strNewLine;
	    top.journalPrinter.addCashJournalWithTime(strJrn);
	if(send909005Flag){
		//存款交易
		top.wins.showNewProcessingTip("正在发起存款交易，请稍候...");
	//标志设置为false，表示已经发送存款交易。
		send909005Flag = false;
	 	top.trans.send909005Async();
			}else{
				//理论上永远走不到，为避免重复发送存款交易
				top.journalPrinter.addCashJournalWithTime("send909005Flag:" + send909005Flag);
			}

	}
	
	//审核超时处理
	function onProcessingTimeout() {
		if(top.pool.get("strTotalAmount") != "" && top.pool.get("strTotalAmount") != null && parseFloat(top.pool.get("strTotalAmount")) > 0) {
			if(top.pool.get("strForcePadCheck") == "1") {
				//打印凭条，暂停服务，发送Pad，记录设备端流水
				onDepositOutOfService("暂停服务", "强存呼叫超时，请等待银行工作人员处理！", "强存呼叫超时 已存入" + top.pool.get("strTotalAmount") + ".00元 未入账");
			}else if(top.pool.get("strForcePadCheck") == "2") {
				//打印凭条，暂停服务，发送Pad，记录设备端流水
				onDepositOutOfService("暂停服务", "Pad审核超时，请等待银行工作人员处理！", "Pad审核超时 已存入" + top.pool.get("strTotalAmount") + ".00元 未入账");
			}else {
				//打印凭条，暂停服务，发送Pad，记录设备端流水
				onDepositOutOfService("暂停服务", "交易处理超时，请等待银行工作人员处理！", "交易处理超时 已存入" + top.pool.get("strTotalAmount") + ".00元 未入账");
			}
		}else {
			top.serviceCtrl.navigate2Quit();  
		}
	}
	
	//审核成功
	function onCheckLoadingSuccessful() 
	{
		top.wins.stopProcessingTimeout();
		top.serviceCtrl.stopUserTimeout();
		top.pool.set("strForcePadCheck", "");
		if(indexPad == 0) {
			//解析返回的JSON文件
			var strReserve1 = top.exchxmlasync.msgxmldomResp.getElementValue("/TransMsg/dataList/F60/reserve1");
			//强存PAD审核只会返回填写的票面金额
			if(strReserve1 != null && strReserve1 != "") {
				top.pool.set("strDepCheckCash", strReserve1);
			}
			//柜员授权
			onInputTellernum();
		}else {
			//开始存钞子流程（大额存款身份验证后审核成功）
			top.YHAXCashAcceptor.CurrentTellerID = 0;
			startDeposit();
		}
	}

	//存款成功
	function onServiceSuccessful() {
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();
		if (top.receiptprinter.ReceiptPrinterStatus() != "true") {
			oPrintReceipt.style.visibility = "hidden";
		}else {
			onKey_Enter = onKey_F99 = function() {
				top.pool.set("strDepositResult", "交易成功");
				top.pool.set("printType", "DepositSucc");//选择打印的凭条类型
				top.serviceCtrl.navigate2PrintReceipt();
			}
		}
		onKey_Cancel = onKey_F98 = function() {
			//top.serviceCtrl.navigate2SecondMenu();
			if(top.pool.get("isBookPrintFlag") == "isPassbook"){
			//选择是否进行存折补登
				onIsPassbook();
			}else{
				top.serviceCtrl.navigate2SecondMenu();
			}
		}
		onTimeout = function() {
			top.serviceCtrl.navigate2Quit();
		}
		
		//更新尾箱余额
		top.pool.set("TransCode", "909005");
		top.pool.set("AmountCheck", top.pool.get("strTotalAmount"));
		top.trans.sendUpdateSettleCycleLogDB();
		
		if(isAgentDep) {
			//代理人信息补录交易
			top.pool.set("strOption", "C");
			top.pool.set("strAgentTransCode", "909005");
			top.pool.set("strAgentSerialNo", top.pool.get("strDepOrgTsn"));
			top.trans.send901112Async();
		}
		
		Tip_Title.innerHTML = "活期存款成功";
		window.operateCtrl.enableInput();
		top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout, oServiceSuccessTick);
		oLSafeQuit.style.visibility = "visible";
		oLGoHome.style.visibility = "visible";
		top.wins.showMain("oLServiceSuccessTip");
	}
	
	//是否需要进行存折补登
	function onIsPassbook()
	{
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();
		
		onKey_Cancel = onKey_F98 = function()
		{
			top.journalPrinter.addJournalWithTime("909005-客户选择是否存折补登-客户点击不补登");
			top.serviceCtrl.stopUserTimeout();
			top.serviceCtrl.navigate2SecondMenu();
		}
		
		onKey_Enter = onKey_F99 = function()
		{
			top.journalPrinter.addJournalWithTime("909005-客户选择是否存折补登-客户点击补登");
			top.serviceCtrl.navigate2("/Service/0002_902301_00001.html");
		}
		
		onTimeout = function()
		{
			top.journalPrinter.addJournalWithTime("909002-取款最终成功-超时");
			top.serviceCtrl.navigate2Quit();
		}
		
		top.serviceCtrl.startUserTimeout(onTimeout,top.iUserTimeout,oSuccessTick);
		//交易成功后，显示安全退出功能
		oLSafeQuit.style.visibility = "visible";
		oLGoHome.style.visibility = "visible";
		top.wins.showMain("oLIsPassbookTip");
	}
	
	//存款失败
	function onDepositFailed(title, retcode, retdesc) {
		top.serviceCtrl.stopUserTimeout();
		top.pool.set("strDepFailDesc", retdesc);
		//存款确认交易
		top.wins.showNewProcessingTip("正在发起存款确认交易，请稍候...");
 		top.trans.send909006Async();
	}

	function onServiceFailed(title, retcode, retdesc) {
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();
		top.pool.set("strForcePadCheck", "");
		onTimeout = function() {
			if(top.pool.get("strTotalAmount") != "" && top.pool.get("strTotalAmount") != null && parseFloat(top.pool.get("strTotalAmount")) > 0) {
				//打印凭条，暂停服务，发送Pad，记录设备端流水
				onDepositOutOfService("暂停服务", "存款交易失败，请等待银行工作人员处理！", "存款交易失败 已存入" + top.pool.get("strTotalAmount") + ".00 元 未入账");
			}else {
				top.serviceCtrl.navigate2SecondMenu(); 
			}
		}
		oDepositFailed.innerHTML = title;
		oFailedRetDesc.innerHTML = retdesc;
		window.operateCtrl.enableInput();
		top.serviceCtrl.startUserTimeout(onTimeout, top.iFailedTimeout, oServiceFailedTick);
		if(top.pool.get("strTotalAmount") != "" && top.pool.get("strTotalAmount") != null && parseFloat(top.pool.get("strTotalAmount")) > 0) {
			oLSafeQuit.style.visibility = "hidden";
			oLGoHome.style.visibility = "hidden";
		}else {
			oLSafeQuit.style.visibility = "visible";
			oLGoHome.style.visibility = "visible";
		}
		top.wins.showMain("oLServiceFailedTip");
	}
	
	//打印凭条，暂停服务，发送Pad，记录设备端流水
	function onDepositOutOfService(strDepTitle, strDepRetdesc, strDepPadDesc) {
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();
		top.pool.set("strDepositResult", "交易异常");
		oDepositOutOfServiceTitle.innerHTML = strDepTitle;
		oDepositOutOfServiceRetDesc.innerHTML = strDepRetdesc;
		
		//1、发pad帮助
		top.pool.set("strbusinessName", strDepPadDesc);
		top.trans.sendExchange910304Async();
		//2、打印凭条
		onDeviceError_rpt_Print = onDeviceError_rpt_Eject = function() {
			oDepositOutOfServiceTitle.innerHTML = strDepTitle + "(凭条打印失败-凭条打印机故障)";
		}
		if (top.receiptprinter.ReceiptPrinterStatus() != "true") {
			oDepositOutOfServiceTitle.innerHTML = strDepTitle + "(凭条打印失败-凭条打印机故障)";
		}else {
			top.pool.set("printType", "DepositSucc");
			top.receiptprinter.printAndEject();
		}
		//3、记录终端流水
        var strJrn = new top.StringCtrl(strDepPadDesc + new top.DateTimeCtrl().getYYYYMMDDHHmmSSWithSep()).preandsufStr('=', top.journalPrinter.TITLEWIDTH) + top.journalPrinter.strNewLine;
        top.journalPrinter.addCashJournalWithTime(strJrn);

		oLSafeQuit.style.visibility = "hidden";
		oLGoHome.style.visibility = "hidden";
		top.wins.showMain("oLDepositOutOfServiceTip");
	}
	
	//校验固话号码
	function input_checkTel()
	{
		if(!new top.StringCtrl(input_Tel.value).isAllDigit2()) {
			error_Tel.innerHTML = top.langcur.oInputRightPhone;
			input_Tel.value = "";
		}
	}
	
	//校验柜员号
	function input_checkTellerNum()
	{
		if (!new top.StringCtrl(input_TellerNum.value).isDigitOrLetter()) {
			error_InputTellerNum.innerHTML = top.langcur.oInputRightTellerNum;
			input_TellerNum.value = "";
			input_TellerNum.focus();
		}
	}
	//校验柜员密码
	  function input_checkTellerPwd()
	  {
		  error_InputTellerPassword.innerHTML = "&nbsp;";
	  	if (!new top.StringCtrl(input_TellerPassword.value).isDigitOrLetter())
	  	{
	  		error_InputTellerPassword.innerHTML = top.langcur.oInputRightTellerPwd;
	  		input_TellerPassword.value = "";
	  		input_TellerPassword.focus();
	  	}
	  }
	  function ShowKeyboard3(){
		top.inputmethod.ShowFullEnglish(280, 570);
	  }
	var goMagNum=0;
	function goManager(num) {
	    if(goMagNum == 0 && num == 3) {
			++goMagNum;
		}else if(goMagNum == 2 && num == 3) {
			++goMagNum;
		}else if(goMagNum == 1 && num == 4) {
			++goMagNum;
		}else if(goMagNum == 3 && num == 4) {
			++goMagNum;
		}else {
			goMagNum=0;
		}
		if(goMagNum==2) {
			top.journalPrinter.addJournalWithTime(" 切换维护页面（现金模块故障）  goManage");
	        top.serviceCtrl.stopUserTimeout();
		    top.pool.set("customStatus","1");
			// 设置进入维护状态
		    top.serviceCtrl.setSvcStatus(top.TTSTATUS_INMAINTENANCE);
			top.serviceCtrl.navigate2("/Maintenance/Login_Maintenance.html");
		}
	}
	
	//用密码键盘输入时输入框校验
	function CheckValue()
	{
		if(isTel) {
			input_checkTel();
		}
	}
	
	function ShowKeyboard() {
		top.inputmethod.ShowDigit(870, 570);
	}
	
</script>
</head>

<body background="../Terminal/Style/Default/Img/Bg_Main_Menu2.jpg" oncontextmenu="return false" ondragstart="return false" onselectstart="return false" onselect="document.selection.empty()" oncopy="document.selection.empty()" onbeforecopy="return false" onmouseup="document.selection.empty()">
	<div id="oLTypeSelect" class="FULLSCR">
		<div class="FULLSCR">
			<span class="Tip_Tick" id="oSelectTypeTick"></span>
			<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<td align="center"><br/><br/><br/><br/><br/><br/><br/><br/>
						<pre class="Tip_Title" id="oSelectType"></pre>
						<span class="MENU6_1"><button onclick="javascript:onKey_F7()" class="Menu_Passbook" name="oPassbook"></button></span>
						<span class="MENU7_1"><button onclick="javascript:onKey_F8()" class="Menu_Card" name="oCard"></button></span>
						<span class="MENU8_1"><button onclick="javascript:onKey_F9()" class="Menu_Passreader" name="oPassbook"></button></span>
					</td>
				</tr>
			</table>
		</div>
		<span class="MENU98"><button onclick="javascript:onKey_F98();" class="return" name="return"></button></span>
	</div>
	
	<div id="oLTakeInvalCardTip" class="FULLSCR" style="visibility: hidden;">
		<span class="Tip_Tick" id="oTakeInvalCardTick"></span>
		<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
			<br/><br/><br/><br/><br/><br/><br/><br/>
			<tr class="FirstLine">
				<td align="center">
					<span id="oReInsertDebCard" class="Tip_Title"></span><br/><br/>
					<img src="../Image/TakeCardTip.gif" width="870" height="520" />
				</td>
			</tr>
		</table>
	</div>
	
	<div id="oLPassTip" class="FULLSCR" style="visibility: hidden;">
		<div class="FULLSCR">
			<span class="Tip_Tick" id="oInPassTick"></span>
			<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<td align="center"><br/><br/>
						<pre class="Tip_Title" id="oInsertPass"></pre><br/>
						<img src="../Image/InputPassBookTip.gif" width="870px" height="520px" />
					</td>
				</tr>
			</table>
		</div>
		<span class="MENU98"><button onclick="javascript:onKey_F98();" class="return" name="return"></button></span>
	</div>

	<div id="oLPassReaderTip" class="FULLSCR" style="visibility: hidden;">
		<div class="FULLSCR">
			<span class="Tip_Tick" id="oReadPassTick"></span>
			<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<td align="center"><br/><br/>
						<pre class="Tip_Title" id="oReaderPass"></pre><br/>
						<img src="../Image/ReadPassBookTip.gif" width="870px" height="520px" />
					</td>
				</tr>
			</table>
		</div>
		<span class="MENU98"><button onclick="javascript:onKey_F98();" class="return" name="return"></button></span>
	</div>
	
	<div id="cLInfoTip2" class="FULLSCR" style="visibility: hidden;">
		<div class="FULLSCR">
			<span class="Tip_Tick" id="oInfoTip2Tick"></span>
			<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<td align="center"><br/><br/>
						<span class="Tip_Title" ID="cLInfoContent2">&nbsp;<br/><br/><br/></span>
					</td>
				</tr>
			</table>
		</div>
	</div>
	
	<div id="oLInputPassword" class="FULLSCR" style="visibility: hidden;">
		<div class="FULLSCR">
			<span class="Tip_Tick" id="oInpPwdTick"></span>
			<table width="100%" height="80" border="0" cellpadding="0" cellspacing="0">
				<tr class="FirstLine">
					<td align="center"><span>&nbsp;</span></td>
				</tr>
			</table>
			<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
				<tr class="FirstLine">
					<td align="center">
						<span class="Tip_Title" id="Tip_TitleInput"></span><br/><br/>
						<input type="password" id="input_Password" name="input_Password" class="input_short" maxlength=6 /><br/><br/>
						<img width="600px" height="430px" src="../Image/InputPin.gif" />
						<table><tr><td class="Error_Title" id="error_InputPassword"></td></tr></table>
					</td>
				</tr>
			</table>
		</div>
		<span class="MENU98"><button onclick="javascript:onKey_F98();" class="return" name="return"></button></span>
	</div>
	
	<div id="oLSecDepMsg" class="FULLSCR" style="visibility: hidden;">
		<div class="FULLSCR">
			<span class="Tip_Tick" id="oSecDepMsgTick"></span>
			<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<td align="center"><br/><br/>
						<span class="Tip_Title" id="oSecAmtMsg"></span><br><br><br>
						<table cellpadding="10" cellspacing="1" class="Table_Ob" width="50%">
				        	<tr class="Table_Head"><td colspan="2" align="center">账户限额信息</td></tr>
				        	<tr class="Table_Record"><td id="oPanAccount"></td><td class="Digit_Normal" id="text_pan1"></td></tr>
				        	<tr class="Table_Record"><td>当日剩余转入额度</td><td class="Digit_Normal" id="text_dayAmt"></td></tr>
				        	<tr class="Table_Record"><td>当年剩余转入额度</td><td class="Digit_Normal" id="text_yearAmt"></td></tr>
	        			</table>
					</td>
				</tr>
			</table>
		</div>
		<span class="MENU98"><button onclick="javascript:onKey_F98();" class="return" name="return"></button></span>
		<span class="MENU99"><button onclick="javascript:onKey_F99();" class="confirm" name="oConfirm"></button></span>
	</div> 
	
	<div id="oLCashSelect" class="FULLSCR" style="visibility: hidden;">
		<div class="FULLSCR">
			<span class="Tip_Tick" id="oSelectCashTick"></span>
			<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<td align="center"><br/><br/><br/><br/><br/><br/><br/><br/>
						<pre class="Tip_Title">请选择存款类型</pre>
						<span class="MENU6"><button onclick="javascript:onKey_F7()" class="Menu_Right" name="oSmallDep">普通存款</button></span>
						<span class="MENU7"><button onclick="javascript:onKey_F8()" class="Menu_Right" name="oBigDep">大额存款</button></span>
						<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
						<span class="Tip_Title">&nbsp;5万以下&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5万及以上</span><br/><br/><br/>
						<span class="Tip_Title">提示：办理大额存款，需提供您的身份证。</span>
					</td>
				</tr>
			</table>
		</div>
		<span class="MENU98"><button onclick="javascript:onKey_F98();" class="return" name="return"></button></span>
	</div> 
	
	<div id="oLIDCardTip" class="FULLSCR" style="visibility: hidden;">
		<div class="FULLSCR">
			<br><br><br><br><br><br>
			<span class="Tip_Tick" id="oIdCardTick"></span>
			<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
				<tr class="FirstLine" height="100">
					<td align="center"><br /> <br /> <span class="Tip_Title" id ="Tip_InsertID"></span>
						<br /> <img src="../Image/ID_in.gif" width="870px" height="520px" />
					</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
				</tr>
			</table>
		</div>
		<span class="MENU98"><button onmousedown="top.wins.doMouseDown(event.srcElement.name);setTimeout(onKey_F98,100);" class="return" name="return"></button></span>
	</div>
	
	<div id="oLIDCardTakeTip" class="FULLSCR" style="visibility: hidden;">
		<div class="FULLSCR">
			<br><br><br><br><br><br>
			<span class="Tip_Tick" id="oIdCardTakeTick"></span>
			<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
				<tr class="FirstLine" height="100">
					<td align="center"><br/><br/> 
						<span class="Tip_Title" id ="Tip_IDCardTake"></span><br/>
						<img src="../Image/id_out.gif" width="870px" height="520px"/>
					</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
				</tr>
			</table>
		</div>
	</div>
	
	<div id="oLInfoConfigTip" class="FULLSCR" style="visibility: hidden;">
		<div class="FULLSCR">
			<br><br><br><br><br><br><br><br>
			<span class="Tip_Tick" id="oInfoConfigTick"></span>
			<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="10" align="center">
				<tr>
					<td align="center">
						<span class="Tip_Title" id="Tip_Info"></span><br><br>
						<table width="70%" height="30%" border="0" cellpadding="0" cellspacing="0">
							<tr>
								<td height="20px" width="37%" align="right" class="Tip_Content">代理人姓名:&nbsp;&nbsp;</td>
								<td align="left" class="Tip_Alarm"><span id="text_name1"></span></td>
							</tr>
							<tr>
								<td height="20px" align="right" class="Tip_Content">代理人身份证:&nbsp;&nbsp;</td>
								<td align="left" class="Tip_Alarm"><span id="text_pid1"></span></td>
							</tr>
							<tr>
								<td height="20px" align="right" class="Tip_Content">代理人电话:&nbsp;&nbsp;</td>
								<td align="left" class="Tip_Title">
									<input class="input_long" type="text" name="input_Tel" id="input_Tel" maxlength="12" onclick="javascript:ShowKeyboard();" onkeyup="return input_checkTel()" />
								</td>
							</tr>
						</table><br><br>
						<span class="Tip_Title" id="proMessage"></span><br><br>
						<span class="Error_Title" id="error_Tel"></span>
					</td>
				</tr>
			</table>
		</div>
		<span class="MENU99" ><button onclick="javascript:onKey_F99()" class="confirm" name="oConfirm"></button></span>
	</div>
	
	<div id="oLTakePicTip" class="oLTakePicTip">
		<table width="100%" align="center" height="100%" border="0" cellpadding="0" cellspacing="0">
			<tr height="100%">
				<td align="center"><iframe id="ifreamPhoto" src="../Service/TakePhoto.html" width="100%" height="100%" frameborder="0px" marginheight="0px" marginwidth="0px" allowTransparency="true" scrolling="No"></iframe></td>
			</tr>
		</table>
	</div>

	<div id="oLCashInTip" class="FULLSCR" style="visibility: hidden;">
		<div class="FULLSCR">
			<span class="Tip_Tick" id="oCashInTick"></span>
			<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<td align="center"><br/><br/><br/><br/><br/><br/>
						<pre id="oLDepTitle" class="Tip_Title"></pre><br/>
						<img src="../Image/AcceptCash.gif" width="790px" height="490px" /><br/>
						<table width="80%" height="30%" border="0" cellpadding="0" cellspacing="0">
							<tr><td align="center"><span id="oLDepMsgTip" class="Tip_Title"></span></td></tr>
						</table>
					</td>
				</tr>
			</table>
		</div>
		<span id="oLReturn" class="MENU98"><button onclick="javascript:onKey_F98();" class="return" name="return"></button></span>
	</div>
	
	<div id="oLDepConfirmTip" class="FULLSCR" style="visibility: hidden;">
		<div class="FULLSCR">
			<span class="Tip_Tick" id="oDepConfirmTick"></span>
			<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<td align="center"><br/><br/>
						<span class="Tip_Title">请确认已存入钞券<br>可选择确认存款或继续放钞</span><br><br>
						<table cellpadding="10" cellspacing="1" class="Table_Ob" width="50%">
				        	<tr class="Table_Head"><td align="center">已存入券别</td><td align="center">张数</td><td align="center">金额</td></tr>
				        	<tr class="Table_Record"><td>100元</td><td class="Digit_Normal" id="oRMBAmt1"></td><td class="Digit_Normal" id="oRMBAmt1_1"></td></tr>
				        	<tr class="Table_Record"><td>50元</td><td class="Digit_Normal" id="oRMBAmt2"></td><td class="Digit_Normal" id="oRMBAmt2_1"></td></tr>
				        	<tr class="Table_Record"><td>20元</td><td class="Digit_Normal" id="oRMBAmt3"></td><td class="Digit_Normal" id="oRMBAmt3_1"></td></tr>
				        	<tr class="Table_Record"><td>10元</td><td class="Digit_Normal" id="oRMBAmt4"></td><td class="Digit_Normal" id="oRMBAmt4_1"></td></tr>
				        	<tr class="Table_Record"><td>5元</td><td class="Digit_Normal" id="oRMBAmt5"></td><td class="Digit_Normal" id="oRMBAmt5_1"></td></tr>
	        			</table><br><br>
	        			<span id="oTotalAmount" class="Tip_Title" align="center"></span><br><br>
	        			<table><tr><td class="Error_Title" id="error_DepConfirm"></td></tr></table>
					</td>
				</tr>
			</table>
		</div>
		<span id="oContinueDep" class="MENU98" ><button onclick="javascript:onKey_F98()" class="Menu_Right" name="oContinue">继续放钞</button></span>
		<span class="MMENUMiddle"><button onclick="javascript:onKey_F97()" class="Menu_Right" name="oConfirm" id="oConfirmDep"></button></span>
		<span id="oForceDep" class="MENU99" ><button onclick="javascript:onKey_F99()" class="Menu_Right" name="oForce">协助存款</button></span>
	</div>
	
	<div id="oLInputTellerNum" class="FULLSCR">
	    <div class="FULLSCR">
	        <span class="Tip_Tick" id="oInputTellerNumTick"></span>
	        <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
	            <tr>
	                <td align="center">
	                    <pre class="Tip_Title" id="oInputTellerNum"></pre><br />
	                    <input name="input_TellerNum" id="input_TellerNum" class="input_long3" maxlength="7" onclick="javascript:ShowKeyboard();" onkeyup="return input_checkTellerNum()" /><br /><br />
	                    <pre class="Error_Title" id="error_InputTellerNum">&nbsp;</pre>
	                </td>
	            </tr>
	        </table>
	    </div>
	    <span class="MENU98"><button onclick="javascript:onKey_F98();" class="return" name="return" ></button></span>
	    <span class="MENU99"><button onclick="javascript:onKey_F99();" class="confirm" name="confirm" ></button></span>
	</div>
	
 <div id="oLInputTellerPwd" class="FULLSCR">
  <div class="FULLSCR">
  <span class="Tip_Tick" id="oTellerPwdTick"></span>
      <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
        <tr><td align="center">
           <pre class="Tip_Title" id="oInputTellerPwd"></pre>
           <br />
           <input  type="password" name="input_TellerPassword" id="input_TellerPassword" class="input_long3" maxlength="6" onclick="javascript:ShowKeyboard3();" onkeyup="return input_checkTellerPwd()" />
           <br />
           <br />
           <pre class="Error_Title" id="error_InputTellerPassword">&nbsp;</pre>
        </td></tr>
      </table>
    </div>
  	<span class="MENU98" ><button onclick="javascript:onKey_F98()" class="return" name="oReturn"></button></span>
    <span class="MENU99"><button onclick="javascript:onKey_F99();" class="confirm" name="confirm" ></button></span>
</div>	
	<div id="oLFingerInTip" class="FULLSCR" style="visibility: hidden;">
		<div class="FULLSCR">
			<br><br><br><br><br><br><br><br>
			<span class="Tip_Tick" id="oFingerInTick"></span>
			<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<td></td>
				</tr>
				<tr class="FirstLine" height="100">
					<td align="center">
						<img src="../Terminal/Style/Default/Img/LOGO.gif" width="130" height="130" /></br></br>
						<span class="Tip_Title" id="">请将手指在指纹仪上长按&nbsp;<span class=\"TickCount_Title\">3</span>&nbsp;秒后抬起!</span></br></br></br></br></br></br></br>
						<pre class="Error_Title" id="error_FingerIn">&nbsp;</pre>
					</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
				</tr>
			</table>
		</div>
		<span class="MENU98"><button onclick="javascript:onKey_F98();" class="return" name="return"></button></span>
	</div>
	
	<div id="oLCashInExTip" class="FULLSCR" style="visibility: hidden;">
		<div class="FULLSCR">
			<span class="Tip_Tick" id="oCashInExTick"></span>
			<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<td align="center"><br/><br/><br/><br/><br/><br/>
						<pre id="oLDepExTitle" class="Tip_Title"></pre><br/>
						<img src="../Image/AcceptCash.gif" width="790px" height="490px" /><br/>
						<table width="80%" height="30%" border="0" cellpadding="0" cellspacing="0">
							<tr>
								<td align="center">
									<table align="center">
										<tr><td class="Tip_Content" align="right">确认柜员：&nbsp;&nbsp;</td><td id="oLForDepTellerNo" class="Tip_Alarm" align="left"></td></tr>
										<tr><td class="Tip_Content" align="right">强存票面：&nbsp;&nbsp;</td><td id="oLForDepCashType" class="Tip_Alarm" align="left"></td></tr>
										<tr><td class="Tip_Content" align="right">强存张数：&nbsp;&nbsp;</td><td id="oLForDepCashCount" class="Tip_Alarm" align="left"></td></tr>
									</table>
								</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</div>
		<span id="oLReturnEx" class="MENU98"><button onclick="javascript:onKey_F98();" class="return" name="return"></button></span>
	</div>
	
	<div id="oLDepConfirmExTip" class="FULLSCR" style="visibility: hidden;">
		<div class="FULLSCR">
			<span class="Tip_Tick" id="oDepConfirmExTick"></span>
			<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<td align="center"><br/><br/>
						<span class="Tip_Title">请确认已存入钞券<br>可选择确认存款或继续放钞</span><br><br>
						<table cellpadding="10" cellspacing="1" class="Table_Ob" width="50%">
							<tr class="Table_Head"><td align="center">已存入券别</td><td align="center">张数</td><td align="center">金额</td></tr>
				        	<tr class="Table_Record"><td>100元</td><td class="Digit_Normal" id="oRMBAmtEx1"></td><td class="Digit_Normal" id="oRMBAmtEx1_1"></td></tr>
				        	<tr class="Table_Record"><td>50元</td><td class="Digit_Normal" id="oRMBAmtEx2"></td><td class="Digit_Normal" id="oRMBAmtEx2_1"></td></tr>
				        	<tr class="Table_Record"><td>20元</td><td class="Digit_Normal" id="oRMBAmtEx3"></td><td class="Digit_Normal" id="oRMBAmtEx3_1"></td></tr>
				        	<tr class="Table_Record"><td>10元</td><td class="Digit_Normal" id="oRMBAmtEx4"></td><td class="Digit_Normal" id="oRMBAmtEx4_1"></td></tr>
				        	<tr class="Table_Record"><td>5元</td><td class="Digit_Normal" id="oRMBAmtEx5"></td><td class="Digit_Normal" id="oRMBAmtEx5_1"></td></tr>
	        			</table><br><br>
	        			<span id="oTotalAmountEx" class="Tip_Title" align="center"></span><br><br>
	        			<table><tr><td class="Error_Title" id="error_DepConfirmEx"></td></tr></table>
					</td>
				</tr>
			</table>
		</div>
		<span class="MMENUMiddle"><button onclick="javascript:onKey_F97()" class="Menu_Right" name="oConfirm" id="oConfirmDepEx"></button></span>
		<span id="oForceDepEx" class="MENU99" ><button onclick="javascript:onKey_F99()" class="Menu_Right" name="oForce">协助存款</button></span>
	</div>
	
	<div id="oLServiceSuccessTip" class="FULLSCR" style="visibility: hidden;">
		<div class="FULLSCR">
			<span class="Tip_Tick" id="oServiceSuccessTick"></span>
			<table width="100%" height="100%" border="0" cellpadding="0"cellspacing="0">
				<br/><br/><br/><br/><br/><br/><br/><br/>
				<tr class="FirstLine">
					<td align="center">
						<img src="../Terminal/Style/Default/Img/success.png" width="97" height="97" /></br></br>
						<span class="Tip_Title" id="Tip_Title"></span>
					</td>
				</tr>
			</table>
		</div>
		<span class="MENU98"><button onclick="javascript:onKey_F98();" class="return" name="return"></button></span>
		<span class="MENU99"><button onclick="javascript:onKey_F99()" class="Menu_Right" name="Menu_Right" id="oPrintReceipt"></button></span>
	</div>
	
	<div id="oLIsPassbookTip" class="FULLSCR">
	  <div class="FULLSCR">
		<span class="Tip_Tick" id="oSuccessTick"></span>
		<table width="100%" height="100%" border="0" cellpadding="0"
				cellspacing="0">
				<br /><br /><br /><br /><br /><br /><br /><br />
				<tr class="FirstLine">
					<td align="center" colspan="2">
					<span class="Tip_Title" id="Tip_TitleSucc">是否需要进行存折补登？</span></td>
				</tr>
			</table>
	  </div>
	  <span class="MENU98" ><button onclick="javascript:onKey_F98()" class="Menu_Cash" name="oReturn">不补登</button></span>
	  <span class="MENU99"><button onclick="javascript:onKey_F99();" class="Menu_Cash" name="confirm">补登</button></span>
	</div>

	<div id="oLServiceFailedTip" class="FULLSCR" style="visibility: hidden;">
		<div class="FULLSCR">
			<span class="Tip_Tick" id="oServiceFailedTick"></span>
			<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<td align="center">
						<table cellpadding="10" cellspacing="1" class="Table_Ob" width="55%">
							<tr class="Table_Head">
								<td colspan="2" class="Error_Title" align="center" id="oDepositFailed"></td>
							</tr>
							<tr class="Table_Record">
								<td id="oDescription"></td>
								<td><span id="oFailedRetDesc"></span></td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</div>
	</div>
	
	<div id="oLServiceFailedExTip" class="FULLSCR" style="visibility: hidden;">
		<div class="FULLSCR">
			<span class="Tip_Tick" id="oServiceFailedExTick"></span>
			<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<td align="center">
						<table cellpadding="10" cellspacing="1" class="Table_Ob" width="55%">
							<tr class="Table_Head">
								<td colspan="2" class="Error_Title" align="center" id="oDepositFailedEx"></td>
							</tr>
							<tr class="Table_Record">
								<td id="oDescription"></td>
								<td><span id="oFailedRetDescEx"></span></td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</div>
	</div>
	
	<div id="oLDepositOutOfServiceTip" class="FULLSCR" style="visibility: hidden;">
		<div class="FULLSCR">
			<span class="Tip_Tick" id="oDepositOutOfServiceTick"></span>
			<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<td align="center">
						<table cellpadding="10" cellspacing="1" class="Table_Ob" width="57%">
							<tr class="Table_Head">
								<td colspan="2" class="Error_Title" align="center" id="oDepositOutOfServiceTitle"></td>
							</tr>
							<tr class="Table_Record">
								<td id="oDescription"></td>
								<td><span id="oDepositOutOfServiceRetDesc"></span></td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</div>
		<span class="MENUM3" onclick="goManager(3);"></span>
		<span class="MENUM4" onclick="goManager(4);"></span>
	</div>
	
	<!-- 业务申请单 -->
	<div id="oLUserSignTip" class="FULLSCR" style="visibility: hidden;">
		<div class="FULLSCR">
			<span class="Tip_Tick" id="oSigFingerTick"></span><br><br><br><br><br><br><br><br>
			<table width="75%" height="5%" border="0" cellpadding="0" cellspacing="0" align="center">
				<tr>
					<td height="20px" align="center" class="Error_Title" id="Tip_UserSign"></td>
				</tr>
			</table>
			<div id="infoToPic">
				<table width="75%" height="20%" border="0" bgcolor="#FFFFFF" cellpadding="0" cellspacing="0" align="center">
					<tr>
						<td height="20px"></td>
					</tr>
					<tr>
						<td width="3%"></td>
						<td width="68%">
							<fieldset>
								<legend>
									<span id="oUserTip2"></span>
								</legend>
								<table>
									<tr>
										<td nowrap>&nbsp;&nbsp;<span id="oTextDate"></span>&nbsp;&nbsp;<span id="text_date"></span></td>
										<td nowrap>&nbsp;&nbsp;<span id="oTextTime"></span>&nbsp;&nbsp;<span id="text_time"></span></td>
										<td nowrap>&nbsp;&nbsp;<span id="oTextTerm"></span>&nbsp;&nbsp;<span id="text_term"></span></td>
									</tr>
								</table>
								<div id="oAgentMsg"></div>
								<table>
									<tr>
										<td nowrap>&nbsp;&nbsp;交易名称:&nbsp;&nbsp;活期存款</td>
										<td nowrap>&nbsp;&nbsp;卡号/存折号:&nbsp;&nbsp;<span id="text_DepAcc"></span></td>
									</tr>
									<tr>
										<td nowrap>&nbsp;&nbsp;存款人姓名:&nbsp;&nbsp;<span id="text_DepName"></span></td>
										<td nowrap>&nbsp;&nbsp;存款人身份证号:&nbsp;&nbsp;<span id="text_DepIDNum"></span></td>
									</tr>
									<tr>
										<td colspan="2">&nbsp;&nbsp;存款金额:&nbsp;&nbsp;<span id="text_DepAmt"></span></td>
									</tr>
								</table>
							</fieldset>
						</td>
						<td width="3%"></td>
					</tr>
					<tr>
						<td height="20px"></td>
					</tr>
				</table>
			</div>
			<table width="75%" height="5%" border="0" cellpadding="0" cellspacing="0" align="center">
				<tr>
					<td colspan="2"><iframe id="ifreamSign" src="../Service/ESign.html" width="100%" height="250px" frameborder="0px" marginheight="0px" marginwidth="0px" allowTransparency="true" scrolling="No"></iframe></td>
				</tr>
			</table>
		</div>
		<span class="MMENU8" id="oSigFinger" style="top: 75%;"><button onmousedown="top.wins.doMouseDown(event.srcElement.name);setTimeout(window.frames['ifreamSign'].finger,100);" class="Menu_Right" name="Menu_Right">指纹验证</button></span>
		<span class="MMENU7" id="oESign" style="top: 75%;"><button onmousedown="top.wins.doMouseDown(event.srcElement.name);setTimeout(window.frames['ifreamSign'].ESig,100);" class="Menu_RightE" name="Menu_RightE">电子签名</button></span>
		<span class="MMENUMiddle" id="oSigAgain"><button onclick="javascript:window.frames['ifreamSign'].onKey_F7()" class="Menu_Right" name="oHome" id="oSign"></button></span>
<!-- 		<span class="MENU98" ><button onclick="javascript:window.frames['ifreamSign'].onKey_F98()" class="return" name="return"></button></span> -->
		<span class="MENU99" id="oSigConfirm"><button onclick="javascript:window.frames['ifreamSign'].onKey_F99()" class="confirm" name="confirm"></button></span>
	</div>
	
	<!--增加返回主页-->
	<div id="oLGoHome" class="GoHomeTip">
		<table width="100%" align="center" height="100%" border="0" cellpadding="0" cellspacing="0">
			<tr height="100%">
				<td align="center">
					<iframe src="../Service/GoHome.html" width="100%" height="100%" frameborder="0px" marginheight="0px" marginwidth="0px" allowTransparency="true" scrolling="No"></iframe>
				</td>
			</tr>
		</table>
	</div>

	<!--增加滑动安全退出-->
	<div id="oLSafeQuit" class="SafeQuitTip">
		<table width="100%" align="center" height="100%" border="0" cellpadding="0" cellspacing="0">
			<tr height="100%">
				<td align="center">
					<iframe src="../Service/SafeQuit.html" width="100%" height="100%" frameborder="0px" marginheight="0px" marginwidth="0px" allowTransparency="true" scrolling="No"></iframe>
				</td>
			</tr>
		</table>
	</div>
</body>
</html>
