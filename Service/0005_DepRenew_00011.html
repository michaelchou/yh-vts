<html>
<head>
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=gb2312">
<title>存单续存：转账充值流程</title>
<LINK REL=stylesheet HREF="../Terminal/Style/Default/Style.css" type="text/css" />
<script type="text/javascript">
	//光标最后停留的标签id名称
	var last = "";
	var isPass = false;
	var isCard = false;
	var strInputFlag = 1;
	var isInputPin = false;
  // 禁止页面其他非输入控件的元素获得焦点
	document.attachEvent("onclick", checkEvent);
	document.attachEvent("ondblclick", checkEvent);
	document.attachEvent("onfocusin", checkEvent);
	document.attachEvent("onkeypress", checkEvent);
function checkEvent()
{
  try
  {
	//如果光标停留在输入框上,更新last
	if(document.activeElement.tagName == "INPUT"){
		last = document.activeElement.id;
	}
	//如果点击的不是输入框,光标回到最后停留的标签中.否则切换到对应的输入框标签
	if(event.srcElement.id == "" || event.srcElement.type != "text" || event.srcElement.disabled){
		top.wins.checkEvent(event.srcElement, last);
	}else{
		top.wins.checkEvent(event.srcElement, event.srcElement.id);
	}
  }catch(e){}
}
var isPassReader = false;
  // 初始化本次服务流程
  top.serviceCtrl.prepare4Entrance(document, window, function(){serverEntrance();});  
  // 服务流程处理入口
  function serverEntrance()
  {
	top.serviceCtrl.stopUserTimeout();
	isPass = false;
	isCard = false;
	top.pool.set("needSendAgent","");
	//转账充值
	TypeSelect();	
  }
  //介质选择：卡、存折、存单
  function TypeSelect()
  {
	window.operateCtrl.disableInput(true);
    top.serviceCtrl.stopUserTimeout();
	onKey_F7 = function(strType)
	{
		top.serviceCtrl.stopUserTimeout();
		if(typeof(top.YHAXPassbook) == "undefined"){
			//无存折模块
			showSvcFailedInfo(top.langcur.oCDSFailed,top.TERMRETCODE_CARD_FAILED, top.langcur.oNoPassbook);
		}else{
			if(top.YHAXPassbook.StDeviceStatus == "HEALTHY"  && top.YHAXPassbook.StMediaStatus == "NOTPRESENT"){
				isPass = true;
				//存折模块正常
				doPassTransferIn();
			}else{
				//存折模块故障
				showSvcFailedInfo(top.langcur.oCDSFailed,top.TERMRETCODE_CARD_FAILED, top.langcur.oPassbookErro);
			}
		}	
	}
	onKey_F8 = function(strType)
	{
		top.serviceCtrl.stopUserTimeout();
		if(top.YHAXCardReader.StDeviceStatus == "HEALTHY"){
			isCard = true;
			doCardTransferIn();
		}else{
			showSvcFailedInfo(top.langcur.oCDSFailed,top.TERMRETCODE_CARD_FAILED, top.langcur.oCardReaderError);
		}	
	}
	//刷折
	onKey_F9 = function() {
	    top.journalPrinter.addJournalWithTime("选择刷折");
	    top.serviceCtrl.stopUserTimeout();
	    if(typeof(top.YHAXPassbookReader) == "undefined"){
	    	showSvcFailedInfo(top.langcur.oCDSFailed,top.TERMRETCODE_CARD_FAILED, top.langcur.oNoPassbookReader);
	    }else{
			if (top.YHAXPassbookReader.StDeviceStatus != "HEALTHY") {
				//无存折模块
				showSvcFailedInfo("交易失败", "", "刷折模块故障");
			}else {
				passbookReader();
			}	
	    }
	}
	onKey_Cancel = onKey_F98 = function()
	{
		sendDepositQuery();
	}
	onTimeout = function()
	{
		//购物车中是否有钱
		if(top.pool.get("surplusAmt") > 0)
		{
			//返回购物车
			//发送大堂经理进行协助
			top.pool.set("strbusinessName","存单续存转账充值介质选择超时");
			top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
			top.trans.send910304CDSFailedAsync();			
		}else{
			top.serviceCtrl.navigate2Quit();
		}
	}
	isPass = false;
	isCard = false;
	isPassReader = false;
	try{top.soundPlayer.playback("/Sound/SelectMediaType.mp3");}catch(e){}
	window.operateCtrl.enableInput();
    top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout,oSelectTypeTick);
	top.wins.showMain("oLCashSelect");
  }
  //插存折
  function doPassTransferIn()
  {
   window.operateCtrl.disableInput(true);
    top.serviceCtrl.stopUserTimeout();
	onMediaInserted = function()
	{
		top.wins.showNewProcessingTip(top.langcur.oReadPassbookInfo);
	}
	onMediaInvalid = function(){
		top.serviceCtrl.stopUserTimeout();
		top.wins.showMain("cLInfoTip2");
		try{document.all.item("cLInfoContent2").innerHTML = top.langcur.oPassbookErro2;}catch(e){}
		top.serviceCtrl.startUserTimeout(onInvalidEject, top.iFailedTimeout, oInfoTip2Tick);
	}
	onInvalidEject = function(){
		top.serviceCtrl.stopUserTimeout();
		//退存折
		ejectPassBook("1");
	}
	onDeviceError_Pbp = function(){
		top.serviceCtrl.stopUserTimeout();
		top.wins.showMain("cLInfoTip2");
		try{document.all.item("cLInfoContent2").innerHTML = top.langcur.oPassbookErro1;}catch(e){}
		top.serviceCtrl.startUserTimeout(onFailed, top.iFailedTimeout, oInfoTip2Tick);
	}
	onFailed = function()
	{
		top.serviceCtrl.stopUserTimeout();
		ejectPassBook("2");
	}
    onMediaAccepted = function(track2Val)
	{
		top.wins.stopProcessingTimeout();
		top.serviceCtrl.stopUserTimeout();
		//二磁道
		top.pool.set("strTrack3", track2Val);
		if(track2Val.length < 104)
		{
			top.serviceCtrl.stopUserTimeout();
			ejectPassBook("1");
		}else
		{
			track2Val = track2Val.substr(0,104);
			if( track2Val != null && track2Val != "")
			{
				if(track2Val.split("=").length<3){
					ejectPassBook("1");
				}else{
					top.pool.set("strVoucherNo",track2Val.split("=")[3].substr(16,8));
					top.pool.set("strVoucherType",track2Val.split("=")[3].substr(0,4));
					track2Val = track2Val.split("=")[2].substr(0,17);
					top.pool.set("strPassBookNum", track2Val);
					top.pool.set("DestPan", track2Val);	
					top.pool.set("strPan", "");
					top.pool.set("strTrack2", "");
					//存折验密
					inputPin1();
				}
			}		
		}
    }
 	onTimeout = function()
	{
	    //超时关闭存折机
		top.passbookprinter.cancelAccept();
		//购物车有钱呼叫大堂经理
		if(top.pool.get("surplusAmt") > 0){
			top.pool.set("strbusinessName","存单续存转账充值插入存折超时(内部账有钱)");
			top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
			top.trans.send910304CDSFailedAsync();
		}else{
			ejectPassBook("3");
		}
	}
	onKey_Cancel = onKey_F98 = function(){
		top.serviceCtrl.stopUserTimeout();
		top.passbookprinter.cancelAccept();
		//判断是否插入存折
		if(top.YHAXPassbook.StMediaStatus == "PRESENT"){		    
			ejectPassBook("2");
		}else{
			sendDepositQuery(); 
		}	
	}
     top.passbookprinter.accept();
     try {top.soundPlayer.playback("/Sound/InPutbankbook.mp3");} catch (e) {}
	 top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout,oInPassTick);
	 top.wins.showMain("oLPassTip");
  }
  //存单开户-转账充值-刷折功能
	function passbookReader(){
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();
		onMediaInserted = function() {
			top.serviceCtrl.stopUserTimeout();
			top.wins.showProcessingTip(top.langcur.oReadPassbookInfo);
		}
		onMediaInvalid = function() {
			top.serviceCtrl.stopUserTimeout();
			top.wins.showMain("cLInfoTip2");
			try{document.all.item("cLInfoContent2").innerHTML = top.langcur.oPassbookErro2;}catch(e){}
			top.serviceCtrl.startUserTimeout(onFailed, top.iFailedTimeout, oInfoTip2Tick);
		}
		notSupportPassbook = function() {
			top.serviceCtrl.stopUserTimeout();
			top.wins.showMain("cLInfoTip2");
			try{document.all.item("cLInfoContent2").innerHTML = top.langcur.oReadPassbookNotSupport;}catch(e){}
			top.serviceCtrl.startUserTimeout(onFailed, top.iFailedTimeout, oInfoTip2Tick);

		}
		onDeviceError_Pbp = function() {
			top.serviceCtrl.stopUserTimeout();
			top.wins.showMain("cLInfoTip2");
			try{document.all.item("cLInfoContent2").innerHTML = top.langcur.oPassbookErro1;}catch(e){}
			top.serviceCtrl.startUserTimeout(onFailed, top.iFailedTimeout, oInfoTip2Tick);
		}
		onMediaAccepted = function(track2Val) {
			top.wins.stopProcessingTimeout();
			top.serviceCtrl.stopUserTimeout();
			top.pool.set("strTrack3", track2Val);
			if(track2Val.length < 104)
			{
				top.serviceCtrl.stopUserTimeout();
				notSupportPassbook();
			}else
			{
				track2Val = track2Val.substr(0,104);
				if( track2Val != null && track2Val != "")
				{
					if(track2Val.split("=").length<3){
						onMediaInvalid();
					}else{
						top.pool.set("strVoucherNo",track2Val.split("=")[3].substr(16,8));
						top.pool.set("strVoucherType",track2Val.split("=")[3].substr(0,4));
						track2Val = track2Val.split("=")[2].substr(0,17);
						top.pool.set("strPassBookNum", track2Val);
						top.pool.set("DestPan", track2Val);
						top.pool.set("strPan", "");
						top.pool.set("strTrack2", "");
						isPass = true;
						isPassReader = true;
						//存折验密
						inputPin1();
					}
				}		
			}
		}
		onFailed = function()
		{
			top.serviceCtrl.stopUserTimeout();
			sendDepositQuery(); 
		}
		onKey_F98 = onKey_Cancel  = function() {
			top.passbookreader.cancelAccept();
			sendDepositQuery(); 
		}
		onTimeout = function()
		{
			top.passbookreader.cancelAccept();
			//购物车有钱呼叫大堂经理
			if(top.pool.get("surplusAmt") > 0){
				top.pool.set("strbusinessName","存单续存转账充值刷存折超时");
				top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
				top.trans.send910304CDSFailedAsync();
			}else{
				top.serviceCtrl.navigate2Quit();
			}
		}
		top.passbookreader.accept();
		// 播放提示音
		try{top.soundPlayer.playback("/Sound/PlsReadPass.mp3");}catch(e){}
		top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout, oReadPassTick);
		// 在广告加载完成前显示默认空闲提示
		top.wins.showMain("oLPassReaderTip");
	}
  //转入内部账户--插卡
  function doCardTransferIn()
  {
	window.operateCtrl.disableInput(true);
	top.serviceCtrl.stopUserTimeout();
	onKey_Cancel = onKey_F98 = function()
	{
		top.serviceCtrl.stopUserTimeout();
		top.cardreader.cancelAccept();
		sendDepositQuery(); 
	}
	onCardInserted = function()
	{
		top.serviceCtrl.stopUserTimeout();
		top.wins.showNewProcessingTip(top.langcur.oReadingCard);
	}
	onCardInvalid = function()
	{
		top.serviceCtrl.stopUserTimeout();
		showSvcFailedInfo(top.langdef.oValidateCardFailed, "", top.langdef.oCardInvalid);
	}
	onICCardInitFailed = function()
	{
		top.serviceCtrl.stopUserTimeout();
		showSvcFailedInfo(top.langdef.oValidateCardFailed, "", top.langdef.oInitICCardFailed);
	}
	onDeviceError_Idc = function()
	{
		top.serviceCtrl.stopUserTimeout();
		// 记录终端流水
		var strJrn = new top.StringCtrl("读卡器故障 "+new top.DateTimeCtrl().getYYYYMMDDHHmmSSWithSep()).preandsufStr('=', top.journalPrinter.TITLEWIDTH) + top.journalPrinter.strNewLine;
		top.journalPrinter.addJournal(strJrn);
		showSvcFailedInfo(top.langdef.oValidateCardFailed, "", top.langdef.oCardReaderError);
	}
	onCardAccepted = function()
	{
		top.wins.stopProcessingTimeout();
		top.serviceCtrl.stopUserTimeout();		
		//先验卡
		top.pool.set("DestPan", "");
		validateCard();		
	}
	onTimeout = function(){
		//插卡超时
		top.cardreader.cancelAccept();
		//购物车有钱呼叫大堂经理
		if(top.pool.get("surplusAmt") > 0){
			top.pool.set("strbusinessName","存单续存转账充值插卡超时(内部账有钱)");
			top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
			top.trans.send910304CDSFailedAsync();
		}else{
			top.serviceCtrl.navigate2Quit();
		}
	}
	// 播放提示音
	try{top.soundPlayer.playback("/Sound/InsertCardTip.mp3");}catch(e){}
	top.cardreader.accept(120);
	top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout,oInpCardTick);
	top.wins.showMain("oLCardTip");
  }
  //验卡
  function validateCard()
  {
  	var strTrack2 = top.pool.get("strTrack2");
  	var strTrack3 = top.pool.get("strTrack3");
  	if (strTrack2.length < 6 && strTrack3.length < 6)
  	{
      	showSvcFailedInfo(top.langdef.oValidateCardFailed, "", top.langdef.oInvalidCard);
  	}
  	// 发出验卡异步请求后，主机返回结果的响应
  	onAsyncExchangeComplete = function()
  	{
		top.serviceCtrl.stopUserTimeout();
		var iRet = top.pool.get("CheckCardRet");  
		if (iRet == top.RESULT_SUCCESSFUL)
		{
			var strCardType = top.exchxmlasync.msgxmldomResp.getElementValue("F24"); 
			var cardStatus = top.exchxmlasync.msgxmldomResp.getElementValue("/TransMsg/dataList/F60/cardStatus");		
			if("00" == strCardType.substr(0,2)){//非本行借记卡
				if(cardStatus.length > 5 && "1" != cardStatus.substr(4,1)){
					showSvcFailedInfo("验卡失败","","卡状态异常,请联系发卡行");
				}else{
					inputPin1();
				}
			}else{
				InsertCard();
			}
		}else{
			/*  P102-冒名买卖账户  P103-6个月无交易账户  P104-反洗钱账户 
				P105-人行黑名单    P106-本行黑名单       P107-涉案相关账户
				P108-电讯诈骗灰名单
			*/
			if("P102" == top.exchxmlasync.strTermRetCode || "P103" == top.exchxmlasync.strTermRetCode 
		   		|| "P104" == top.exchxmlasync.strTermRetCode || "P105" == top.exchxmlasync.strTermRetCode
		   		|| "P106" == top.exchxmlasync.strTermRetCode || "P107" == top.exchxmlasync.strTermRetCode
				||"P108" == top.exchxmlasync.strTermRetCode ){
				//推送PAD
				top.trans.send910304BalckListAsync();
			
				top.serviceCtrl.stopUserTimeout();
				showSvcFailedInfo(top.langcur.oValidateCardFailed, top.exchxmlasync.strTermRetCode, top.langcur.oCheckCardFailedTip);
			}else {
				top.serviceCtrl.stopUserTimeout();
				showSvcFailedInfo(top.langdef.oValidateCardFailed,top.exchxmlasync.msgxmldomResp.getElementValue("TermRetCode"),top.exchxmlasync.msgxmldomResp.getElementValue("TermRetDesc"));
		}		
      }
   	}
   	//发送验卡请求
   	new top.CheckCard().sendCheckCardAsync();
  }  
  //他行卡无法转入内部账
  function InsertCard()
  {
	 top.serviceCtrl.stopUserTimeout();
	 onCardEjected = function()
	 {
		top.serviceCtrl.startTipTick(top.iUserTimeout, oTakeInvalCardTick);
       // 播放提示音
		try{top.soundPlayer.playback("/Sound/TakeCardTip.mp3");}catch(e){}
		top.wins.showMain("oLTakeInvalCardTip");
    }
	 onCardTaken = function()
    {
		top.serviceCtrl.stopUserTimeout();
       	doCardTransferIn();
    }
	onDeviceError_Idc = function()
    {
		top.serviceCtrl.stopUserTimeout();
       showSvcFailedInfo(top.langcur.oCDSFailed, top.TERMRETCODE_CARD_FAILED, top.langcur.oCardReaderError);
    }
	onCardCapturedTipEnd = function()
    {
		if(top.pool.get("surplusAmt") > 0){
			top.pool.set("strbusinessName","存单续存转账充值吞卡(内部账有钱)");
			top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
			top.trans.send910304CDSFailedAsync();
		}else{
			top.serviceCtrl.navigate2Quit();
		}		 
    }
    onCardCaptured = function()
    {
		top.pool.set("printType","3");//选择打印的凭条类型
		top.receiptprinter.printAndEject();
		top.wins.showInfoTip(top.langcur.oCardCapturedTip);
		top.serviceCtrl.startFlowCtrlTimeout(onCardCapturedTipEnd, 15 * 1000);
    }
	 top.cardreader.eject();
  }  
  //输入密码:卡
  function inputPin1()
  {
	window.operateCtrl.disableInput(true);
	top.serviceCtrl.stopUserTimeout();
	onPlainCancelled = function() {
		if(isPass){
			top.pinpad.bufferPINPassBookEx();
		}else{
			top.pinpad.bufferPIN();
		} 
		if(strInputFlag >1){
			Tip_InputCard.innerHTML = top.langcur.oPlsResInputPwd;
		}else{
			Tip_InputCard.innerHTML = top.langcur.oPlsInputPwd;
		}
		window.operateCtrl.enableInput();
		top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout,oInputPassword1Tick);
		// 播放提示音
		try {
			top.soundPlayer.playback("/Sound/InputPassword.mp3");
		} catch (e) {}
		top.wins.showMain("InputPassword1");
		input_Password1.value = "";
		input_Password1.focus();
		}
		onGetPinBlockOK = function(pinblock) {
			if (input_Password1.value.length < top.pinpad.iMinPinLen) {
				// 密码位数不足，则重新输入
				error_InputPassword1.innerHTML = top.langcur.oPlsReInputPwd;
				top.serviceCtrl.startFlowCtrlTimeout(inputPin1, 200);
				return;
			}
			isInputPin = true;
			top.serviceCtrl.stopUserTimeout();
			top.pool.set("strPinBlock", pinblock);
			top.pool.set("strPinBlockTemp",pinblock);
			top.wins.showNewProcessingTip(top.langcur.oSend901606);
			top.trans.send901606Async();
		}
		onKey_F98 = onKey_Cancel = function(){
			top.serviceCtrl.stopUserTimeout();
			top.pinpad.cancelPINEntry();
		}
		onPinCancelled = function(){
			if(isCard){
				//退卡
				ejectCard();
			}else if(isPass){
				if(isPassReader){
					sendDepositQuery();
				}else{
					//退存折
					ejectPassBook("2");
				}
			}
		}		
		onDeviceError_Pinpad = function() {
			top.serviceCtrl.stopUserTimeout();
			showSvcFailedInfo("存单续存转账充值失败", "", top.langcur.oPinPadError);
		}
		input_Password1.onkeypress = function() {
			error_InputPassword1.innerHTML = "&nbsp;";
		}
		  //超时退出
	    onPinInputTimeout = onTimeout = function()
	    {
			//购物车有钱呼叫大堂经理
			if(top.pool.get("surplusAmt") > 0){
				top.pool.set("strbusinessName","存单续存转账充值输入密码超时");
				top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
				top.trans.send910304CDSFailedAsync();
			}else{
				top.serviceCtrl.navigate2Quit();
			}
	    }
		top.pinpad.cancelUserEntry();//关闭明文输入
  }
  //卡/折验密成功
  function onVerifyServiceSuccessful()
  {
	top.serviceCtrl.stopUserTimeout();
	top.wins.stopProcessingTimeout();
	isInputPin =false;
	strInputFlag = 1;
	if(isPass){
		top.pool.set("strPinBlock","");
		//保存账号
		top.pool.set("strTransAccount",top.pool.get("strPassBookNum"));		
		top.pool.set("strTrack3Temp",top.pool.get("strTrack3"));
		top.pool.set("strTrack3", "");
	}else{
		top.pool.set("strTransAccount",top.pool.get("strPan"));
	}
	top.pool.set("strSubAcctType","CNY0");
	top.trans.send902105Async();
  }  

  //转账存单：输入转账金额
  function onService902105Successful()
  {
	top.pool.set("strPinBlock",top.pool.get("strPinBlockTemp"));
    top.pool.set("strPinBlockTemp","");
	if(isPass){
		top.pool.set("strTrack3",top.pool.get("strTrack3Temp"));
		top.pool.set("strTrack3Temp", "");
	}
	window.operateCtrl.disableInput(true);
	top.serviceCtrl.stopUserTimeout();
	var accountManey = 0.00;
	if(top.pool.get("strAccKYYE") != null && "" != top.pool.get("strAccKYYE")){
		accountManey = top.pool.get("strAccKYYE");
    }
	onKey_Enter = onKey_F99 = function()
	{
		top.inputmethod.Close();
		if (!new top.StringCtrl(input_Amount1.value).isValidAmount())
		{
			error_InputAmount.innerHTML = top.langcur.oPlsInputRightAmt;
			input_Amount1.value = "";
			input_Amount1.focus();
		}else if(input_Amount1.value < 50){
			error_InputAmount.innerHTML = top.langcur.oTransAmountMin;
			input_Amount1.value = "";
			input_Amount1.focus();
		}else if(parseFloat(input_Amount1.value) > parseFloat(accountManey)){
			error_InputAmount.innerHTML = "转账金额不能大于账户可用余额";
			input_Amount1.value = "";
			input_Amount1.focus();
		}else{
			error_InputAmount.innerHTML = "&nbsp;";			
			window.operateCtrl.disableInput(true);
			top.serviceCtrl.stopUserTimeout();
			//转账金额:分为单位
			top.pool.set("TransferAmount", new top.StringCtrl("").YuanToFen(input_Amount1.value));
			error_InputAmount.innerHTML = "&nbsp;";
			input_Amount1.value = "";
			//判断充值金额是否大于等于5万且卡折与来人身份证不一致
			if(parseInt(top.pool.get("TransferAmount"),10) >= "5000000" 
					&& top.pool.get("strIDCardNum") != top.pool.get("strRespIDNo")){
				infoComfin();
			}else{
				top.wins.showNewProcessingTip(top.langcur.oSendTransIn);
				//发起转账交易：转入内部账户
	           	top.trans.send905108Async();	
			}
		}
	}
	onKey_Cancel = onKey_F98 = function()
	{
		top.inputmethod.Close();
		top.serviceCtrl.stopUserTimeout();
		if(isCard){
			//退卡
			ejectCard();
		}else if(isPass){
			if(isPassReader){
				sendDepositQuery();
			}else{
				//退存折
				ejectPassBook("2");
			}
		}else{
			//支取方式选择
			sendDepositQuery();
		}
	}
	onTimeout = function(){
		top.inputmethod.Close();
		//购物车有钱呼叫大堂经理
		if(top.pool.get("surplusAmt") > 0){
			top.pool.set("strbusinessName","存单续存转账充值金额输入超时(内部账有钱)");
			top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
			top.trans.send910304CDSFailedAsync();
		}else{
			top.serviceCtrl.navigate2Quit();
		}
	}
	input_Amount1.onkeypress = function()
	{
		error_InputAmount.innerHTML = "&nbsp;";
	}
	document.getElementById("accountBalance").innerHTML = "可用余额:"+accountManey;
	window.operateCtrl.enableInput();
	top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout,oInputAmountTick);
	top.inputmethod.ShowDigit(490,570);

	// 播放提示音
	try{top.soundPlayer.playback("/Sound/InputTfrAmt.mp3");}catch(e){}
	top.wins.showMain("oLInputAmount");
	input_Amount1.value = "";
	input_Amount1.focus();
  }
  //大额代理人补录
  function infoComfin(){
	window.operateCtrl.disableInput(true);
	top.serviceCtrl.stopUserTimeout();
	input_tel.value = "";
	onKey_F99 = onKey_Enter = function() {
		top.inputmethod.Close();
		var phone = input_tel.value;
		if(input_tel.value.length < 5 || !new top.StringCtrl(input_tel.value).isAllDigit2()){
			error_Tel.innerHTML = top.langcur.oInputRightTel2;
			input_tel.value = "";
			input_tel.focus();
		}else{
			top.serviceCtrl.stopUserTimeout();
			error_Tel.innerHTML = "&nbsp;";
			top.pool.set("strAgentPhone", phone);
			//插入身份证进行联网核查
			acceptIDCard();	
		}	
	}
	input_tel.onkeyup = function()
	{
		error_Tel.innerHTML = "&nbsp;";
	}
	onTimeout = function()
	{
		top.inputmethod.Close();
		top.serviceCtrl.stopUserTimeout();
		if(top.pool.get("surplusAmt") > 0){
			top.pool.set("strbusinessName","存单续存转账充值代理人补录超时");
			top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
			top.trans.send910304CDSFailedAsync();
		}else{
			top.serviceCtrl.navigate2Quit();
		}
	}
	text_IDNo1.innerHTML = top.pool.get("strIDCardNum");
	text_name1.innerHTML = top.pool.get("strIDName");
	proMessage.innerHTML = "提示：持他人的卡/折办理存款、取款或转账<br>超过50000元，需留存代理人信息及联系电话。";
	top.inputmethod.ShowDigit(870,570);
	top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout, oInfoConfigTick);
	window.operateCtrl.enableInput();
	try {top.soundPlayer.playback("/Sound/InputTelPhoneNum.mp3");} catch (e) {}
	top.wins.showMain("oLInfoConfigTip");
	input_tel.focus();
  }  
  //身份证联网核查
  function acceptIDCard()
  {
	 window.operateCtrl.disableInput(true);
	top.serviceCtrl.stopUserTimeout();
	onCardInvalid_ID = function() {
		top.serviceCtrl.stopUserTimeout();
		showSvcFailedInfo(top.langcur.oCDSFailed, top.TERMRETCODE_ID_READFAILED, top.langcur.oIDReaderFailed);
	}
	onDeviceError_ID = function() {
		top.serviceCtrl.stopUserTimeout();
		showSvcFailedInfo(top.langcur.oCDSFailed, top.TERMRETCODE_ID_READFAILED, top.langcur.oIDCardError);
	}
	onCardInserted_ID = function() {
		top.wins.showNewProcessingTip(top.langcur.oReadingIDCard);
	}
	onAgentCardReaded = function() {
		top.serviceCtrl.stopUserTimeout();
		AgentidCardEject();
	}
	//退出身份证读取流程
	onKey_F98 = function() {
		top.serviceCtrl.stopUserTimeout();
		top.YHAXIDCardReader.CancelAccept();
		//判断身份证状态
		if(top.idCardReader.isCardPresent())//如果身份证存在，直接退出身份证
		{
		   top.YHAXIDCardReader.Eject(120*1000);
		}
		infoComfin();
	}
	onTimeout_ID = onTimeout = function(){
		if(top.pool.get("surplusAmt") > 0){
			top.pool.set("strbusinessName","存单续存转账充值户主身份证放入超时");
			top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
			top.trans.send910304CDSFailedAsync();
		}else{
			top.serviceCtrl.navigate2Quit();
		}
	}
			
	window.operateCtrl.enableInput();
	top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout, oAgentIdCardTick);
	top.idCardReader.acceptAgent();
	// 播放提示音
	try {
		top.soundPlayer.playback("/Sound/PlsInsertOwnID.mp3");
	} catch (e) {}
	top.wins.showMain("oLAgentIDCardTip");	  
  }  
  // 提示取走委托人二代身份证
  function AgentidCardEject() {
	top.wins.stopProcessingTimeout();  
	top.pool.set("isAgent","1"); //是否是代理人
	window.operateCtrl.disableInput(true);
	top.serviceCtrl.stopUserTimeout();
	onDeviceError_ID = onTimeout_ID = function() {
		top.serviceCtrl.stopUserTimeout();
		showSvcFailedInfo(top.langcur.oCDSFailed, top.TERMRETCODE_ID_EJECTFAILED,top.langcur.oEjectIDFailed);
	}
	onCardTaken_ID = function() {		
	}
	//超时退出
	onTimeout = function()
	{	
		top.idCardReader.IDCardEvents.clearAll();	
		//进行联网核查流程
        top.idCardReader.idCardTakenComplete();
	}

	top.serviceCtrl.startUserTimeout(onTimeout, 10, oAgentIdCardTakeTick);
	window.operateCtrl.enableInput();
	top.idCardReader.eject();
	// 播放提示音
	try {
		top.soundPlayer.playback("/Sound/TakeIDCard.mp3");
	} catch (e) {}
	top.wins.showMain("oLAgentIDCardTakeTip");
  }	  
  //联网核查成功
  function onNetworkVirificationSuccessful(){
	top.serviceCtrl.stopUserTimeout();
	//如果插入的身份证与卡/折身份证是否一致	
	if(top.pool.get("strAgentIDCardNum") != top.pool.get("strRespIDNo")){
		showSvcFailedInfo(top.langcur.oCDSFailed, top.TERMRETCODE_ID_EJECTFAILED,top.langcur.oCdsIdentDiff2);		
	}else{
		top.pool.set("needSendAgent","1");
		top.wins.showNewProcessingTip(top.langcur.oSendTransIn);
		//发起转账交易：转入内部账户
	    top.trans.send905108Async();
	
	}
  } 
  //代理人信息登记
  function onUpdateAgentSuccessful(){
	  onTransSucessful();	
  } 	
  //转入内部账成功-进行退卡、退折
  function doEjectCardOrPass(){
	window.operateCtrl.disableInput(true);
	top.serviceCtrl.stopUserTimeout();
	//清空转账金额
	top.pool.set("TransferAmount", "");	
    if(top.pool.get("needSendAgent") =="1"){
		//代理人登记
		top.pool.set("strOption","C");
		top.pool.set("needSendAgent","");
		top.pool.set("strAgentTransCode","905108");
		top.wins.showNewProcessingTip(top.langcur.send901112Add);
		top.trans.send901112Async();	
    }else{
    	onTransSucessful();
    }
  }	
  function onTransSucessful(){
	window.operateCtrl.disableInput(true);
	top.serviceCtrl.stopUserTimeout();
	//充值交易成功
	if(isCard){
		//退卡
		ejectCard();
	}else if(isPass){
		if(isPassReader){
			sendDepositQuery();
		}else{
			//退存折
			ejectPassBook("2");
		}
	}else{
		//支取方式选择
		sendDepositQuery();
	}
  }	
  //退卡
  function ejectCard(){
	 top.serviceCtrl.stopUserTimeout();
  	 onCardEjected = function()
	 {
		top.serviceCtrl.startTipTick(top.iUserTimeout, oTakeFailedTick);
        // 播放提示音
		try{top.soundPlayer.playback("/Sound/TakeCardTip.mp3");}catch(e){}
		top.wins.showMain("oLTakeFailedTip");
     }
	 onCardTaken = function()
     {
        //返回购物车
		//清空转账金额
		top.pool.set("TransferAmount", "");
		sendDepositQuery();		
     }
	 onDeviceError_Idc = function()
     {
        showSvcFailedInfo(top.langcur.oCDSFailed, top.TERMRETCODE_CARD_FAILED, top.langcur.oCardReaderError);
     }
	 onCardCapturedTipEnd = function()
     {
		top.pool.set("strbusinessName", "存单续存转账充值吞卡");
		top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
		top.trans.send910304CDSFailedAsync();
     }
     onCardCaptured = function()
     {
		top.pool.set("printType","3");//选择打印的凭条类型
		top.receiptprinter.printAndEject();
		top.wins.showInfoTip(top.langcur.oCardCapturedTip);
		top.serviceCtrl.startFlowCtrlTimeout(onCardCapturedTipEnd, 15 * 1000);
     }
	 top.cardreader.eject();
  }
  
  //退存折
  function ejectPassBook(strType){
	top.serviceCtrl.stopUserTimeout();
	onPrintTaken = function() {
		if(strType == "3"){
			top.serviceCtrl.navigate2Quit();
		}else{
			sendDepositQuery();
		}
	}
	
	onDeviceError_Pbp = function(){
		top.serviceCtrl.stopUserTimeout();
		top.wins.showMain("cLInfoTip2");
		try{document.all.item("cLInfoContent2").innerHTML = top.langcur.oPassbookErro1;}catch(e){}
		top.serviceCtrl.startUserTimeout(onTimeout, top.iFailedTimeout, oInfoTip2Tick);
		
	}
	
	onTimeout = function(){
		//购物车有钱呼叫大堂经理
		if(top.pool.get("surplusAmt") > 0){
			top.pool.set("strbusinessName","存单续存转账充值取存折超时");
			top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
			top.trans.send910304CDSFailedAsync();
		}else{
			top.serviceCtrl.navigate2Quit();
		}
	}
	onPrintEjected = function() {
		top.wins.showMain("cLInfoTip2");
		if(strType == "1"){
			try{document.all.item("cLInfoContent2").innerHTML = top.langcur.oReadPassbookNotSupport;}catch(e){}
		}else{
			try{document.all.item("cLInfoContent2").innerHTML = top.langcur.oTakePassbook;}catch(e){}
		}		
		top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout, oInfoTip2Tick);
	}
	top.passbookprinter.eject();
  } 
  //pad帮助超时回调
  function onProcessingTimeout(){
	//如果存单模块状态异常
	if(new top.CheckCard().cdStDeviceStatus() !="true"){
		//大堂经理帮助成功：设备显示设备故障
		top.serviceCtrl.navigate2("/Service/CDSFailed.html");
	}else{
		if(top.pool.get("surplusAmt") > 0){
			top.pool.set("strbusinessName","存单续存转账充值交易超时(内部账有钱)");
			top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
			top.trans.send910304CDSFailedAsync();
		}else{
			top.serviceCtrl.navigate2Quit();
		}
	}
  }
  //返回购物车
  function sendDepositQuery()
  {
	  top.serviceCtrl.stopUserTimeout();
	  top.serviceCtrl.navigate2("/Service/0005_DepRenew_00006.html");
  }
  //交易失败
  function onServiceFailed(title, retcode, retdesc){
	top.wins.stopProcessingTimeout();
	top.serviceCtrl.stopUserTimeout();
	if(isInputPin){
		//验密失败情况下的处理：可以输入3次
		isInputPin = false;
		if(retcode == "2055"){
			if(strInputFlag > 3)
			{
				//密码输入次数超限
				showSvcFailedInfo(title, retcode, "密码错误次数超多");
			}else{
				strInputFlag ++;
				inputPin1();
			}
		}else{
			showSvcFailedInfo(title, retcode, retdesc);
		}
	}else{
		//其他交易失败
		showSvcFailedInfo(title, retcode, retdesc);
	}		
  }
  function showSvcFailedInfo(title, retcode, retdesc) {
	window.operateCtrl.disableInput(true);
	top.serviceCtrl.stopUserTimeout();
	onKey_Cancel = onKey_F98 = function() 
	{
		top.serviceCtrl.stopUserTimeout();
		doNextFunction();
	}

	oTitle.innerHTML = title;
	oFailedRetDesc.innerHTML = retdesc;

	window.operateCtrl.enableInput();
	top.serviceCtrl.startUserTimeout(onKey_F98, top.iFailedTimeout, oServiceFailedTick);
	top.wins.showMain("oLServiceFailedTip");
  }
  function doNextFunction(){
	if(isCard){
		//退卡
		if(top.YHAXCardReader.StDeviceStatus == "HEALTHY"){
			ejectCard();
		}else{
			sendDepositQuery();
		}		
	}else if(isPass){
		if(isPassReader){
			sendDepositQuery();
		}else{
			if(top.YHAXPassbook.StDeviceStatus == "HEALTHY"){
				//退存折
				ejectPassBook("2");
			}else{
				sendDepositQuery();
			}
		}
	}else{
		//支取方式选择
		sendDepositQuery();
	}
  }
  //存单交易失败：呼叫大堂经理回调
  function onShowTellCDSFailed(){
	top.serviceCtrl.navigate2("/Service/CDSFailed.html"); 
  } 
  //校验转入内部账金额
  function input_checkAmount1()
  {
  	try{
  		error_InputAmount.innerHTML = "&nbsp;";
	    if((input_Amount1.value).indexOf(".") > 0){
		   var str = (input_Amount1.value).substr(find_str((input_Amount1.value),".",1)+1,(input_Amount1.value).length);
		   if (str.indexOf(".") > 0)
	       {
	          error_InputAmount.innerHTML = top.langcur.oPlsInputRightAmt;
	          input_Amount1.value = "";
	          input_Amount1.focus();
	       }else{
		      if(str.length == 0){
			  }else if (str.length >2){
				error_InputAmount.innerHTML = "金额只支持两位小数";
				input_Amount1.value =input_Amount1.value.substr(0,input_Amount1.value.length-1);;
				input_Amount1.focus();
			  }
		      else if (!new top.StringCtrl(input_Amount1.value).isValidAmount())
	          {
	             error_InputAmount.innerHTML = top.langcur.oPlsInputRightAmt;
	             input_Amount1.value = "";
	             input_Amount1.focus();
	          }
		   }
		}
		else {
		   if (!new top.StringCtrl(input_Amount1.value).isValidAmount())
	       {
	          error_InputAmount.innerHTML = top.langcur.oPlsInputRightAmt;
	          input_Amount1.value = "";
	          input_Amount1.focus();
	       }
		   if(input_Amount1.value.length > 9)
			{
				error_InputAmount.innerHTML ="金额最多支持9位整数";
				input_Amount1.value =input_Amount1.value.substr(0,9);
				input_Amount1.focus();
			}
	    }
    }catch(e){}
  } 
  function ShowKeyboard2(){
	  top.inputmethod.ShowDigit(490,570);
  }
  function ShowKeyboard() {
	  top.inputmethod.ShowDigit(870,570);
  }
  //校验电话号码
  function input_checkTel() {
    error_Tel.innerHTML = "&nbsp;";  
  	if (!new top.StringCtrl(input_tel.value).isAllDigit2())
	{
	  error_Tel.innerHTML = top.langcur.oInputRightTel2;
	  input_tel.value = "";
	  input_tel.focus();
	}
 }
    
</script>
</head>
<body background="../Terminal/Style/Default/Img/Bg_Main_Menu2.jpg" oncontextmenu="return false" ondragstart="return false" onselectstart ="return false" onselect="document.selection.empty()" oncopy="document.selection.empty()" onbeforecopy="return false" onmouseup="document.selection.empty()">
<div id="oLCashSelect" class="FULLSCR" style="visibility:hidden">
  <div class="FULLSCR">
	<span class="Tip_Tick" id="oSelectTypeTick"></span>
    <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
      <tr>
        <td align="center">
		<br/><br/><br/><br/><br/><br/><br/><br/><br/>
		  <pre class="Tip_Title" id="oSelectType"></pre>
		  <span class="MENU6_1"><button onclick="javascript:onKey_F7()" class="Menu_Passbook" name="oPassbook"></button></span>
		  <span class="MENU7_1"><button onclick="javascript:onKey_F8()" class="Menu_Card" name="oCard"></button></span>		  
	  	  <span class="MENU8_1"><button onclick="javascript:onKey_F9()" class="Menu_Passreader" name="oPassbook"></button></span>
	   </td>
      </tr>
    </table>
  </div>
  <span class="MENU98"><button onclick="javascript:onKey_F98();" class="return" name="return"></button></span>
</div>

<div id="oLPassTip" class="FULLSCR" style="visibility:hidden;">
 <div class="FULLSCR">
  <span class="Tip_Tick" id="oInPassTick"></span>
  <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
    <tr><td align="center">
      <br/><br/><pre class="Tip_Title" id="oInsertPass"></pre><br/>
      <img src="../Image/InputPassBookTip.gif" width="870px" height="520px"/>
    </td></tr>
  </table>
  </div>
  <span class="MENU98"><button onmousedown="setTimeout(onKey_F98,1000);" class="return" name="return"></button></span>
</div>

<div id="cLInfoTip2" class="FULLSCR" style="visibility:hidden;">
  <div class="FULLSCR">
	<span class="Tip_Tick" id="oInfoTip2Tick"></span>
    <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
      <tr><td align="center">
        <br/><br/>
        <span class="Tip_Title" ID="cLInfoContent2">&nbsp;<br/><br/><br/></span>
      </td></tr>
    </table>
  </div>
</div>

<div id="oLPassReaderTip" class="FULLSCR" style="visibility: hidden;">
	<div class="FULLSCR">
		<span class="Tip_Tick" id="oReadPassTick"></span>
		<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
			<tr>
				<td align="center"><br/><br/>
					<pre class="Tip_Title" id="oReaderPass"></pre><br/>
					<img src="../Image/ReadPassBookTip.gif" width="870px" height="520px" />
				</td>
			</tr>
		</table>
	</div>
	<span class="MENU98"><button onclick="javascript:onKey_F98();" class="return" name="return"></button></span>
</div>

<div id="oLCardTip" class="FULLSCR" style="visibility:hidden;">
 <div class="FULLSCR">
  <span class="Tip_Tick" id="oInpCardTick"></span>
  <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
	<br/><br/><br/>
    <tr><td align="center">
      <br/><br/><pre class="Tip_Title" id="oInsertCard"></pre><br/>
      <img src="../Image/InsertCardTip.gif" width="870px" height="520px"/>
    </td></tr>
  </table>
  </div>
	<span class="MENU98" ><button onclick="javascript:onKey_F98()" class="return" name="oReturn"></button></span>
</div>

<div id="oLTakeInvalCardTip" class="FULLSCR" style="visibility:hidden;">
	<span class="Tip_Tick" id="oTakeInvalCardTick"></span>
  <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
    <br/><br/><br/><br/><br/><br/><br/><br/>
	<tr class="FirstLine"><td align="center">
	  <span class="Tip_Title" id="oReInsertDebCard2"></span><br/><br/>
      <img src="../Image/TakeCardTip.gif" width="870" height="520" />
    </td></tr>
  </table>
</div>

<div id="InputPassword1" class="FULLSCR" style="visibility: hidden;">
	<div class="FULLSCR">
		<span class="Tip_Tick" id="oInputPassword1Tick"></span> <br />
		<br /><br /><br />
		<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
			<tr><td></td></tr>
			<tr class="FirstLine">
				<td align="center"><pre class="Tip_Title"><span id="Tip_InputCard"></span></pre> <input
					type="password" id="input_Password1" name="input_Password1"
						size="10" maxlength=6 class="input_short" /> <br />
					<br /> <img width="600px" height="430px" src="../Image/InputPin.gif" />
					<table>
						<tr>
							<td class="Error_Title" id="error_InputPassword1"></td>
						</tr>
					</table></td>
			</tr>
		</table>
	</div>
	<span class="MENU98" ><button onclick="javascript:onKey_F98()" class="return" name="oReturn"></button></span>
</div>

<div id="oLTakeFailedTip" class="FULLSCR" style="visibility:hidden;">
	<span class="Tip_Tick" id="oTakeFailedTick"></span>
  <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
    <br/><br/><br/><br/><br/><br/><br/><br/>
	<tr class="FirstLine"><td align="center">
	  <span class="Tip_Title" id="oTakeCard2"></span><br/><br/>
      <img src="../Image/TakeCardTip.gif" width="870" height="520" />
    </td></tr>
  </table>
</div>

<div id="oLInputAmount" class="FULLSCR">
  <div class="FULLSCR">
	<span class="Tip_Tick" id="oInputAmountTick"></span>
    <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
      <tr>
        <td align="center">
          <pre class="Tip_Title" id="oPlsInputTfrAmt"></pre>
          <br/>
          <input name="input_Amount1" id="input_Amount1" class="input_shortCds" size="15" maxlength="12"  onclick="javascript:ShowKeyboard2();" onkeyup="return input_checkAmount1()"/>
          <br/>
          <span style="font-size:30px;font-family:Arial;font-weight:blod;letter-spacing:2px;" id="accountBalance"></span>
          <br/>
          <pre class="Error_Title" id="error_InputAmount">&nbsp;</pre>
        </td>
      </tr>
    </table>
  </div>
  <span class="MENU98" ><button onclick="javascript:onKey_F98()" class="return" name="oReturn"></button></span>
  <span class="MENU99" ><button onclick="javascript:onKey_F99()" class="confirm" name="oConfirm"></button></span>
</div>

<div id="oLInfoConfigTip" class="FULLSCR" style="visibility: hidden;">
	<div class="FULLSCR">
		<br><br><br><br><br><br><br><br>
		<span class="Tip_Tick" id="oInfoConfigTick"></span>
		<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="10" align="center">
			<tr>
				<td align="center">
					<span class="Tip_Title" id="oAgentInfoCof"></span><br><br>
					<table width="70%" height="30%" border="0" cellpadding="0" cellspacing="0">
						<tr>
							<td height="20px" width="37%" align="right" class="Tip_Content">代理人姓名:&nbsp;&nbsp;</td>
							<td align="left" class="Tip_Alarm"><span id="text_name1"></span></td>
						</tr>
						<tr>
							<td height="20px" align="right" class="Tip_Content">代理人身份证:&nbsp;&nbsp;</td>
							<td align="left" class="Tip_Alarm"><span id="text_IDNo1"></span></td>
						</tr>
						<tr>
							<td height="20px" align="right" class="Tip_Content">代理人电话:&nbsp;&nbsp;</td>
							<td align="left" class="Tip_Title">
								<input class="input_long" type="text" name="input_tel" id="input_tel" maxlength="12" onclick="javascript:ShowKeyboard();" onkeyup="return input_checkTel()" />
							</td>
						</tr>
					</table><br><br>
					<span class="Tip_Title" id="proMessage"></span><br><br>
					<span class="Error_Title" id="error_Tel"></span>
				</td>
			</tr>
		</table>
	</div>
	<span class="MENU99" ><button onclick="javascript:onKey_F99()" class="confirm" name="oConfirm"></button></span>
</div>
	
<div id="oLAgentIDCardTip" class="FULLSCR" style="visibility: hidden;">
	<div class="FULLSCR">
		<br><br><br><br><br><br> 
		<span class="Tip_Tick" id="oAgentIdCardTick"></span>
		<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
			<tr class="FirstLine" height="100">
				<td align="center"><br /> <br /> <span class="Tip_Title" id="oInsertOwnID"></span>
					<br /> <img src="../Image/ID_in.gif" width="870px" height="520px" />
				</td>
			</tr>
			<tr>
				<td>&nbsp;</td>
			</tr>
		</table>
	</div>
	<span class="MENU98" ><button onclick="javascript:onKey_F98()" class="return" name="oReturn"></button></span>			
</div>	
	
<div id="oLAgentIDCardTakeTip" class="FULLSCR" style="visibility: hidden;">
	<div class="FULLSCR">
		<br><br><br><br><br><br> 
		<span class="Tip_Tick" id="oAgentIdCardTakeTick"></span>
		<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
			<tr class="FirstLine" height="100">
				<td align="center"><br /> <br /> <span class="Tip_Title" id="oIDCardTake"></span>
						<br /> <img src="../Image/id_out.gif" width="870px" height="520px" />
				</td>
			</tr>
			<tr>
				<td>&nbsp;</td>
			</tr>
		</table>
	</div>
</div>	
<div id="oLTakeCardTip" class="FULLSCR" style="visibility:hidden;">
	<span class="Tip_Tick" id="oTakeCardTick"></span>
  <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
    <br/><br/><br/><br/><br/><br/><br/><br/>
	<tr class="FirstLine"><td align="center">
	  <span class="Tip_Title" id="oTakeCard2"></span><br/><br/>
      <img src="../Image/TakeCardTip.gif" width="870" height="520" />
    </td></tr>
  </table>
</div>

<div id="oLServiceFailedTip" class="FULLSCR" style="visibility: hidden;">
	<div class="FULLSCR">
		<span class="Tip_Tick" id="oServiceFailedTick"></span> <br />
		<table width="100%" height="100%" border="0" cellpadding="0"
			cellspacing="0">
			<tr>
				<td align="center">
					<table cellpadding="10" cellspacing="1" class="Table_Ob" width="55%">
						<tr class="Table_Head">
							<td colspan="2" class="Error_Title" align="center" id="oTitle"></td>
						</tr>
						<tr class="Table_Record">
							<td id="oDescription"></td>
							<td><span id="oFailedRetDesc"></span></td>
						</tr>
					</table>
				</td>
			</tr>
		</table>
	</div>
	<span class="MENU98" ><button onclick="javascript:onKey_F98()" class="return" name="oReturn"></button></span>
</div>
</body>
</html>
