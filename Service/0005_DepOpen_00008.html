<html>
<head>
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=gb2312">
<title>存单开户:余额取回流程(转账支取)</title>
<LINK REL=stylesheet HREF="../Terminal/Style/Default/Style.css" type="text/css" />
<script type="text/javascript">
//禁止页面其他非输入控件的元素获得焦点
document.attachEvent("onclick", checkEvent);
document.attachEvent("ondblclick", checkEvent);
document.attachEvent("onfocusin", checkEvent);
document.attachEvent("onkeypress", checkEvent);
function checkEvent()
{
	try
	{
	//如果光标停留在输入框上,更新last
	if(document.activeElement.tagName == "INPUT"){
		last = document.activeElement.id;
	}
	//如果点击的不是输入框,光标回到最后停留的标签中.否则切换到对应的输入框标签
	if(event.srcElement.id == "" || event.srcElement.type != "text" || event.srcElement.disabled){
		top.wins.checkEvent(event.srcElement, last);
	}else{
		top.wins.checkEvent(event.srcElement, event.srcElement.id);
	}
	}catch(e){}
}
var last ="";
var strInputFlag = 1;
var isInputPin = false;
var isPass = false;
var isCard = false;
var isPassReader =false;
var transAccountArr = new Array(); //转入内部账的交易账号
  // 初始化本次服务流程
  top.serviceCtrl.prepare4Entrance(document, window, function(){serverEntrance();});
  
  // 服务流程处理入口
  function serverEntrance()
  {
	//选择余额取回方式
	top.wins.stopProcessingTimeout();
	top.serviceCtrl.stopUserTimeout();
	strInputFlag = 1;
	isInputPin = false;
	//卡、存折
	isPass = false;
	isCard = false;
	top.pool.set("isAgent","");
	var strDetail = top.pool.get("cdsTransQueryStr");
	top.pool.set("isReturnPay","0");
	top.pool.set("needSendAgent","");
	//判断是否进行过转账支取
	if(strDetail !=null && strDetail !=""){
		showTransferOutList();
	}else{
		//转账介质选择
		TypeSelect();	
	}
  }
  //客户选择转入的卡或存折
  function showTransferOutList()
  {
	window.operateCtrl.disableInput(true);
	top.serviceCtrl.stopUserTimeout();
	onKey_Enter = onKey_F99 = function()
	{
		//转入账号
		top.serviceCtrl.stopUserTimeout();
		var inputValue = document.getElementById("AccountSelect").value;
		top.pool.set("strInAcctNo",inputValue);
		top.pool.set("strDepAccount",inputValue);
		top.wins.showNewProcessingTip("正在进行账户信息查询，请稍候...");
		//发起查询账户类型（一类户还是二类户）
		top.trans.send909004Async();		
	}
	onKey_F98 = function()
	{
		top.serviceCtrl.stopUserTimeout();
		top.pool.set("Amount","");
		sendDepositQuery();
	}
	onTimeout = function(){
		top.pool.set("strbusinessName","存单开户转账支取选择账号超时");
		top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
		top.trans.send910304CDSFailedAsync();
	}
	//请核对屏幕显示帐号及金额提示音
	try{top.soundPlayer.playback("/Sound/PleaseChooseAccount.wav");}catch(e){}

	var strDetail = top.pool.get("cdsTransQueryStr");
	if(strDetail !=null && strDetail !=""){
		var array = strDetail.split("|");
		var num = array.length-1; //记录条数
		for(var i = 0; i < num; i++) {
			var strUserDetailData = array[i];
			var arrayDetail = strUserDetailData.split(",");
			transAccountArr.push(arrayDetail[0]);
	   }
	}
	//选择转入账号
	var AccountSelect = new top.StringCtrl("").unique(transAccountArr);
	document.getElementById("AccountSelect").options.length = 0;
	var oSelect = document.getElementById("AccountSelect");
	var len = AccountSelect.length;
	for(var i = 0; i < len; i++){
		var op = document.createElement("option");
		op.setAttribute("value",AccountSelect[i]);
		op.innerHTML = AccountSelect[i];
		oSelect.appendChild(op);
	}

	//可开户金额
	text_TransListAmount.innerHTML = new top.StringCtrl("").formatStrAmount(top.pool.get("surplusAmt"));
	window.operateCtrl.enableInput();
	top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout,oFeeListTick);
	top.wins.showMain("oLFeeList");
  }
  //介质选择：卡、存折
  function TypeSelect()
  {
	window.operateCtrl.disableInput(true);
    top.serviceCtrl.stopUserTimeout();
	onKey_F7 = function(strType)
	{	
		top.serviceCtrl.stopUserTimeout();
		if(typeof(top.YHAXPassbook) == "undefined"){
			//无存折模块
			showSvcFailedInfo(top.langcur.oCDSFailed,top.TERMRETCODE_CARD_FAILED, top.langcur.oNoPassbook);
		}else{
			if(top.YHAXPassbook.StDeviceStatus == "HEALTHY"  && top.YHAXPassbook.StMediaStatus == "NOTPRESENT"){
				isPass = true;
				//存折模块正常
				doPassTransferIn();
			}else{
				//存折模块故障
				showSvcFailedInfo(top.langcur.oCDSFailed,top.TERMRETCODE_CARD_FAILED, top.langcur.oPassbookErro);
			}
		}		
	}
	onKey_F8 = function(strType)
	{
		top.serviceCtrl.stopUserTimeout();
		if(top.YHAXCardReader.StDeviceStatus == "HEALTHY"){
			isCard = true;
			doCardTransferIn();
		}else{
			showSvcFailedInfo(top.langcur.oCDSFailed,top.TERMRETCODE_CARD_FAILED, top.langcur.oCardReaderError);
		}
	}
	
	//刷折
	onKey_F9 = function() {
	    top.journalPrinter.addJournalWithTime("选择刷折");
	    top.serviceCtrl.stopUserTimeout();
	    if(typeof(top.YHAXPassbookReader) == "undefined"){
	    	showSvcFailedInfo(top.langcur.oCDSFailed,top.TERMRETCODE_CARD_FAILED, top.langcur.oNoPassbookReader);
	    }else{
			if (top.YHAXPassbookReader.StDeviceStatus != "HEALTHY") {
				//无存折模块
				showSvcFailedInfo("交易失败", "", "刷折模块故障");
			}else {
				passbookReader();
			}	
	    }
	}
	onKey_Cancel = onKey_F98 = function()
	{
		//返回购物车
		sendDepositQuery();
	}
	onTimeout = function()
	{
		top.serviceCtrl.stopUserTimeout();
		top.pool.set("strbusinessName", "存单开户转账支取方式选择超时");
		top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
		top.trans.send910304CDSFailedAsync();
	}
	isPass = false;
	isCard = false;
	isPassReader = false;
	try{top.soundPlayer.playback("/Sound/SelectMediaType.mp3");}catch(e){}
	window.operateCtrl.enableInput();
    top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout,oSelectTypeTick);
	top.wins.showMain("oLTransferSelect");
  }
  //转账支取-插存折
  function doPassTransferIn()
  {
    window.operateCtrl.disableInput(true);
    top.serviceCtrl.stopUserTimeout();
	onMediaInserted = function()
	{
		top.wins.showNewProcessingTip(top.langcur.oReadPassbookInfo);
	}
	onMediaInvalid = function(){
		top.serviceCtrl.stopUserTimeout();
		top.wins.showMain("cLInfoTip2");
		try{document.all.item("cLInfoContent2").innerHTML = top.langcur.oPassbookErro2;}catch(e){}
		top.serviceCtrl.startUserTimeout(onInvalidEject, top.iFailedTimeout, oInfoTip2Tick);
	}
	onInvalidEject = function(){
		//退存折
		ejectPassBook("1");
	}
	onDeviceError_Pbp = function(){
		top.serviceCtrl.stopUserTimeout();
		top.wins.showMain("cLInfoTip2");
		try{document.all.item("cLInfoContent2").innerHTML = top.langcur.oPassbookErro1;}catch(e){}
		top.serviceCtrl.startUserTimeout(onFailed, top.iFailedTimeout, oInfoTip2Tick);
	}
	onFailed = function()
	{
		top.serviceCtrl.stopUserTimeout();
		ejectPassBook("2");
	}
	//取消，退折，返回购物车
	onKey_Cancel = onKey_F98 = function()
	{
		top.serviceCtrl.stopUserTimeout();
		top.passbookprinter.cancelAccept();
		//判断是否插入存折
		if(top.YHAXPassbook.StMediaStatus == "PRESENT"){		    
			ejectPassBook("2");
		}else{
			TypeSelect();
		}		
	}
    onMediaAccepted = function(track2Val)
	{
    	top.serviceCtrl.stopUserTimeout();
		top.pool.set("strTrack3", track2Val);
		if(track2Val.length < 104)
		{
			top.serviceCtrl.stopUserTimeout();
			ejectPassBook("1");
		}else
		{
			track2Val = track2Val.substr(0,104);
			if( track2Val != null && track2Val != "")
			{
				if(track2Val.split("=").length<3){
					ejectPassBook("1");
				}else{
					top.pool.set("strVoucherNo",track2Val.split("=")[3].substr(16,8));
					top.pool.set("strVoucherType",track2Val.split("=")[3].substr(0,4));
					track2Val = track2Val.split("=")[2].substr(0,17);
					top.pool.set("strPassBookNum", track2Val);
					top.pool.set("DestPan", track2Val);
					top.pool.set("strPan", "");
					top.pool.set("strTrack2", "");
					isPass = true;
					//存折验密
					inputPin();
				}
			}		
		}
    }
 	onTimeout = function()
	{
		top.pool.set("strbusinessName", "存单开户转账支取插折超时");
		top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
		top.trans.send910304CDSFailedAsync();
	}
     top.passbookprinter.accept();
	 try {top.soundPlayer.playback("/Sound/InPutbankbook.mp3");} catch (e) {}
	 top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout,oInPassTick);
	 // 在广告加载完成前显示默认空闲提示
	 top.wins.showMain("oLPassTip");
  } 
  //存单开户-转账充值-刷折功能
	function passbookReader(){
		window.operateCtrl.disableInput(true);
		top.serviceCtrl.stopUserTimeout();
		onMediaInserted = function() {
			top.serviceCtrl.stopUserTimeout();
			top.wins.showProcessingTip(top.langcur.oReadPassbookInfo);
		}
		onMediaInvalid = function() {
			top.serviceCtrl.stopUserTimeout();
			top.wins.showMain("cLInfoTip2");
			try{document.all.item("cLInfoContent2").innerHTML = top.langcur.oPassbookErro2;}catch(e){}
			top.serviceCtrl.startUserTimeout(onFailed, top.iFailedTimeout, oInfoTip2Tick);
		}
		notSupportPassbook = function() {
			top.serviceCtrl.stopUserTimeout();
			top.wins.showMain("cLInfoTip2");
			try{document.all.item("cLInfoContent2").innerHTML = top.langcur.oReadPassbookNotSupport;}catch(e){}
			top.serviceCtrl.startUserTimeout(onFailed, top.iFailedTimeout, oInfoTip2Tick);

		}
		onDeviceError_Pbp = function() {
			top.serviceCtrl.stopUserTimeout();
			top.wins.showMain("cLInfoTip2");
			try{document.all.item("cLInfoContent2").innerHTML = top.langcur.oPassbookErro1;}catch(e){}
			top.serviceCtrl.startUserTimeout(onFailed, top.iFailedTimeout, oInfoTip2Tick);
		}
		onMediaAccepted = function(track2Val) {
			top.wins.stopProcessingTimeout();
			top.serviceCtrl.stopUserTimeout();
			top.pool.set("strTrack3", track2Val);
			if(track2Val.length < 104)
			{
				top.serviceCtrl.stopUserTimeout();
				notSupportPassbook();
			}else
			{
				track2Val = track2Val.substr(0,104);
				if( track2Val != null && track2Val != "")
				{
					if(track2Val.split("=").length<3){
						onMediaInvalid();
					}else{
						top.pool.set("strVoucherNo",track2Val.split("=")[3].substr(16,8));
						top.pool.set("strVoucherType",track2Val.split("=")[3].substr(0,4));
						track2Val = track2Val.split("=")[2].substr(0,17);
						top.pool.set("strPassBookNum", track2Val);
						top.pool.set("DestPan", track2Val);
						top.pool.set("strPan", "");
						top.pool.set("strTrack2", "");
						isPass = true;
						isPassReader = true;
						//存折验密
						inputPin();
					}
				}		
			}
		}
		onFailed = function()
		{
			top.serviceCtrl.stopUserTimeout();
			TypeSelect();
		}
		onKey_F98 = onKey_Cancel  = function() {
			top.passbookreader.cancelAccept();
			TypeSelect();
		}
		onTimeout = function()
		{
			top.passbookreader.cancelAccept();
			top.pool.set("strbusinessName", "存单开户转账支取刷折超时");
			top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
			top.trans.send910304CDSFailedAsync();
		}
		top.passbookreader.accept();
		// 播放提示音
		try{top.soundPlayer.playback("/Sound/PlsReadPass.mp3");}catch(e){}
		top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout, oReadPassTick);
		// 在广告加载完成前显示默认空闲提示
		top.wins.showMain("oLPassReaderTip");
	}
  //存单开户-转账支取(插卡)
  function doCardTransferIn(){
	  window.operateCtrl.disableInput(true);
     top.serviceCtrl.stopUserTimeout();
	  //返回
	  onKey_Cancel = onKey_F98 = function()
	  {
		top.serviceCtrl.stopUserTimeout();
		top.cardreader.cancelAccept();
		TypeSelect();
	  }
	  onCardInserted = function()
	  {
		top.serviceCtrl.stopUserTimeout();
		top.wins.showNewProcessingTip(top.langcur.oReadingCard);
	  }
	  onCardInvalid = function()
	  {
		  showSvcFailedInfo(top.langdef.oValidateCardFailed, "", top.langdef.oCardInvalid);
	  }

	  onICCardInitFailed = function(){
		  showSvcFailedInfo(top.langdef.oValidateCardFailed, "", top.langdef.oInitICCardFailed);
	  }
	  onDeviceError_Idc = function()
      {
        // 记录终端流水
        var strJrn = new top.StringCtrl("读卡器故障复位 "+new top.DateTimeCtrl().getYYYYMMDDHHmmSSWithSep()).preandsufStr('=', top.journalPrinter.TITLEWIDTH) + top.journalPrinter.strNewLine;
        top.journalPrinter.addJournal(strJrn);
        showSvcFailedInfo(top.langdef.oValidateCardFailed, "", top.langdef.oCardReaderError);
      }
	  onCardAccepted = function()
	  {
		 //验卡
		 top.serviceCtrl.stopUserTimeout();
		 top.pool.set("DestPan", "");
		 isCard = true;
		 validateCard();
	  }
	  onTimeout = function(){
		top.pool.set("strbusinessName", "存单开户转账支取插卡超时");
		//开户交易，插卡超时
		top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
		top.trans.send910304CDSFailedAsync();
	  }

	  // 播放提示音
	  try{top.soundPlayer.playback("/Sound/InsertCardTip.mp3");}catch(e){}
	  top.cardreader.accept(120);
	  top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout,oInpCardTick);
	  top.wins.showMain("oLIdleTip");		
  }   
  
	//验卡
  function validateCard()
  {
  	var strTrack2 = top.pool.get("strTrack2");
  	var strTrack3 = top.pool.get("strTrack3");
  	if (strTrack2.length < 6 && strTrack3.length < 6)
  	{
      	showSvcFailedInfo(top.langdef.oValidateCardFailed, "", top.langdef.oInvalidCard);
  	}
  	// 发出验卡异步请求后，主机返回结果的响应
  	onAsyncExchangeComplete = function()
  	{
		top.serviceCtrl.stopUserTimeout();
		var iRet = top.pool.get("CheckCardRet");  
		if (iRet == top.RESULT_SUCCESSFUL)
		{
			var strCardType = top.exchxmlasync.msgxmldomResp.getElementValue("F24"); 
			var cardStatus = top.exchxmlasync.msgxmldomResp.getElementValue("/TransMsg/dataList/F60/cardStatus");		
			if("00" == strCardType.substr(0,2)){//非本行借记卡
				if(cardStatus.length > 5 && "1" != cardStatus.substr(4,1)){
					showSvcFailedInfo("验卡失败","","卡状态异常,请联系发卡行");
				}else{
					inputPin();
				}
			}else{
				InsertCard();
			}
		}else{
			top.serviceCtrl.stopUserTimeout();
			if("P102" == top.exchxmlasync.strTermRetCode || "P103" == top.exchxmlasync.strTermRetCode 
				|| "P104" == top.exchxmlasync.strTermRetCode || "P105" == top.exchxmlasync.strTermRetCode
				|| "P106" == top.exchxmlasync.strTermRetCode || "P107" == top.exchxmlasync.strTermRetCode
				||"P108" == top.exchxmlasync.strTermRetCode ){
				//推送PAD
				top.trans.send910304BalckListAsync();
						
				showSvcFailedInfo(top.langcur.oValidateCardFailed, top.exchxmlasync.strTermRetCode, top.langcur.oCheckCardFailedTip);
			}else {
				showSvcFailedInfo(top.langdef.oValidateCardFailed,
			    top.exchxmlasync.msgxmldomResp.getElementValue("TermRetCode"),
			    top.exchxmlasync.msgxmldomResp.getElementValue("TermRetDesc"));
			}
      	}
   	}
   	//发送验卡请求
   	new top.CheckCard().sendCheckCardAsync();
  }
  //他行卡无法内部账转出
  function InsertCard()
  {
	top.serviceCtrl.stopUserTimeout();
	onCardEjected = function()
	{
		top.serviceCtrl.startTipTick(top.iUserTimeout, oTakeInvalCardTick);
        // 播放提示音
		try{top.soundPlayer.playback("/Sound/TakeCardTip.mp3");}catch(e){}
		top.wins.showMain("oLTakeInvalCardTip");
     }
	 onCardTaken = function()
     {
		top.serviceCtrl.stopUserTimeout();
        doCardTransferIn();
     }
	 onDeviceError_Idc = function()
     {
	    showSvcFailedInfo(top.langcur.oCDSFailed, top.TERMRETCODE_CARD_FAILED, top.langcur.oCardReaderError);
     }
	 onCardCapturedTipEnd = function()
     {
		top.pool.set("strbusinessName", "存单开户转账支取吞卡(购物车有钱)");
		//开户交易，插卡超时
		top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
		top.trans.send910304CDSFailedAsync(); 
     }
     onCardCaptured = function()
     {
		top.pool.set("printType","3");//选择打印的凭条类型
		top.receiptprinter.printAndEject();
		top.wins.showInfoTip(top.langcur.oCardCapturedTip);
		top.serviceCtrl.startFlowCtrlTimeout(onCardCapturedTipEnd, 15 * 1000);
     }
	 top.cardreader.eject();
   }	
  //输入密码界面
  function inputPin()
  {
    window.operateCtrl.disableInput(true);
    top.serviceCtrl.stopUserTimeout();
    onPlainCancelled = function()
    {
	  	if(isPass){
	  		top.pinpad.bufferPINPassBookEx();
	  	}else{
	  		top.pinpad.bufferPIN();
	  	}      	
     	window.operateCtrl.enableInput();
	  	if(strInputFlag >1){
	  		Tip_TitleInput.innerHTML = top.langcur.oPlsResInputPwd;
	  	}else{
	  		Tip_TitleInput.innerHTML = top.langcur.oPlsInputPwd;
	  	}	
  		// 播放提示音
  		top.soundPlayer.playback("/Sound/InputPassword.mp3");
      	top.wins.showMain("oLInputPassword");
     	 top.serviceCtrl.startUserTimeout(onTimeOut, top.iUserTimeout,oInpPwdTick);
      	input_Password.value = "";
      	input_Password.focus();
    }
    onKey_F98 =onKey_Cancel= function()
    {
    	top.serviceCtrl.stopUserTimeout();
  		top.pinpad.cancelPINEntry(); 
    }
    onGetPinBlockOK = function (pinblock)
    {
      	if (input_Password.value.length < top.pinpad.iMinPinLen)
      	{
        	// 密码位数不足，则重新输入
        	error_InputPassword.innerHTML = top.langcur.oPlsReInputPwd;
        	top.serviceCtrl.startFlowCtrlTimeout(inputPin, 200);
        	return;
      	}
      	isInputPin = true;
      	top.serviceCtrl.stopUserTimeout();
      	top.pool.set("strPinBlock", pinblock);
      	//插卡验卡验密
  		top.wins.showNewProcessingTip(top.langcur.oSend901606);
  		top.trans.send901606Async();
    }
    onTimeOut = onPinInputTimeout = function(){
  		//发送大堂经理进行协助
  		top.pool.set("strbusinessName","存单开户转账支取输入密码超时");
  		top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
  		top.trans.send910304CDSFailedAsync();	
    }
    onDeviceError_Pinpad = function()
    {
    	showSvcFailedInfo("存单转账支取失败", "", top.langcur.oPinPadError);
    }
    onPinCancelled = function()
    {	
		if(isCard){
			//退卡
			ejectCard();
		}else if(isPass){
			if(isPassReader){
				sendDepositQuery(); 
			}else{
				//退存折
				ejectPassBook("2");
			}
		}else{
			sendDepositQuery(); 
		}
    }
    input_Password.onkeypress = function()
    {
      error_InputPassword.innerHTML = "&nbsp;";
    }
    top.pinpad.cancelUserEntry();//关闭明文输入
  }   
  //退存折
  function ejectPassBook(strType){
	top.serviceCtrl.stopUserTimeout();
	onPrintTaken = function() {
		//判断是返回支取方式选择页面还是购物车页面
		if(top.pool.get("isReturnPay")=="0"){
			//返回支取方式选择页面
			onReturnPay();			
		}else{
			sendDepositQuery();	
		}		
	}
	onTimeout = function(){
		top.serviceCtrl.stopUserTimeout();
		top.pool.set("strbusinessName", "存单开户转账支取取存折超时");
		top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
		top.trans.send910304CDSFailedAsync();
	}
	onDeviceError_Pbp = function(){
		top.serviceCtrl.stopUserTimeout();
		top.wins.showMain("cLInfoTip2");
		try{document.all.item("cLInfoContent2").innerHTML = top.langcur.oPassbookErro1;}catch(e){}
		top.serviceCtrl.startUserTimeout(onFailed, top.iFailedTimeout, oInfoTip2Tick);
	}
	onFailed = function()
	{
		top.serviceCtrl.stopUserTimeout();
		top.pool.set("strbusinessName","存单开户转账支取退存折硬件故障");
		top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
		top.trans.send910304CDSFailedAsync();
	}
	onPrintEjected = function() 
	{
		top.wins.showMain("cLInfoTip2");
		if(strType == "1"){
			try{document.all.item("cLInfoContent2").innerHTML = top.langcur.oReadPassbookNotSupport;}catch(e){}
		}else{
			try{document.all.item("cLInfoContent2").innerHTML = top.langcur.oTakePassbook;}catch(e){}
		}		
		top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout, oInfoTip2Tick);
	}
	top.passbookprinter.eject();
  }
  //退卡
  function ejectCard(){
	 top.serviceCtrl.stopUserTimeout();
  	 onCardEjected = function()
	 {
		top.serviceCtrl.startTipTick(top.iUserTimeout, oTakeFailedTick);
        // 播放提示音
		try{top.soundPlayer.playback("/Sound/TakeCardTip.mp3");}catch(e){}
		top.wins.showMain("oLTakeFailedTip");
     }
	 onCardTaken = function()
     {
		//判断是返回支取方式选择页面还是购物车页面
		if(top.pool.get("isReturnPay")=="0"){
			//返回支取方式选择页面
			onReturnPay();			
		}else{
			sendDepositQuery();	
		}
     }
	 onDeviceError_Idc = function()
     {
		top.serviceCtrl.stopUserTimeout(); 
	    if (top.cardreader.isCardPresent()){
	       top.YHAXCardReader.Capture();
	    }
	    showSvcFailedInfo(top.langcur.oCDSFailed, top.TERMRETCODE_CARD_FAILED, top.langcur.oCardReaderError);
     }
	 onCardCapturedTipEnd = function()
     {
		top.pool.set("strbusinessName", "存单开户转账支取转账支取吞卡");
		//开户交易，插卡超时
		top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
		top.trans.send910304CDSFailedAsync();
     }
     onCardCaptured = function()
     {
		top.pool.set("printType","3");//选择打印的凭条类型
		top.receiptprinter.printAndEject();
		top.wins.showInfoTip(top.langcur.oCardCapturedTip);
		top.serviceCtrl.startFlowCtrlTimeout(onCardCapturedTipEnd, 15 * 1000);
     }
	 top.cardreader.eject();
  }  
  //验密成功
  function onVerifyServiceSuccessful(){
	window.operateCtrl.disableInput(true);
	top.serviceCtrl.stopUserTimeout();
	top.wins.stopProcessingTimeout();
	strInputFlag = 1;
	isInputPin =false;
	//卡/折所属身份证号	
	if(isPass){
		top.pool.set("strInAcctNo",top.pool.get("strPassBookNum"));	
		top.pool.set("strDepAccount",top.pool.get("strPassBookNum"));
	}else if(isCard){
		top.pool.set("strInAcctNo",top.pool.get("strPan"));
		top.pool.set("strDepAccount",top.pool.get("strPan"));
	}
	top.wins.showNewProcessingTip("正在进行账户信息查询，请稍候...");
	//发起查询账户类型（一类户还是二类户）
	top.trans.send909004Async();
  } 
  //账户类型查询成功
  function onInqSecDepAmountSuccess() {
	top.wins.stopProcessingTimeout();	
    var acctKind = top.pool.get("bindAcctType");
	//判断账户类型	
	if(acctKind == "2") {
		//II类户日累计限额
		var creditDailyUsedLimit = top.pool.get("creditDailyUsedLimit");
		//II类户年累计限额
		var creditYearUsedLimit = top.pool.get("creditYearUsedLimit");
		//限额不能为空
		if(creditDailyUsedLimit != "" && creditDailyUsedLimit != null && creditYearUsedLimit != "" && creditYearUsedLimit != null
				&& creditDailyUsedLimit >0 && creditYearUsedLimit >0){
			var strAmount = top.pool.get("surplusAmt");
			if(parseInt(strAmount,10) > parseInt(new top.StringCtrl("").YuanToFen(creditDailyUsedLimit),10)
				|| parseInt(strAmount,10) > parseInt(new top.StringCtrl("").YuanToFen(creditYearUsedLimit),10)){
				//II类户超限
				showSvcFailedInfo("存单开户转账支取失败","","II类账户存款金额超限");
			}else{
				doCheckTransferOut();
			}
		}else{
			showSvcFailedInfo("存单开户转账支取失败","","II类账户存款金额限额不足");
		}
	}else {
		//一类户
		doCheckTransferOut();
	}
  } 
  //判断是否是大额转账
  function doCheckTransferOut()
  {
	  top.pool.set("isReturnPay","");
	  //转账金额以分为单位
	  var  strAmount = top.pool.get("surplusAmt");
	  //金额大于5万且卡/折身份证与来人不一致
	  if(parseInt(strAmount,10) >= "5000000" && top.pool.get("strIDCardNum") != top.pool.get("creditF60_1")){
		  //大额流程
		  infoComfin();
	  }else{
		//小额转账
		  showTransferConfrim();
	  }	  
  }
  //大额代理人补录
  function infoComfin(){
	window.operateCtrl.disableInput(true);
	top.serviceCtrl.stopUserTimeout();
	input_tel.value = "";
	onKey_F99 = onKey_Enter = function() {
		top.inputmethod.Close();
		var phone = input_tel.value;
		if (phone.length <5 || !new top.StringCtrl(input_tel.value).isAllDigit2()) {			
			input_tel.value = "";
			error_Tel.innerHTML = top.langcur.oInputRightTel2;
			input_tel.focus();
		}else{
			top.serviceCtrl.stopUserTimeout();
			error_Tel.innerHTML = "&nbsp;";
			top.pool.set("strAgentPhone", phone);
			//插入身份证进行联网核查
			acceptIDCard();	
		}
	}
	input_tel.onkeyup = function()
	{
		error_Tel.innerHTML = "&nbsp;";
	}
	onTimeout = function()
	{
		top.inputmethod.Close();
		top.serviceCtrl.stopUserTimeout();
		top.pool.set("strbusinessName","存单开户转账支取代理人补录超时");
		top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
		top.trans.send910304CDSFailedAsync();
	}
	text_IDNo1.innerHTML = top.pool.get("strIDCardNum");
	text_name1.innerHTML = top.pool.get("strIDName");
	proMessage.innerHTML = "提示：持他人的卡/折办理存款、取款或转账<br>超过50000元，需留存代理人信息及联系电话。";
	top.inputmethod.ShowDigit(870,570);
	top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout, oInfoConfigTick);
	window.operateCtrl.enableInput();
	try {top.soundPlayer.playback("/Sound/InputTelPhoneNum.mp3");} catch (e) {}
	top.wins.showMain("oLInfoConfigTip");
	input_tel.focus();
  }  
  //身份证联网核查
  function acceptIDCard()
  {
 	window.operateCtrl.disableInput(true);
	top.serviceCtrl.stopUserTimeout();
	onCardInvalid_ID = function() {
		top.serviceCtrl.stopUserTimeout();
		showSvcFailedInfo(top.langcur.oCDSFailed, top.TERMRETCODE_ID_READFAILED, top.langcur.oIDReaderFailed);
	}
	onDeviceError_ID = function() {
		top.serviceCtrl.stopUserTimeout();
		showSvcFailedInfo(top.langcur.oCDSFailed, top.TERMRETCODE_ID_READFAILED, top.langcur.oIDCardError);
	}
	onCardInserted_ID = function() {
		top.wins.showNewProcessingTip(top.langcur.oReadingIDCard);
	}
	onAgentCardReaded = function() {
		top.serviceCtrl.stopUserTimeout();
		AgentidCardEject();
	}
	//退出身份证读取流程
	onKey_F98 = function() {
		top.serviceCtrl.stopUserTimeout();
		top.YHAXIDCardReader.CancelAccept();
		//判断身份证状态
		if(top.idCardReader.isCardPresent())//如果身份证存在，直接退出身份证
		{
		   top.YHAXIDCardReader.Eject(120*1000);
		}
		infoComfin();
	}
	onTimeout_ID = onTimeout = function(){
		//如果存单模块状态异常
		top.pool.set("strbusinessName", "存单开户转账支取户主身份证放入超时");
		top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
		top.trans.send910304CDSFailedAsync();
	}
			
	window.operateCtrl.enableInput();
	top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout, oAgentIdCardTick);
	top.idCardReader.acceptAgent();
	// 播放提示音
	try {
		top.soundPlayer.playback("/Sound/PlsInsertOwnID.mp3");
	} catch (e) {}
	top.wins.showMain("oLAgentIDCardTip");	  
  }  
  // 提示取走委托人二代身份证
  function AgentidCardEject() {
	top.wins.stopProcessingTimeout();  
	top.pool.set("isAgent","1"); //是否是代理人
	window.operateCtrl.disableInput(true);
	top.serviceCtrl.stopUserTimeout();
	onDeviceError_ID = onTimeout_ID = function() {
		top.serviceCtrl.stopUserTimeout();
		showSvcFailedInfo(top.langcur.oCDSFailed, top.TERMRETCODE_ID_EJECTFAILED,top.langcur.oEjectIDFailed);
	}
	onCardTaken_ID = function() {		
	}
	//超时退出
	onTimeout = function()
	{	
		top.idCardReader.IDCardEvents.clearAll();	
		//进行联网核查流程
        top.idCardReader.idCardTakenComplete();
	}

	top.serviceCtrl.startUserTimeout(onTimeout, 10, oAgentIdCardTakeTick);
	window.operateCtrl.enableInput();
	top.idCardReader.eject();
	// 播放提示音
	try {
		top.soundPlayer.playback("/Sound/TakeIDCard.mp3");
	} catch (e) {}
	top.wins.showMain("oLAgentIDCardTakeTip");
  }	  
  //联网核查成功
  function onNetworkVirificationSuccessful(){
	top.serviceCtrl.stopUserTimeout();
	//如果插入的身份证与卡/折身份证是否一致	
	if(top.pool.get("strAgentIDCardNum") != top.pool.get("creditF60_1")){
		showSvcFailedInfo(top.langcur.oCDSFailed, top.TERMRETCODE_ID_EJECTFAILED,top.langcur.oCdsIdentDiff2);		
	}else{
		top.pool.set("needSendAgent","1");
		showTransferConfrim();			
	}
  } 
  //确认转出信息
  function showTransferConfrim()
  {
	window.operateCtrl.disableInput(true);
	top.serviceCtrl.stopUserTimeout();
	onKey_Enter = onKey_F99 = function()
	{	
		top.serviceCtrl.stopUserTimeout();
		top.wins.showNewProcessingTip(top.langcur.oSendTransOut);
		//发起内部账户转出交易
		top.trans.send905106Async();
	}
	onKey_F98 = function()
	{
		top.serviceCtrl.stopUserTimeout();
		if(isCard){
			//退卡
			ejectCard();
		}else if(isPass){
			if(isPassReader){
				sendDepositQuery(); 
			}else{
				//退存折
				ejectPassBook("2");
			}
		}else{
			sendDepositQuery(); 
		}
	}
	onTimeout = function(){
		//如果存单模块状态异常
		top.pool.set("strbusinessName", "存单开户转账支取信息确认超时");
		top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
		top.trans.send910304CDSFailedAsync();
	}
	//请核对屏幕显示帐号及金额提示音
	try{top.soundPlayer.playback("/Sound/PleaseConfirmAmount.mp3");}catch(e){}		  
	text_TransPan.innerHTML = top.pool.get("strInAcctNo");
	//开户金额
	text_TransAmount.innerHTML = new top.StringCtrl("").formatStrAmount(top.pool.get("surplusAmt"));
	window.operateCtrl.enableInput();
	top.serviceCtrl.startUserTimeout(onTimeout, top.iUserTimeout,oFeeConfirmTick);
	top.wins.showMain("oLFeeConfirm");  
  }
  //转账支取--转出成功
  function doTransferOutSucess()
  {
	//登记代理人
	if(top.pool.get("needSendAgent") == "1"){
		//代理人登记
		top.pool.set("strOption","C");
		top.pool.set("needSendAgent","");
		top.pool.set("strAgentTransCode","905106");
		top.wins.showNewProcessingTip(top.langcur.send901112Add);
		top.trans.send901112Async();	
	}else{
		onTransSucessful();
	}
  }
  //代理人信息登记
  function onUpdateAgentSuccessful(){
	  onTransSucessful();
  }  
  //转账支取--转出成功
  function onTransSucessful()
  {
	window.operateCtrl.disableInput(true);
	top.serviceCtrl.stopUserTimeout();	
	if(top.receiptprinter.ReceiptPrinterStatus()!="true")
	{
		oPrintReceipt.style.visibility = "hidden";
	}else{
		onKey_Enter = onKey_F99 = function()
		{
			top.wins.showNewProcessingTip("正在打印凭条，请稍候...");
			doTransferOutRpt();
		}
	}
	onKey_Cancel = onKey_F98 = function()
	{
		top.serviceCtrl.navigate2Quit();
	}
	window.operateCtrl.enableInput();
	top.serviceCtrl.startUserTimeout(onKey_F98, top.iUserTimeout,oTransferOutSuccessTick);
	top.wins.showMain("oLTransferOutSucessTip");
  }  
  //转账支取-打印转账凭条
  function doTransferOutRpt(){	
	top.pool.set("Amount",top.pool.get("surplusAmt"));
	top.pool.set("strPan", top.pool.get("strInAcctNo"));
	top.pool.set("transName","存单开户--余额取现");
	onReceiptEjected = function(){
		top.serviceCtrl.startUserTimeout(onQuit, top.iUserTimeout,oTakeReceiptTick);
	    top.wins.showMain("oTakeReceiptTip");
	}
	onDeviceError_rpt_Print = onDeviceError_rpt_Eject = onCaptureReceiptFailed = function()
	{
		top.wins.stopProcessingTimeout();
		//提示打印失败
		top.wins.showInfoTip("凭条打印故障");
		top.serviceCtrl.startFlowCtrlTimeout(onQuit, 5 * 1000);
	}
	onQuit = function(){
		top.wins.stopProcessingTimeout();
		top.serviceCtrl.navigate2Quit();
	} 
	onReceiptCaptured = onReceiptTaken = function()
	{
		top.wins.stopProcessingTimeout();
		top.serviceCtrl.navigate2Quit();
	}
	top.pool.set("printType","4");//选择打印的凭条类型
	top.receiptprinter.printAndEject();
  }
  //转账支取失败
  function onTransferOutFailed(title, retcode, retdesc){
	//其他交易失败
	showSvcFailedInfo(title, retcode, retdesc);
  }
  function onServiceFailed(title, retcode, retdesc){
	if(isInputPin){
		//验密失败情况下的处理：可以输入3次
		isInputPin = false;
		if(retcode == "2055"){
			if(strInputFlag > 3)
			{
				//密码输入次数超限
				showSvcFailedInfo(title, retcode, "密码错误次数超多");
			}else{
				strInputFlag ++;
				inputPin();
			}
		}else{
			//跳转至现金支取方式
			showSvcFailedInfo(title, retcode, retdesc);
		}
	}else{
		//其他交易失败
		showSvcFailedInfo(title, retcode, retdesc);
	}
  }      
  //失败
  function showSvcFailedInfo(title, retcode, retdesc)
  {
  	window.operateCtrl.disableInput(true);
	top.serviceCtrl.stopUserTimeout();
	onKey_F98 = onTimeout = function() {
		top.serviceCtrl.stopUserTimeout();
		if(isCard){
			if(top.YHAXCardReader.StDeviceStatus == "HEALTHY"){
				ejectCard();
			}else{
				if(top.pool.get("isReturnPay")=="0"){
					//返回支取方式选择页面
					onReturnPay();			
				}else{
					sendDepositQuery();	
				}
			}
		}else if(isPass){
			if(isPassReader){
				sendDepositQuery(); 
			}else{
				if(top.YHAXPassbook.StDeviceStatus == "HEALTHY"){
					//退存折
					ejectPassBook("2");
				}else{
					if(top.pool.get("isReturnPay")=="0"){
						//返回支取方式选择页面
						onReturnPay();			
					}else{
						sendDepositQuery();	
					}
				}
			}
		}else{
			//判断是返回支取方式选择页面还是购物车页面
			if(top.pool.get("isReturnPay")=="0"){
				//返回支取方式选择页面
				onReturnPay();			
			}else{
				if(top.YHAXCardReader.StDeviceStatus == "HEALTHY" && top.YHAXCardReader.StMediaStatus == "PRESENT"){
					ejectCard();
				}else if(top.YHAXPassbook.StDeviceStatus == "HEALTHY" && top.YHAXPassbook.StMediaStatus == "PRESENT"){
					ejectPassBook("2");
				}else{
					sendDepositQuery();	
				}
			}
		}
	}
	oTitle.innerHTML = title;
	oFailedRetDesc.innerHTML = retdesc;
	
	window.operateCtrl.enableInput();
	top.serviceCtrl.startUserTimeout(onTimeout, top.iFailedTimeout, oServiceFailedTick);
	top.wins.showMain("oLServiceFailedTip"); 
  } 
  
  //超时回调
  function onProcessingTimeout(){
	//如果存单模块状态异常
	if(new top.CheckCard().cdStDeviceStatus() !="true"){
		//大堂经理帮助成功：设备显示设备故障
		top.serviceCtrl.navigate2("/Service/CDSFailed.html");
	}else{
		if(top.pool.get("surplusAmt") > 0){
			top.pool.set("strbusinessName","存单开户转账支取交易超时(内部账有钱)");
			top.wins.showNewProcessingTip(top.langcur.oCheckHelping2);
			top.trans.send910304CDSFailedAsync();
		}else{
			top.serviceCtrl.navigate2Quit();
		}
	}
  }
  //返回支取方式选择页面
  function onReturnPay()
  {
	top.wins.stopProcessingTimeout();
	top.serviceCtrl.stopUserTimeout();
	top.serviceCtrl.navigate2("/Service/0005_DepOpen_00006.html");
  }
  //返回购物车
  function sendDepositQuery()
  {
	top.wins.stopProcessingTimeout();
	top.serviceCtrl.stopUserTimeout();
	top.serviceCtrl.navigate2("/Service/0005_DepOpen_00003.html");
  }
  //存单交易失败：呼叫大堂经理回调
  function onShowTellCDSFailed(){
	top.serviceCtrl.navigate2("/Service/CDSFailed.html"); 
  } 
  function ShowKeyboard() {
	  top.inputmethod.ShowDigit(870,570);
  }
  //校验电话号码
  function input_checkTel() {
	error_Tel.innerHTML = "&nbsp;";
	if (!new top.StringCtrl(input_tel.value).isAllDigit2()) {
		error_Tel.innerHTML = top.langcur.oInputRightTel2;
		input_tel.value = "";
		input_tel.focus();
	} 
  }
</script>
</head>
<body background="../Terminal/Style/Default/Img/Bg_Main_Menu2.jpg" oncontextmenu="return false" ondragstart="return false" onselectstart ="return false" onselect="document.selection.empty()" oncopy="document.selection.empty()" onbeforecopy="return false" onmouseup="document.selection.empty()">
<div id="oLTransferSelect" class="FULLSCR" style="visibility:hidden">
  <div class="FULLSCR">
	<span class="Tip_Tick" id="oSelectTypeTick"></span>
    <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
      <tr>
        <td align="center">
		<br/><br/><br/><br/><br/><br/><br/><br/><br/>
		  <pre class="Tip_Title" id="oSelectType"></pre>
		  <span class="MENU6_1"><button onclick="javascript:onKey_F7()" class="Menu_Passbook" name="oPassbook"></button></span>
		  <span class="MENU7_1"><button onclick="javascript:onKey_F8()" class="Menu_Card" name="oCard"></button></span>		  
	   	  <span class="MENU8_1"><button onclick="javascript:onKey_F9()" class="Menu_Passreader" name="oPassbook"></button></span>
	   </td>
      </tr>
    </table>
  </div>
  <span class="MENU98"><button onclick="javascript:onKey_F98();" class="return" name="return"></button></span>
</div>

<div id="oLFeeList" class="FULLSCR">
  <div class="FULLSCR">
	<span class="Tip_Tick" id="oFeeListTick"></span>
    <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
      <tr><td align="center">
        <table cellpadding="10" cellspacing="1" class="Table_Ob" width="57%">
          <tr class="Table_Head"><td colspan="2" align="center" id="oTransOutAccount"></td></tr>
		  <tr class="Table_Record">
			<td id="oTransPan"></td>
			<td align="left">&nbsp;&nbsp;
				<select id="AccountSelect" class="select" ><option id="oTransOutAccount" value="0"></option></select>
			</td>
		  </tr>
          <tr class="Table_Record"><td id="oCDSResAmount"></td><td class="Digit_Normal" id="text_TransListAmount"></td></tr>
        </table>
      </td></tr>
    </table>
  </div>
    <span class="MENU98" ><button onclick="javascript:onKey_F98()" class="return" name="oReturn"></button></span>
	<span class="MENU99" ><button onclick="javascript:onKey_F99()" class="confirm" name="oConfirm"></button></span>
</div>

<div id="oLPassTip" class="FULLSCR" style="visibility:hidden;">
 <div class="FULLSCR">
  <span class="Tip_Tick" id="oInPassTick"></span>
  <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
	<br/><br/><br/>
    <tr><td align="center">
      <br/><br/><pre class="Tip_Title" id="oInsertPass"></pre><br/>
      <img src="../Image/InputPassBookTip.gif" width="870px" height="520px"/>
    </td></tr>
  </table>
  </div>
  <span class="MENU98"><button onclick="javascript:onKey_F98();" class="return" name="return"></button></span>
</div>

<div id="cLInfoTip2" class="FULLSCR" style="visibility:hidden;">
  <div class="FULLSCR">
	<span class="Tip_Tick" id="oInfoTip2Tick"></span>
    <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
      <tr><td align="center">
        <br/><br/>
        <span class="Tip_Title" ID="cLInfoContent2">&nbsp;<br/><br/><br/></span>
      </td></tr>
    </table>
  </div>
</div>

<div id="oLPassReaderTip" class="FULLSCR" style="visibility: hidden;">
	<div class="FULLSCR">
		<span class="Tip_Tick" id="oReadPassTick"></span>
		<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
			<tr>
				<td align="center"><br/><br/>
					<pre class="Tip_Title" id="oReaderPass"></pre><br/>
					<img src="../Image/ReadPassBookTip.gif" width="870px" height="520px" />
				</td>
			</tr>
		</table>
	</div>
	<span class="MENU98"><button onclick="javascript:onKey_F98();" class="return" name="return"></button></span>
</div>

<div id="oLIdleTip" class="FULLSCR" style="visibility:hidden;">
 <div class="FULLSCR">
  <span class="Tip_Tick" id="oInpCardTick"></span>
  <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
    <tr><td align="center">
      <br/><br/><pre class="Tip_Title"><span id="oInsertCard"></span></pre><br/>
      <img src="../Image/InsertCardTip.gif" width="870px" height="520px"/>
    </td></tr>
  </table>
  </div>
  <span class="MENU98"><button onclick="javascript:onKey_F98();" class="return" name="return"></button></span>
</div>	

<div id="oLTakeInvalCardTip" class="FULLSCR" style="visibility:hidden;">
	<span class="Tip_Tick" id="oTakeInvalCardTick"></span>
  <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
    <br/><br/><br/><br/><br/><br/><br/><br/>
	<tr class="FirstLine"><td align="center">
	  <span class="Tip_Title" id="oReInsertDebCard"></span><br/><br/>
      <img src="../Image/TakeCardTip.gif" width="870" height="520" />
    </td></tr>
  </table>
</div>

<div id="oLTakeFailedTip" class="FULLSCR" style="visibility:hidden;">
	<span class="Tip_Tick" id="oTakeFailedTick"></span>
  <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
    <br/><br/><br/><br/><br/><br/><br/><br/>
	<tr class="FirstLine"><td align="center">
	  <span class="Tip_Title" id="oTakeCard2"></span><br/><br/>
      <img src="../Image/TakeCardTip.gif" width="870" height="520" />
    </td></tr>
  </table>
</div>

<div id="oLInputPassword" class="FULLSCR" style="visibility:hidden;">
  <div class="FULLSCR">
    <span class="Tip_Tick" id="oInpPwdTick"></span>
    <table width="100%" height="80" border="0" cellpadding="0" cellspacing="0">
      <tr class="FirstLine"><td align="center">
        <span>&nbsp;</span>
      </td></tr>
    </table>
    <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
      <tr class="FirstLine"><td align="center">
        <span class="Tip_Title" id="Tip_TitleInput"></span><br/><br/>
        <input type="password" id="input_Password" name="input_Password"  class="input_short" maxlength=6 /><br/><br/>
		<img width="600px" height="430px" src="../Image/InputPin.gif" />
        <table><tr><td class="Error_Title" id="error_InputPassword"></td></tr></table>
      </td></tr>
    </table>
  </div>
<span class="MENU98"><button onclick="javascript:onKey_F98();" class="return" name="return"></button></span>
</div>

<div id="oLInfoConfigTip" class="FULLSCR" style="visibility: hidden;">
	<div class="FULLSCR">
		<br><br><br><br><br><br><br><br>
		<span class="Tip_Tick" id="oInfoConfigTick"></span>
		<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="10" align="center">
			<tr>
				<td align="center">
					<span class="Tip_Title" id="oAgentInfoCof"></span><br><br>
					<table width="70%" height="30%" border="0" cellpadding="0" cellspacing="0">
						<tr>
							<td height="20px" width="37%" align="right" class="Tip_Content">代理人姓名:&nbsp;&nbsp;</td>
							<td align="left" class="Tip_Alarm"><span id="text_name1"></span></td>
						</tr>
						<tr>
							<td height="20px" align="right" class="Tip_Content">代理人身份证:&nbsp;&nbsp;</td>
							<td align="left" class="Tip_Alarm"><span id="text_IDNo1"></span></td>
						</tr>
						<tr>
							<td height="20px" align="right" class="Tip_Content">代理人电话:&nbsp;&nbsp;</td>
							<td align="left" class="Tip_Title">
								<input class="input_long" type="text" name="input_tel" id="input_tel" maxlength="12" onclick="javascript:ShowKeyboard();" onkeyup="return input_checkTel()" />
							</td>
						</tr>
					</table><br><br>
					<span class="Tip_Title" id="proMessage"></span><br><br>
					<span class="Error_Title" id="error_Tel"></span>
				</td>
			</tr>
		</table>
	</div>
	<span class="MENU99" ><button onclick="javascript:onKey_F99()" class="confirm" name="oConfirm"></button></span>
</div>
	
<div id="oLAgentIDCardTip" class="FULLSCR" style="visibility: hidden;">
	<div class="FULLSCR">
		<br><br><br><br><br><br> 
		<span class="Tip_Tick" id="oAgentIdCardTick"></span>
		<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
			<tr class="FirstLine" height="100">
				<td align="center"><br /> <br /> <span class="Tip_Title" id="oInsertOwnID"></span>
					<br /> <img src="../Image/ID_in.gif" width="870px" height="520px" />
				</td>
			</tr>
			<tr>
				<td>&nbsp;</td>
			</tr>
		</table>
	</div>
	<span class="MENU98" ><button onclick="javascript:onKey_F98()" class="return" name="oReturn"></button></span>			
</div>	
	
<div id="oLAgentIDCardTakeTip" class="FULLSCR" style="visibility: hidden;">
	<div class="FULLSCR">
		<br><br><br><br><br><br> 
		<span class="Tip_Tick" id="oAgentIdCardTakeTick"></span>
		<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
			<tr class="FirstLine" height="100">
				<td align="center"><br /> <br /> <span class="Tip_Title" id="oIDCardTake"></span>
						<br /> <img src="../Image/id_out.gif" width="870px" height="520px" />
				</td>
			</tr>
			<tr>
				<td>&nbsp;</td>
			</tr>
		</table>
	</div>
</div>	

<div id="oLFeeConfirm" class="FULLSCR">
  <div class="FULLSCR">
	<span class="Tip_Tick" id="oFeeConfirmTick"></span>
    <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
      <tr><td align="center">
        <table cellpadding="10" cellspacing="1" class="Table_Ob" width="57%">
          <tr class="Table_Head"><td colspan="2" align="center" id="oTransOutAccountCon"></td></tr>
		  <tr class="Table_Record"><td id="oTransInAccount"></td><td class="Digit_Normal" id="text_TransPan"></td></tr>
          <tr class="Table_Record"><td id="oCashOutAmount"></td><td class="Digit_Normal" id="text_TransAmount"></td></tr>
        </table>
      </td></tr>
    </table>
  </div>
    <span class="MENU98" ><button onclick="javascript:onKey_F98()" class="return" name="oReturn"></button></span>
	<span class="MENU99" ><button onclick="javascript:onKey_F99()" class="confirm" name="oConfirm"></button></span>
</div>

<div id="oLTransferOutSucessTip" class="FULLSCR" style="visibility: hidden;">
	<div class="FULLSCR">
		<span class="Tip_Tick" id="oTransferOutSuccessTick"></span>
		<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
			<br /><br /><br /><br /><br /><br /><br /><br />
			<tr class="FirstLine">
					<td align="center">
						<img src="../Terminal/Style/Default/Img/success.png" width="97" height="97" /></br></br>
						<span class="Tip_Title" id="oOpenCDSTransOut"></span>
					</td>
				</tr>
		</table>
	</div>
	<span class="MENU98" ><button onclick="javascript:onKey_F98()" class="return" name="oReturn"></button></span>
	<span class="MENU99" ><button onclick="javascript:onKey_F99()" class="confirm" name="oPrintReceipt"></button></span>
</div>	

<div id="oLServiceFailedTip" class="FULLSCR" style="visibility: hidden;">
	<div class="FULLSCR">
		<span class="Tip_Tick" id="oServiceFailedTick"></span> <br />
		<table width="100%" height="100%" border="0" cellpadding="0"
			cellspacing="0">
			<tr>
				<td align="center">
					<table cellpadding="10" cellspacing="1" class="Table_Ob" width="55%">
						<tr class="Table_Head">
							<td colspan="2" class="Error_Title" align="center" id="oTitle"></td>
						</tr>
						<tr class="Table_Record">
							<td id="oDescription"></td>
							<td><span id="oFailedRetDesc"></span></td>
						</tr>
					</table>
				</td>
			</tr>
		</table>
	</div>
	<span class="MENU98" ><button onclick="javascript:onKey_F98()" class="return" name="oReturn"></button></span>
</div> 

<div id="oTakeReceiptTip" class="FULLSCR">
  <span class="Tip_Tick" id="oTakeReceiptTick"></span>
  <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
    <tr class="FirstLine"><td align="center">
      <span class="Tip_Title" id="oPlsTakeReceipt1"></span><span class="Tip_Title" id="oPlsTakeReceipt2"></span><br/><br/>
      <img src="../Image/TakeReceiptTip.gif" width="870px" height="520px" />
    </td></tr>
  </table>
</div>

</body>
</html>
